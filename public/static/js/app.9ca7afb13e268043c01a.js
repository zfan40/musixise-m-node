webpackJsonp([1],{"48sU":function(t,e){},"8GxT":function(t,e){},GWyx:function(t,e){},IEmI:function(t,e){},KDEC:function(t,e){},NHnr:function(t,e,o){"use strict";function i(t){var e=M.get("serviceToken");return e?(F.headers.Authorization="Bearer "+e,B.post("//api.musixise.com/api/user/getInfo","",F)):!(e||!t)&&new x.a(function(e,o){B.post("//api.musixise.com/api/user/oauth/wechat/callback?code="+t,"",F).then(function(t){20001===t.data.errcode&&o(20001);var e=t.data.data.id_token;return F.headers.Authorization="Bearer "+e,M.set("serviceToken",e,{expires:7}),B.post("//api.musixise.com/api/user/getInfo","",F)},function(){o()}).then(function(t){e(t)}).catch(function(t){o(t)})})}function n(t,e){var o=this;return new x.a(function(i,n){var a={headers:{"Content-Type":"multipart/form-data",processData:!1}},r=new Blob([I()(t)]),c=new FileReader;c.onload=function(){var t=P()(N.a.mark(function t(r){var c,s,d,l;return N.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=new FormData,c.append("fname","test.txt"),c.append("data",r.target.result),t.next=5,B.post("//api.musixise.com/api/uploadAudio",c,a);case 5:return s=t.sent,d="http://oiqvdjk3s.bkt.clouddn.com/"+s.data.data,l=E()({},e,{url:d}),console.log(d),t.abrupt("return",B.post("//api.musixise.com/api/work/create",I()(l),F).then(function(t){i(t.data.data.id)}).catch(function(t){n(t)}));case 10:case"end":return t.stop()}},t,o)}));return function(e){return t.apply(this,arguments)}}(),c.readAsDataURL(r)})}function a(t){return B.post("//api.musixise.com/api/work/detail/"+t,"",F)}function r(t){o("hoXB")}function c(t){var e=new RegExp("[?|&]"+t+"=([^&]+)"),o=location.search.match(e);return o&&o[1]}function s(t){o("O/d9")}function d(t){var e=[151,255,241],o=[98,166,223],i=[154,124,255],n=[0,0,0];return t<0||t>20||t<=10&&(n=[e[0]+t*(o[0]-e[0])/10,e[1]+t*(o[1]-e[1])/10,e[2]+t*(o[2]-e[2])/10]),n=[o[0]+t*(i[0]-o[0])/10,o[1]+t*(i[1]-o[1])/10,o[2]+t*(i[2]-o[2])/10],"rgb("+Math.floor(n[0])+","+Math.floor(n[1])+","+Math.floor(n[2])+")"}function l(t){return""+((nt.Frequency(t).toMidi()-50)/70*60+.2)}function u(t){console.log("current state",nt.Transport.state),"stopped"===nt.Transport.state?(at&&at.dispose(),at=new nt.Part(function(t,e){rt.triggerAttackRelease(e.note,"8n",t)},t).start(0,0),at.loop=!0,at.loopEnd=17,nt.Transport.start("+0.01",0)):nt.Transport.stop(0)}function p(t){o("GWyx")}function v(t){o("IEmI")}function h(t){o("48sU")}function m(t){o("KDEC")}function g(t){o("8GxT")}function f(t){o("vf/z")}Object.defineProperty(e,"__esModule",{value:!0});var _=o("7+uW"),w=o("9JMe"),b=o("I0MY"),k=o.n(b),C=o("NYxO"),T=o("//Fk"),x=o.n(T),y=o("Xxa5"),N=o.n(y),A=o("Dd8w"),E=o.n(A),S=o("exGp"),P=o.n(S),R=o("mvHQ"),I=o.n(R),M=o("lbHh"),B=o("mtWM"),F={headers:{Accept:"application/json","Content-Type":"application/json"}},D={BOUNCE_PROJECT:function(t,e){t.commit,t.state;return n(e.record,e.info)},FETCH_MBOX:function(t,e){var o=t.commit,i=(t.state,e.id);return new x.a(function(t,e){a(i).then(function(e){console.log("xxi",e.data.data.url);var i=new XMLHttpRequest;i.open("GET",e.data.data.url,!0),i.send(null),i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){-1!==i.getResponseHeader("Content-Type").indexOf("text")&&(o("SET_ID_PROJECT",{record:JSON.parse(i.responseText),info:e.data.data}),t())}}})})},FETCH_LIST_DATA:function(t,e){var o=t.commit,i=t.dispatch,n=(t.state,e.type);return o("SET_ACTIVE_TYPE",{type:n}),(void 0)(n).then(function(t){return o("SET_LIST",{type:n,ids:t})}).then(function(){return i("ENSURE_ACTIVE_ITEMS")})},ENSURE_ACTIVE_ITEMS:function(t){return(0,t.dispatch)("FETCH_ITEMS",{ids:t.getters.activeIds})},FETCH_ITEMS:function(t,e){var o=t.commit,i=t.state,n=e.ids,a=Date.now();return n=n.filter(function(t){var e=i.items[t];return!e||a-e.__lastUpdated>18e4}),n.length?(void 0)(n).then(function(t){return o("SET_ITEMS",{items:t})}):x.a.resolve()},FETCH_USER:function(t,e){var o=t.commit,i=t.state,n=e.id;return i.users[n]?x.a.resolve(i.users[n]):(void 0)(n).then(function(t){return o("SET_USER",{id:n,user:t})})}},q={SET_USER_INFO:function(t,e){var o=e.type;t.activeType=o},SET_WORK_INFO:function(t,e){var o=e.type,i=e.ids;t.lists[o]=i},SET_MUSIXISER_INFO:function(t,e){e.items.forEach(function(e){e&&_.a.set(t.items,e.id,e)})},SET_BOUNCE_PROJECT:function(t,e){var o=e.record;t.recordProject=o},SET_ID_PROJECT:function(t,e){var o=e.record,i=e.info;t.recordProject=o,t.recordProjectInfo=i},SET_FINAL_WORK:function(t,e){var o=e.type;t.activeType=o},SET_USER:function(t,e){var o=e.id,i=e.user;_.a.set(t.users,o,i||!1)}},j={activeIds:function(t){var e=t.activeType,o=t.itemsPerPage,i=t.lists,n=Number(t.route.params.page)||1;if(e){var a=(n-1)*o,r=n*o;return i[e].slice(a,r)}return[]},activeItems:function(t,e){return e.activeIds.map(function(e){return t.items[e]}).filter(function(t){return t})}};_.a.use(C.a);var U={name:"app",data:function(){return{transitionName:"fade"}},beforeRouteUpdate:function(t,e,o){}},H=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("transition",{attrs:{name:t.transitionName}},[o("router-view")],1)],1)},G=[],$={render:H,staticRenderFns:G},O=$,z=o("VU/8"),L=r,V=z(U,O,!1,L,"data-v-7d7a33f4",null),X=V.exports,W=o("/ocq"),J={name:"hello",data:function(){return{msg:"Welcome to Your Vue.js App"}},methods:{redirectTo:function(t){this.$router.push(t)}},created:function(){var t=document.documentElement;window.rem=t.getBoundingClientRect().width/10,t.style.fontSize=window.rem+"px",/micromessenger/.test(navigator.userAgent.toLowerCase())&&(c("code")||M.get("serviceToken")?i(c("code")).then(function(t){t.data.errcode>=2e4&&(M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect"))}},Y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app"},[o("div",{staticClass:"m-logo"}),t._v(" "),o("div",{staticClass:"redirect-button",attrs:{id:"mb-maker"},on:{touchstart:function(e){t.redirectTo("/new-music-box-maker")}}},[t._v("\n      去编曲\n  ")])])},Z=[],K={render:Y,staticRenderFns:Z},Q=K,tt=o("VU/8"),et=s,ot=tt(J,Q,!1,et,"data-v-3b801b49",null),it=ot.exports,nt=(o("lHA8"),o("Gu7T"),o("gRE1"),o("fZjL"),o("ZnLv")),at=void 0,rt=new nt.MonoSynth({volume:-10,envelope:{attack:.1,decay:.3,release:2},filterEnvelope:{attack:.001,decay:.01,sustain:.5,baseFrequency:200,octaves:2.6}}).toMaster();window.Tone=o("ZnLv");var ct=new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster();new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),(new Tone.PluckSynth).toMaster();window.recorder=[],window.tonepart=[];var st=[],dt=0,lt={data:function(){return{activeNote:{},timerToStartRecord:0,recording:!1,replaying:!1}},methods:{load:function(){},startRecord:function(){var t=this;this.timerToStartRecord=3;var e=setInterval(function(){t.timerToStartRecord-=1,0==t.timerToStartRecord&&clearInterval(e)},1e3)},touchStartHandler:function(t){console.log("down",t.target.id),ct.triggerAttack(t.target.id),this.$set(this.activeNote,t.target.id,1),this.recording&&recorder.push({note:t.target.id,time:+((performance.now()-dt)/1e3).toFixed(4)})},touchEndHandler:function(t){ct.triggerRelease(t.target.id),this.$set(this.activeNote,t.target.id,0)},toggleRecord:function(t){var e=this;if(this.recording=!this.recording,this.recording){if(recorder=[],!this.replaying){this.timerToStartRecord=3;var o=setInterval(function(){e.timerToStartRecord-=1,0==e.timerToStartRecord&&(clearInterval(o),dt=performance.now())},1e3)}}else console.log("kikikiki"),recorder.length&&(tonepart[tonepart.length]=new Tone.Part(function(t,e){ct.triggerAttackRelease(e.note,"8n",t)},recorder).start(0))},toggleReplay:function(){console.log(1),this.replaying=!this.replaying,this.replaying?(console.log("kokokoko"),dt=performance.now(),Tone.Transport.start("+0.01")):Tone.Transport.stop(0)},undoRecord:function(){tonepart.pop().dispose()},bounceProject:function(){if(console.log(tonepart),st=[],tonepart.length){for(tonepart.forEach(function(t){t._events.forEach(function(t){st.push(t.value)})});tonepart.length;)tonepart.pop().dispose();tonepart[0]=new Tone.Part(function(t,e){ct.triggerAttackRelease(e.note,"8n",t)},st).start(0),st.sort(function(t,e){return 0+t.time-e.time}),console.log(st),(void 0)(st)}else alert("tm什么都没录")}},created:function(){/micromessenger/.test(navigator.userAgent.toLowerCase())&&(c("code")||M.get("serviceToken")?i(c("code")).then(function(t){t.data.errcode>=2e4&&(M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect"))},mounted:function(){},updated:function(){}},ut=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("div",{class:["mask",t.timerToStartRecord>1?"fadein":"fadeout",0==t.timerToStartRecord?"hide":""]},[o("p",{staticClass:"rotate",attrs:{id:"timer"}},[t._v(t._s(t.timerToStartRecord))])]),t._v(" "),o("div",{staticClass:"container"},[o("div",{staticClass:"keys",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.touchStartHandler(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.touchEndHandler(e)}}},[o("div",{class:["white","c",t.activeNote.C4?"active-note":""],attrs:{id:"C4"}}),t._v(" "),o("div",{class:["black","d-minor",t.activeNote.Db4?"active-note":""],attrs:{id:"Db4"}}),t._v(" "),o("div",{class:["white","d",t.activeNote.D4?"active-note":""],attrs:{id:"D4"}}),t._v(" "),o("div",{class:["black","e-minor",t.activeNote.Eb4?"active-note":""],attrs:{id:"Eb4"}}),t._v(" "),o("div",{class:["white","e",t.activeNote.E4?"active-note":""],attrs:{id:"E4"}}),t._v(" "),o("div",{class:["white","f",t.activeNote.F4?"active-note":""],attrs:{id:"F4"}}),t._v(" "),o("div",{class:["black","f-sharp",t.activeNote.Gb4?"active-note":""],attrs:{id:"Gb4"}}),t._v(" "),o("div",{class:["white","g",t.activeNote.G4?"active-note":""],attrs:{id:"G4"}}),t._v(" "),o("div",{class:["black","a-minor",t.activeNote.Ab4?"active-note":""],attrs:{id:"Ab4"}}),t._v(" "),o("div",{class:["white","a",t.activeNote.A4?"active-note":""],attrs:{id:"A4"}}),t._v(" "),o("div",{class:["black","b-minor",t.activeNote.Bb4?"active-note":""],attrs:{id:"Bb4"}}),t._v(" "),o("div",{class:["white","b",t.activeNote.B4?"active-note":""],attrs:{id:"B4"}}),t._v(" "),o("div",{class:["white","c",t.activeNote.C5?"active-note":""],attrs:{id:"C5"}}),t._v(" "),o("div",{class:["black","d-minor",t.activeNote.Db5?"active-note":""],attrs:{id:"Db5"}}),t._v(" "),o("div",{class:["white","d",t.activeNote.D5?"active-note":""],attrs:{id:"D5"}}),t._v(" "),o("div",{class:["black","e-minor",t.activeNote.Eb5?"active-note":""],attrs:{id:"Eb5"}}),t._v(" "),o("div",{class:["white","e",t.activeNote.E5?"active-note":""],attrs:{id:"E5"}}),t._v(" "),o("div",{class:["white","f",t.activeNote.F5?"active-note":""],attrs:{id:"F5"}}),t._v(" "),o("div",{class:["black","f-sharp",t.activeNote.Gb5?"active-note":""],attrs:{id:"Gb5"}}),t._v(" "),o("div",{class:["white","g",t.activeNote.G5?"active-note":""],attrs:{id:"G5"}}),t._v(" "),o("div",{class:["black","a-minor",t.activeNote.Ab5?"active-note":""],attrs:{id:"Ab5"}}),t._v(" "),o("div",{class:["white","a",t.activeNote.A5?"active-note":""],attrs:{id:"A5"}}),t._v(" "),o("div",{class:["black","b-minor",t.activeNote.Bb5?"active-note":""],attrs:{id:"Bb5"}}),t._v(" "),o("div",{class:["white","b",t.activeNote.B5?"active-note":""],attrs:{id:"B5"}}),t._v(" "),o("div",{class:["white","c",t.activeNote.C6?"active-note":""],attrs:{id:"C6"}})]),t._v(" "),o("div",{staticClass:"controller"},[o("div",{staticClass:"funcBtn record",class:t.recording?"active":"",on:{click:t.toggleRecord}},[o("div",{staticClass:"recordHint"})]),t._v(" "),o("div",{staticClass:"funcBtn play",class:t.replaying?"active":"",on:{click:t.toggleReplay}},[o("div",{class:["rotate",t.replaying?"playHint":"stopHint"]})]),t._v(" "),o("div",{staticClass:"funcBtn undo",on:{click:t.undoRecord}},[o("div",{staticClass:"undoHint rotate"})]),t._v(" "),o("div",{staticClass:"funcBtn bounce",on:{click:t.bounceProject}},[o("div",{staticClass:"bounceHint rotate"})])])])])},pt=[],vt={render:ut,staticRenderFns:pt},ht=vt,mt=o("VU/8"),gt=p,ft=mt(lt,ht,!1,gt,"data-v-94d961f8",null),_t=ft.exports;window.Tone=o("ZnLv");var wt=new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster();new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),(new Tone.PluckSynth).toMaster();window.recorder=[],window.tonepart=[];var bt=[],kt=0,Ct={data:function(){return{activeNote:{},timerToStartRecord:0,recording:!1,replaying:!1}},methods:{load:function(){},startRecord:function(){var t=this;this.timerToStartRecord=3;var e=setInterval(function(){t.timerToStartRecord-=1,0==t.timerToStartRecord&&clearInterval(e)},1e3)},touchStartHandler:function(t){console.log("down",t.target.id),wt.triggerAttack(t.target.id),this.$set(this.activeNote,t.target.id,1),this.recording&&recorder.push({note:t.target.id,time:+((performance.now()-kt)/1e3).toFixed(4)})},touchEndHandler:function(t){wt.triggerRelease(t.target.id),this.$set(this.activeNote,t.target.id,0)},toggleRecord:function(t){var e=this;if(this.recording=!this.recording,this.recording){if(recorder=[],!this.replaying){this.timerToStartRecord=3;var o=setInterval(function(){e.timerToStartRecord-=1,0==e.timerToStartRecord&&(clearInterval(o),kt=performance.now())},1e3)}}else console.log("kikikiki"),recorder.length&&(tonepart[tonepart.length]=new Tone.Part(function(t,e){wt.triggerAttackRelease(e.note,"8n",t)},recorder).start(0))},toggleReplay:function(){console.log(1),this.replaying=!this.replaying,this.replaying?(console.log("kokokoko"),kt=performance.now(),Tone.Transport.start("+0.01")):Tone.Transport.stop(0)},undoRecord:function(){tonepart.pop().dispose()},bounceProject:function(){if(console.log(tonepart),bt=[],tonepart.length){for(tonepart.forEach(function(t){t._events.forEach(function(t){bt.push(t.value)})});tonepart.length;)tonepart.pop().dispose();tonepart[0]=new Tone.Part(function(t,e){wt.triggerAttackRelease(e.note,"8n",t)},bt).start(0),bt.sort(function(t,e){return 0+t.time-e.time}),console.log(bt),(void 0)(bt)}else alert("tm什么都没录")}},created:function(){/micromessenger/.test(navigator.userAgent.toLowerCase())&&(c("code")||M.get("serviceToken")?i(c("code")).then(function(t){t.data.errcode>=2e4&&(M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect"))},mounted:function(){},updated:function(){}},Tt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("div",{class:["mask",t.timerToStartRecord>1?"fadein":"fadeout",0==t.timerToStartRecord?"hide":""]},[o("p",{staticClass:"rotate",attrs:{id:"timer"}},[t._v(t._s(t.timerToStartRecord))])]),t._v(" "),o("div",{staticClass:"container"},[o("div",{staticClass:"keys",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.touchStartHandler(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.touchEndHandler(e)}}},[o("div",{class:["white","c",t.activeNote.C4?"active-note":""],attrs:{id:"C4"}}),t._v(" "),o("div",{class:["black","d-minor",t.activeNote.Db4?"active-note":""],attrs:{id:"Db4"}}),t._v(" "),o("div",{class:["white","d",t.activeNote.D4?"active-note":""],attrs:{id:"D4"}}),t._v(" "),o("div",{class:["black","e-minor",t.activeNote.Eb4?"active-note":""],attrs:{id:"Eb4"}}),t._v(" "),o("div",{class:["white","e",t.activeNote.E4?"active-note":""],attrs:{id:"E4"}}),t._v(" "),o("div",{class:["white","f",t.activeNote.F4?"active-note":""],attrs:{id:"F4"}}),t._v(" "),o("div",{class:["black","f-sharp",t.activeNote.Gb4?"active-note":""],attrs:{id:"Gb4"}}),t._v(" "),o("div",{class:["white","g",t.activeNote.G4?"active-note":""],attrs:{id:"G4"}}),t._v(" "),o("div",{class:["black","a-minor",t.activeNote.Ab4?"active-note":""],attrs:{id:"Ab4"}}),t._v(" "),o("div",{class:["white","a",t.activeNote.A4?"active-note":""],attrs:{id:"A4"}}),t._v(" "),o("div",{class:["black","b-minor",t.activeNote.Bb4?"active-note":""],attrs:{id:"Bb4"}}),t._v(" "),o("div",{class:["white","b",t.activeNote.B4?"active-note":""],attrs:{id:"B4"}}),t._v(" "),o("div",{class:["white","c",t.activeNote.C5?"active-note":""],attrs:{id:"C5"}}),t._v(" "),o("div",{class:["black","d-minor",t.activeNote.Db5?"active-note":""],attrs:{id:"Db5"}}),t._v(" "),o("div",{class:["white","d",t.activeNote.D5?"active-note":""],attrs:{id:"D5"}}),t._v(" "),o("div",{class:["black","e-minor",t.activeNote.Eb5?"active-note":""],attrs:{id:"Eb5"}}),t._v(" "),o("div",{class:["white","e",t.activeNote.E5?"active-note":""],attrs:{id:"E5"}}),t._v(" "),o("div",{class:["white","f",t.activeNote.F5?"active-note":""],attrs:{id:"F5"}}),t._v(" "),o("div",{class:["black","f-sharp",t.activeNote.Gb5?"active-note":""],attrs:{id:"Gb5"}}),t._v(" "),o("div",{class:["white","g",t.activeNote.G5?"active-note":""],attrs:{id:"G5"}}),t._v(" "),o("div",{class:["black","a-minor",t.activeNote.Ab5?"active-note":""],attrs:{id:"Ab5"}}),t._v(" "),o("div",{class:["white","a",t.activeNote.A5?"active-note":""],attrs:{id:"A5"}}),t._v(" "),o("div",{class:["black","b-minor",t.activeNote.Bb5?"active-note":""],attrs:{id:"Bb5"}}),t._v(" "),o("div",{class:["white","b",t.activeNote.B5?"active-note":""],attrs:{id:"B5"}}),t._v(" "),o("div",{class:["white","c",t.activeNote.C6?"active-note":""],attrs:{id:"C6"}})]),t._v(" "),o("div",{staticClass:"controller"},[o("div",{staticClass:"funcBtn record",class:t.recording?"active":"",on:{click:t.toggleRecord}},[o("div",{staticClass:"recordHint"})]),t._v(" "),o("div",{staticClass:"funcBtn play",class:t.replaying?"active":"",on:{click:t.toggleReplay}},[o("div",{class:["rotate",t.replaying?"playHint":"stopHint"]})]),t._v(" "),o("div",{staticClass:"funcBtn undo",on:{click:t.undoRecord}},[o("div",{staticClass:"undoHint rotate"})]),t._v(" "),o("div",{staticClass:"funcBtn bounce",on:{click:t.bounceProject}},[o("div",{staticClass:"bounceHint rotate"})])])])])},xt=[],yt={render:Tt,staticRenderFns:xt},Nt=yt,At=o("VU/8"),Et=v,St=At(Ct,Nt,!1,Et,"data-v-94d961f8",null),Pt=St.exports,Rt=o("mtWM"),It=o.n(Rt),Mt=o("fxnj"),Bt=o.n(Mt),Ft={headers:{Accept:"application/json","Content-Type":"application/json"}},Dt=function(){return new x.a(function(t,e){It.a.post("//api.musixise.com/wechat/getTicket?url="+window.location.href.split("#")[0],"",Ft).then(function(e){alert("before # url: "+window.location.href.split("#")[0]),alert(I()(e.data.data)),alert(I()({appId:e.data.data.appId,timestamp:e.data.data.timestamp,nonceStr:e.data.data.nonceStr,signature:e.data.data.signature})),Bt.a.config({debug:!0,appId:e.data.data.appId,timestamp:e.data.data.timestamp,nonceStr:e.data.data.nonceStr,signature:e.data.data.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"]}),Bt.a.ready(function(){t(Bt.a)})},function(){e("配置wx.config失败")})})},qt=function(t){var e=t.title,o=t.desc,i=t.fullPath,n=t.imgUrl,a=i;Bt.a.onMenuShareTimeline({title:e,link:a,imgUrl:n,success:function(){},cancel:function(){}}),Bt.a.onMenuShareAppMessage({title:e,desc:o,link:a,imgUrl:n,success:function(){},cancel:function(){}})},jt=(o("v2ns"),o("GDE4")),Ut=o.n(jt),Ht=o("7QTg");window.Tone=o("ZnLv");var Gt={},$t=void 0,Ot=new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster();new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),(new Tone.PluckSynth).toMaster(),document.documentElement.getBoundingClientRect().width,Math.max(document.documentElement.clientHeight,window.innerHeight||0);window.tonepart=[];var zt=[],Lt=0,Vt=!0,Xt=void 0,Wt=0,Jt=0,Yt={components:{swiper:Ht.swiper,swiperSlide:Ht.swiperSlide,vueSlider:Ut.a},data:function(){return{activeNote:{},recordPart:[],recordParts:[],playing:!1,generalControllerShow:!1,activeSwiperIndex:3,lastActiveSwiperIndex:2,vuetimeline:0,showExtendBtns:0,timelineConfig:{value:0,width:8,height:"90%",padding:"0",dotSize:20,eventType:"auto",min:0,max:200,interval:1,disabled:!1,show:!0,tooltip:"always",piecewise:!1,reverse:!0,style:{display:"inline-block"},class:"star-slider",direction:"vertical",speed:.1,bgStyle:{backgroundColor:"rgb(110,113,158)",boxShadow:"inset 0.5px 0.5px 3px 1px rgba(0,0,0,.36)"},tooltipStyle:{backgroundColor:"rgb(69, 106, 255)",borderColor:"rgb(69, 106, 255)"},formatter:function(t){return t?(t/10).toFixed(1)+"s/20s":"0.0s/20s"},processStyle:{backgroundColor:"rgb(69,106,255)"}}}},watch:{playing:function(t){var e=this;console.log("playing status",t),t?Xt=setInterval(function(){e.vuetimeline+=1,e.vuetimeline>=200&&(e.toggleReplay(),e.vuetimeline=0)},100):clearInterval(Xt)}},computed:{swiper:function(){return this.$refs.pianoRoll.swiper},activePartIndex:function(){return this.PARTNUM-this.activeSwiperIndex-1},lastActivePartIndex:function(){return this.PARTNUM-this.lastActiveSwiperIndex-1}},methods:{load:function(){},toggleReplay:function(){console.log(1),this.playing=!this.playing,this.playing?(this.vuetimeline>=200&&(this.vuetimeline=0),Wt=performance.now()-100*this.vuetimeline,console.log("播放开始"),this.confirmRecordPart(0),console.log("kokokoko"),Lt=performance.now(),console.log("activeOffsetTime"+100*this.vuetimeline),Tone.Transport.start("+0.01",100*this.vuetimeline/1e3)):(console.log("播放停了"),Tone.Transport.stop(0))},handleNoteStart:function(t){var e=0;Ot.triggerAttack(t),this.$set(this.activeNote,t,1),this.playing?e=performance.now()-Wt:(Vt&&(Lt=performance.now(),Jt=100*this.vuetimeline,Vt=!1),e=performance.now()-Lt+Jt),e<2e4?(this.vuetimeline=10*e/1e3,this.recordPart.push({note:t,time:+(e/1e3).toFixed(4)})):(this.vuetimeline=200,console.log("cannot record more than 20 seconds"))},handleNoteEnd:function(t){Ot.triggerRelease(t),this.$set(this.activeNote,t,0)},touchNoteStartHandler:function(t){console.log(t),Gt[t.changedTouches[0].identifier]=t.target.id,this.handleNoteStart(t.target.id)},touchNoteEndHandler:function(t){this.handleNoteEnd(t.target.id),this.handleNoteEnd(Gt[t.changedTouches[0].identifier])},confirmRecordPart:function(t){this.recordPart.length?(console.log("processing track: ",this.lastActivePartIndex),this.recordParts[this.lastActivePartIndex]&&this.recordParts[this.lastActivePartIndex].length&&(this.recordPart=this.recordPart.concat(this.recordParts[this.lastActivePartIndex])),tonepart[this.lastActivePartIndex]&&tonepart[this.lastActivePartIndex].dispose(),tonepart[this.lastActivePartIndex]=new Tone.Part(function(t,e){Ot.triggerAttackRelease(e.note,"8n",t)},this.recordPart).start(0),this.recordParts[this.lastActivePartIndex]=this.recordPart,this.recordPart=[]):console.log("啥也没录"),this.lastActiveSwiperIndex=this.activeSwiperIndex,t&&(this.vuetimeline=0,Lt=0),Vt=!0},clearRecordPart:function(t){console.log("cleaning track "+t),this.activePartIndex===t&&(this.recordPart=[]),this.recordParts[t]&&this.recordParts[t].length?(this.$set(this.recordParts,t,[]),tonepart[t].dispose(),tonepart[t]=void 0):console.log("track "+t+" has no content")},bounceProject:function(){var t=this;alert("此步骤确认，需要微信支付"),this.confirmRecordPart(0),console.log(this),console.log(tonepart),zt=[],tonepart.length?(tonepart.forEach(function(t){t._events.forEach(function(t){zt.push(t.value)})}),zt.sort(function(t,e){return 0+t.time-e.time}),this.$store.dispatch("BOUNCE_PROJECT",{record:zt,info:{title:"default",content:"default",cover:"default"}}).then(function(e){console.log("successfully bounced"),alert("作品已为您存储"),t.$router.push({path:"/new-music-box-viewer",query:{id:e}})})):alert("什么都没录呢")},mapNoteTimeToColor:function(t){return d(t)},mapNoteMidiToLength:function(t){return l(t)},adjustTimeline:function(t){this.playing?(console.log("ccccccccc"),this.toggleReplay()):Vt=!0},onMiniKeyboardScroll:function(t){console.log(t.touches[0].clientY)},onMiniKeyboardStart:function(t){console.log(t)},keng:function(t){console.log(t);for(var e=0;e<=t.changedTouches.length-1;e++){var o=document.elementFromPoint(t.changedTouches[e].clientX,t.changedTouches[e].clientY);o.classList.contains("white")||o.classList.contains("black")?Gt[t.changedTouches[e].identifier]&&Gt[t.changedTouches[e].identifier]!=o.getAttribute("id")?(console.log(Gt),this.handleNoteStart(o.getAttribute("id")),this.handleNoteEnd(Gt[t.changedTouches[e].identifier]),Gt[t.changedTouches[e].identifier]=o.getAttribute("id")):Gt[t.changedTouches[e].identifier]?console.log(3):(console.log(2),this.handleNoteStart(o.getAttribute("id")),Gt[t.changedTouches[e].identifier]=o.getAttribute("id")):(console.log("外边"),Gt[t.changedTouches[e].identifier]&&this.handleNoteEnd(Gt[t.changedTouches[e].identifier]),Gt[t.changedTouches[e].identifier]=void 0)}},btnStart:function(t){var e=this;console.log(t),$t=setTimeout(function(){e.showExtendBtns=!0},500)},btnEnd:function(t){clearTimeout($t);var e=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY);console.log(e),e&&e.classList.contains("bounceBtn")?this.bounceProject():e&&(e.classList.contains("playBtn")||e.classList.contains("pauseBtn"))&&this.toggleReplay(),this.showExtendBtns=!1}},created:function(){var t=this,e=document.documentElement;window.rem=e.getBoundingClientRect().width/10,e.style.fontSize=window.rem+"px",this.PARTNUM=3,this.pianoRollSwiperOption={initialSlide:this.PARTNUM,slidesPerView:3,on:{transitionEnd:function(e){console.log("3",this.activeIndex),t.activeSwiperIndex=this.activeIndex,t.confirmRecordPart(!Vt)}}},/micromessenger/.test(navigator.userAgent.toLowerCase())&&(Dt().then(function(){qt({title:"MUSIXISE",desc:"寻找你自己的八音盒",fullPath:location.href.split("#")[0],imgUrl:"http://oaeyej2ty.bkt.clouddn.com/Ocrg2srw_icon33@2x.png"})}),c("code")||M.get("serviceToken")?i(c("code")).then(function(t){t.data.errcode>=2e4&&(M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect"))},mounted:function(){},updated:function(){}},Zt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"container"}},[o("div",{staticClass:"keys",on:{touchmove:t.keng,touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.touchNoteStartHandler(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.touchNoteEndHandler(e)}}},[o("div",{class:["white","c",t.activeNote.C4?"active-note":""],attrs:{id:"C4"}}),t._v(" "),o("div",{class:["black","d-minor",t.activeNote.Db4?"active-note":""],attrs:{id:"Db4"}}),t._v(" "),o("div",{class:["white","d",t.activeNote.D4?"active-note":""],attrs:{id:"D4"}}),t._v(" "),o("div",{class:["black","e-minor",t.activeNote.Eb4?"active-note":""],attrs:{id:"Eb4"}}),t._v(" "),o("div",{class:["white","e",t.activeNote.E4?"active-note":""],attrs:{id:"E4"}}),t._v(" "),o("div",{class:["white","f",t.activeNote.F4?"active-note":""],attrs:{id:"F4"}}),t._v(" "),o("div",{class:["black","f-sharp",t.activeNote.Gb4?"active-note":""],attrs:{id:"Gb4"}}),t._v(" "),o("div",{class:["white","g",t.activeNote.G4?"active-note":""],attrs:{id:"G4"}}),t._v(" "),o("div",{class:["black","a-minor",t.activeNote.Ab4?"active-note":""],attrs:{id:"Ab4"}}),t._v(" "),o("div",{class:["white","a",t.activeNote.A4?"active-note":""],attrs:{id:"A4"}}),t._v(" "),o("div",{class:["black","b-minor",t.activeNote.Bb4?"active-note":""],attrs:{id:"Bb4"}}),t._v(" "),o("div",{class:["white","b",t.activeNote.B4?"active-note":""],attrs:{id:"B4"}}),t._v(" "),o("div",{class:["white","c",t.activeNote.C5?"active-note":""],attrs:{id:"C5"}}),t._v(" "),o("div",{class:["black","d-minor",t.activeNote.Db5?"active-note":""],attrs:{id:"Db5"}}),t._v(" "),o("div",{class:["white","d",t.activeNote.D5?"active-note":""],attrs:{id:"D5"}}),t._v(" "),o("div",{class:["black","e-minor",t.activeNote.Eb5?"active-note":""],attrs:{id:"Eb5"}}),t._v(" "),o("div",{class:["white","e",t.activeNote.E5?"active-note":""],attrs:{id:"E5"}}),t._v(" "),o("div",{class:["white","f",t.activeNote.F5?"active-note":""],attrs:{id:"F5"}}),t._v(" "),o("div",{class:["black","f-sharp",t.activeNote.Gb5?"active-note":""],attrs:{id:"Gb5"}}),t._v(" "),o("div",{class:["white","g",t.activeNote.G5?"active-note":""],attrs:{id:"G5"}}),t._v(" "),o("div",{class:["black","a-minor",t.activeNote.Ab5?"active-note":""],attrs:{id:"Ab5"}}),t._v(" "),o("div",{class:["white","a",t.activeNote.A5?"active-note":""],attrs:{id:"A5"}}),t._v(" "),o("div",{class:["black","b-minor",t.activeNote.Bb5?"active-note":""],attrs:{id:"Bb5"}}),t._v(" "),o("div",{class:["white","b",t.activeNote.B5?"active-note":""],attrs:{id:"B5"}}),t._v(" "),o("div",{class:["white","c",t.activeNote.C6?"active-note":""],attrs:{id:"C6"}}),t._v(" "),o("div",{class:["black","d-minor",t.activeNote.Db6?"active-note":""],attrs:{id:"Db6"}}),t._v(" "),o("div",{class:["white","d",t.activeNote.D6?"active-note":""],attrs:{id:"D6"}}),t._v(" "),o("div",{class:["black","e-minor",t.activeNote.Eb6?"active-note":""],attrs:{id:"Eb6"}}),t._v(" "),o("div",{class:["white","e",t.activeNote.E6?"active-note":""],attrs:{id:"E6"}}),t._v(" "),o("div",{class:["white","f",t.activeNote.F6?"active-note":""],attrs:{id:"F6"}})]),t._v(" "),o("div",{staticClass:"keyshadow"}),t._v(" "),o("div",{staticClass:"scroll-container"}),t._v(" "),o("div",{staticClass:"semi-piano-roll",on:{touchmove:function(t){t.stopPropagation(),t.preventDefault()}}},[o("swiper",{ref:"pianoRoll",attrs:{options:t.pianoRollSwiperOption}},[t._l(t.PARTNUM,function(e){return o("swiper-slide",[o("div",{staticClass:"current-piano-roll"},[o("svg",{style:{height:"90%",padding:t.timelineConfig.dotSize/2+"px 0"}},[o("defs",[o("filter",{attrs:{id:"glowing",height:"400%",width:"130%",x:"-10%",y:"-130%"}},[o("feMorphology",{attrs:{operator:"dilate",radius:"1",in:"SourceAlpha",result:"thicken"}}),t._v(" "),o("feGaussianBlur",{attrs:{in:"thicken",stdDeviation:"2",result:"blurred"}}),t._v(" "),o("feFlood",{attrs:{"flood-color":"rgb(200,200,255)",result:"glowColor"}}),t._v(" "),o("feComposite",{attrs:{in:"glowColor",in2:"blurred",operator:"in",result:"softGlow_colored"}}),t._v(" "),o("feMerge",[o("feMergeNode",{attrs:{in:"softGlow_colored"}}),t._v(" "),o("feMergeNode",{attrs:{in:"SourceGraphic"}})],1)],1)]),t._v(" "),t._l(t.recordPart,function(i,n){return t.activePartIndex===t.PARTNUM-e?o("rect",{attrs:{x:2,y:100*i.time/20+"%",width:t.mapNoteMidiToLength(i.note),height:"3",rx:"2",ry:"2",fill:t.mapNoteTimeToColor(i.time),filter:"url(#glowing)"}}):t._e()}),t._v(" "),t._l(t.recordParts[t.PARTNUM-e],function(i,n){return o("rect",{attrs:{x:2,y:100*i.time/20+"%",width:t.mapNoteMidiToLength(i.note),height:"3",rx:"2",ry:"2",fill:t.activePartIndex===t.PARTNUM-e?t.mapNoteTimeToColor(i.time):"rgb(120,120,120)",filter:t.activePartIndex===t.PARTNUM-e?"url(#glowing)":""}})})],2),t._v(" "),o("div",{staticClass:"temp",on:{click:function(o){t.clearRecordPart(t.PARTNUM-e)}}})])])}),t._v(" "),o("swiper-slide"),t._v(" "),o("swiper-slide")],2)],1),t._v(" "),o("div",{staticClass:"g-controller"},[o("vue-slider",t._b({on:{callback:t.adjustTimeline,"drag-end":function(t){}},model:{value:t.vuetimeline,callback:function(e){t.vuetimeline=e},expression:"vuetimeline"}},"vue-slider",t.timelineConfig,!1)),t._v(" "),o("div",{staticClass:"btnContainer",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.btnStart(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.btnEnd(e)}}},[o("div",{class:[t.playing?"pauseBtn":"playBtn","rotate"],on:{click:t.toggleReplay}}),t._v(" "),o("div",{class:[t.showExtendBtns?"extendBtnsShow":"extendBtnsHide","extendBtns"]},[o("div",{staticClass:"bounceBtn rotate"})])])],1)])},Kt=[],Qt={render:Zt,staticRenderFns:Kt},te=Qt,ee=o("VU/8"),oe=h,ie=ee(Yt,te,!1,oe,"data-v-4896ad33",null),ne=ie.exports;window.Tone=o("ZnLv");var ae=void 0,re=new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),ce={components:{},data:function(){return{playing:!1}},computed:{project:function(){return this.$store.state.recordProject},projectInfo:function(){return this.$store.state.recordProjectInfo}},methods:{load:function(){},prepareMusic:function(){try{ae.dispose()}catch(t){}ae=new Tone.Part(function(t,e){re.triggerAttackRelease(e.note,"8n",t)},this.project).start(0)},togglePlayMusic:function(){this.project.length&&Tone.Transport.start("+0.01",0)},loadMusicById:function(){var t=this;console.log("hehe",this.$store.state);var e=this.$store.state.route.query.id;e?(console.log("mmm",e),this.$store.dispatch("FETCH_MBOX",{id:e}).then(function(){console.log("workPart",t.project),console.log("work info",t.projectInfo),t.prepareMusic(),t.togglePlayMusic()})):this.project.length?this.prepareMusic():this.$store.dispatch("FETCH_MBOX",{id:50}).then(function(){console.log("workPart",t.project),console.log("work info",t.projectInfo),t.prepareMusic(),t.togglePlayMusic()})},togglePlay:function(){this.playing=!this.playing,this.playing?Tone.Transport.start("+0.01",0):Tone.Transport.stop(0)}},created:function(){var t=this;alert(1),t.loadMusicById(),/micromessenger/.test(navigator.userAgent.toLowerCase())&&(c("code")||M.get("serviceToken")?i(c("code")).then(function(t){t.data.errcode>=2e4&&(M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+location.href+"&response_type=code&scope=snsapi_userinfo&state=type&quan,url="+location.href+"&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+location.href+"&response_type=code&scope=snsapi_userinfo&state=type&quan,url="+location.href+"&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+location.href+"&response_type=code&scope=snsapi_userinfo&state=type&quan,url="+location.href+"&connect_redirect=1#wechat_redirect"))},mounted:function(){},updated:function(){}},se=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"container"}},[o("div",{staticClass:"mb"},[o("div",{class:[t.playing?"pauseBtn":"playBtn","rotate"],on:{click:t.togglePlay}})]),t._v(" "),t._m(0,!1,!1)])},de=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"operate"},[o("div",{staticClass:"share"}),t._v(" "),o("div",{staticClass:"purchase"})])}],le={render:se,staticRenderFns:de},ue=le,pe=o("VU/8"),ve=m,he=pe(ce,ue,!1,ve,"data-v-07efc117",null),me=he.exports,ge={props:{initCount:Number,initActive:Boolean,iconImg:String,onClickCall:{type:Function,default:function(){return function(){console.log("tap tap in count Button")}}}},computed:{style:function(){}},data:function(){return{currentActiveCount:0,currentActive:!1}},watch:{},created:function(){this.currentActive=this.initActive,this.currentActiveCount=this.currentActive?this.initCount:this.initCount+1},mounted:function(){},updated:function(){},methods:{updateButton:function(){this.currentActive=!this.currentActive,this.onClickCall()}}},fe=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"btnContainer",on:{click:t.updateButton}},[o("transition",{attrs:{name:"fade"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.currentActive,expression:"currentActive"}],staticClass:"active-btn-background"})]),t._v(" "),o("transition",{attrs:{name:"slideDown"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.currentActive,expression:"currentActive"}],staticClass:"btn active"},[o("div",{}),t._v(" "),o("p",[t._v(t._s(t.currentActiveCount))])])]),t._v(" "),o("transition",{attrs:{name:"slideUp"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.currentActive,expression:"!currentActive"}],staticClass:"btn inactive"},[o("div",{}),t._v(" "),o("p",[t._v(t._s(t.currentActiveCount-1))])])])],1)},_e=[],we={render:fe,staticRenderFns:_e},be=we,ke=o("VU/8"),Ce=g,Te=ke(ge,be,!1,Ce,"data-v-fd02150e",null),xe=Te.exports;window.Tone=o("ZnLv");var ye=(new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),{components:{countButton:xe},data:function(){return{loading:!0,workIntroAppear:!1,controlPanalAppear:!1,playing:!1}},computed:{project:function(){return this.$store.state.recordProject},projectInfo:function(){return this.$store.state.recordProjectInfo}},methods:{load:function(){},loadMusicById:function(){var t=this;console.log("hehe",this.$store.state);var e=this.$store.state.route.query.id;e?(console.log("mmm",e),this.$store.dispatch("FETCH_MBOX",{id:e}).then(function(){console.log("workPart",t.project),console.log("work info",t.projectInfo)})):this.$store.dispatch("FETCH_MBOX",{id:50}).then(function(){console.log("workPart",t.project),console.log("work info",t.projectInfo)})},togglePlay:function(){u(this.project),this.playing=!this.playing},toggleFav:function(){console.log("s")},redirectToMaker:function(){this.$router.push({path:"/new-music-box-maker"})},purchaseItem:function(){console.log("you are about to purchase "+this.projectInfo.id)}},created:function(){var t=this,e=this,o=document.documentElement;window.rem=o.getBoundingClientRect().width/10,o.style.fontSize=window.rem+"px",e.loadMusicById(),/micromessenger/.test(navigator.userAgent.toLowerCase())&&(Dt().then(function(){qt({title:"MUSIXISE",desc:"寻找你自己的八音盒",fullPath:location.href.split("#")[0],imgUrl:"http://oaeyej2ty.bkt.clouddn.com/Ocrg2srw_icon33@2x.png"})}),c("code")||M.get("serviceToken")?i(c("code")).then(function(o){o.data.errcode>=2e4&&(M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+location.href+"&response_type=code&scope=snsapi_userinfo&state=type&quan,url="+location.href+"&connect_redirect=1#wechat_redirect")),alert("welcome"+o.data.data.realname),t.project||e.loadMusicById(),console.log("get user info success",o.data.data)}).catch(function(t){M.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+location.href+"&response_type=code&scope=snsapi_userinfo&state=type&quan,url="+location.href+"&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+location.href+"&response_type=code&scope=snsapi_userinfo&state=type&quan,url="+location.href+"&connect_redirect=1#wechat_redirect"))},mounted:function(){var t=this;setTimeout(function(){t.loading=!1},1500),setTimeout(function(){t.workIntroAppear=!0},4e3),setTimeout(function(){t.controlPanalAppear=!0},5e3)},updated:function(){}}),Ne=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:["container",t.loading?"loading":""]},[o("div",{attrs:{id:"ground"}}),t._v(" "),t._m(0,!1,!1),t._v(" "),o("div",{attrs:{id:"mb"},on:{click:t.togglePlay}},[o("div",{class:["mb-part",t.playing?"playing":""],attrs:{id:"mb-lid"}}),t._v(" "),o("div",{staticClass:"mb-part",attrs:{id:"mb-body"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.playing,expression:"!playing"}],attrs:{id:"play-btn"}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],attrs:{id:"pause-btn"}})])]),t._v(" "),o("div",{attrs:{id:"low-leaf1"}}),t._v(" "),o("div",{attrs:{id:"low-leaf2"}}),t._v(" "),o("div",{attrs:{id:"low-leaf3"}}),t._v(" "),o("div",{attrs:{id:"low-leaf4"}}),t._v(" "),o("div",{attrs:{id:"mid-leaf1"}}),t._v(" "),o("div",{attrs:{id:"mid-leaf2"}}),t._v(" "),o("div",{attrs:{id:"mid-leaf3"}}),t._v(" "),o("div",{attrs:{id:"mid-leaf4"}}),t._v(" "),o("div",{attrs:{id:"top-leaf1"}}),t._v(" "),o("div",{attrs:{id:"top-leaf2"}}),t._v(" "),o("div",{attrs:{id:"top-leaf3"}}),t._v(" "),o("div",{attrs:{id:"top-leaf4"}}),t._v(" "),o("div",{attrs:{id:"top-leaf5"}}),t._v(" "),o("div",{attrs:{id:"top-leaf6"}}),t._v(" "),o("transition",{attrs:{name:"bounce"}},[t.workIntroAppear?o("div",{attrs:{id:"work-intro"}},[o("div",{staticClass:"title"},[t._v(t._s(t.projectInfo.title))]),t._v(" "),o("div",{staticClass:"subtitle"},[o("span",[t._v("by")]),t._v(" "),o("span",[o("img",{attrs:{src:t.projectInfo.owner.smallAvatar,alt:""}})]),o("span",[t._v(t._s(t.projectInfo.owner.nickName))])])]):t._e()]),t._v(" "),o("transition",{attrs:{name:"bounce"}},[t.controlPanalAppear?o("div",{attrs:{id:"control-panal"}},[o("count-button",{attrs:{initCount:t.projectInfo.collectNum?t.projectInfo.collectNum:0,initActive:!!t.projectInfo.favStatus,iconImg:"",onClickCall:t.toggleFav}}),t._v(" "),o("div",{staticClass:"purchaseBtn",on:{click:t.purchaseItem}},[t._v("购买")]),t._v(" "),o("div",{staticClass:"makeBtn",on:{click:t.redirectToMaker}},[t._v("编曲")])],1):t._e()])],1)},Ae=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"spirit"}},[o("div",{staticClass:"spirit-part",attrs:{id:"spirit-body"}}),t._v(" "),o("div",{staticClass:"spirit-part",attrs:{id:"spirit-front-leaf"}}),t._v(" "),o("div",{staticClass:"spirit-part",attrs:{id:"spirit-back-leaf"}}),t._v(" "),o("div",{staticClass:"spirit-part",attrs:{id:"spirit-back1"}}),t._v(" "),o("div",{staticClass:"spirit-part",attrs:{id:"spirit-back2"}})])}],Ee={render:Ne,staticRenderFns:Ae},Se=Ee,Pe=o("VU/8"),Re=f,Ie=Pe(ye,Se,!1,Re,"data-v-167b6bfe",null),Me=Ie.exports;_.a.use(W.a);var Be=new W.a({routes:[{path:"/",name:"HelloWorld",component:it},{path:"/music-box-maker",name:"MBMaker",component:_t},{path:"/new-music-box-maker",name:"NMBMaker",component:ne},{path:"/new-music-box-viewer",name:"NMBViewer",component:Me},{path:"/music-box-viewer",name:"MBViewer",component:me},{path:"/music-box-author",name:"MBAuthor",component:Pt}]});_.a.use(k.a,{name:"v-touch"}),_.a.config.productionTip=!1;var Fe=function(){return new C.a.Store({state:{activeType:null,itemsPerPage:20,items:{},users:{},lists:{top:[],new:[],show:[],ask:[],job:[]},recordParts:[],recordProject:[]},actions:D,mutations:q,getters:j})}();Object(w.sync)(Fe,Be),new _.a({el:"#app",router:Be,store:Fe,template:"<App/>",components:{App:X}})},"O/d9":function(t,e){},hoXB:function(t,e){},v2ns:function(t,e){},"vf/z":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.9ca7afb13e268043c01a.js.map