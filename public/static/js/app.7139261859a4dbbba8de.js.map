{"version":3,"sources":["webpack:///static/js/app.7139261859a4dbbba8de.js","webpack:///./src/_common/js/api.js","webpack:///./src/App.vue","webpack:///./src/components/HelloWorld.vue","webpack:///./src/_common/js/util.js","webpack:///./src/_common/js/magic.js","webpack:///./src/components/MBMaker.vue","webpack:///./src/components/MBItem.vue","webpack:///./src/components/MBAuthor.vue","webpack:///./src/components/NMBMaker.vue","webpack:///./src/components/MBViewer.vue","webpack:///./src/store/actions.js","webpack:///./src/store/mutations.js","webpack:///./src/store/getters.js","webpack:///./src/store/index.js","webpack:///src/App.vue","webpack:///./src/App.vue?aedc","webpack:///src/components/HelloWorld.vue","webpack:///./src/components/HelloWorld.vue?a343","webpack:///src/components/MBMaker.vue","webpack:///./src/components/MBMaker.vue?d60e","webpack:///src/components/MBItem.vue","webpack:///./src/components/MBItem.vue?1f84","webpack:///src/components/MBAuthor.vue","webpack:///./src/components/MBAuthor.vue?7acf","webpack:///src/components/NMBMaker.vue","webpack:///./src/components/NMBMaker.vue?e96c","webpack:///src/components/MBViewer.vue","webpack:///./src/components/MBViewer.vue?1147","webpack:///./src/router/index.js","webpack:///./src/main.js"],"names":["webpackJsonp","BoD0","module","exports","CA19","GWyx","IEmI","NHnr","__webpack_exports__","__webpack_require__","getUserInfo","wxcode","tokenInCookie","reqConfig","headers","Authorization","axios","post","promise_default","a","resolve","reject","then","res","data","errcode","serviceToken","id_token","js_cookie","expires","catch","err","uploadRecord","record","info","_this","this","formReqConfig","Content-Type","processData","blob","Blob","stringify_default","reader","FileReader","onload","_ref","asyncToGenerator_default","regenerator_default","mark","_callee","event","fd","postFix","workURL","param","wrap","_context","prev","next","FormData","append","target","result","sent","extends_default","url","console","log","abrupt","stop","_x","apply","arguments","readAsDataURL","fetchMbox","id","injectStyle","ssrContext","HelloWorld_injectStyle","getUrlParam","key","reg","RegExp","match","location","search","RealMagic","items","tasksObj","forEach","item","itemNoteFreq","parseInt","magic_Tone","Frequency","note","toFrequency","push","time","taskTypes","keys_default","taskTimeArrays","values_default","machines","groups","length","timeArray","index","final","j","test","allPreviousOccupied","successFound","counter","SAME_NOTE_INTERVAL","indexOf","concat","toConsumableArray_default","set_default","Math","max","group","count","lastMachine","finalBins","reduce","b","map","finalTimings","musicboxPins","bin","magic_mapNoteTimeToColor","COLOR1","COLOR2","COLOR3","rgb","floor","magic_mapNoteMidiToLength","noteName","toMidi","MBMaker_injectStyle","MBItem_injectStyle","MBAuthor_injectStyle","NMBMaker_injectStyle","MBViewer_injectStyle","Object","defineProperty","value","vue_esm","vuex_router_sync","vue_touch","vue_touch_default","n","vuex_esm","promise","regenerator","helpers_extends","asyncToGenerator","stringify","Accept","actions","BOUNCE_PROJECT","_ref2","commit","state","FETCH_MBOX","_ref3","_ref4","project","request","XMLHttpRequest","open","send","onreadystatechange","readyState","status","getResponseHeader","JSON","parse","responseText","FETCH_LIST_DATA","_ref5","_ref6","dispatch","type","undefined","ids","ENSURE_ACTIVE_ITEMS","_ref7","getters","activeIds","FETCH_ITEMS","_ref8","_ref9","now","Date","filter","__lastUpdated","FETCH_USER","_ref10","_ref11","users","user","mutations","SET_USER_INFO","activeType","SET_WORK_INFO","lists","SET_MUSIXISER_INFO","set","SET_BOUNCE_PROJECT","recordProject","SET_ID_PROJECT","recordProjectInfo","SET_FINAL_WORK","SET_USER","itemsPerPage","page","Number","route","params","start","end","slice","activeItems","_","use","App","name","render","_vm","_h","$createElement","_c","_self","attrs","staticRenderFns","esExports","selectortype_template_index_0_src_App","normalizeComponent","__vue_styles__","Component","src_App","vue_router_esm","HelloWorld","msg","company","title","tel","HelloWorld_render","staticClass","_v","_s","directives","rawName","expression","domProps","on","input","$event","composing","_m","HelloWorld_staticRenderFns","HelloWorld_esExports","components_HelloWorld","HelloWorld_normalizeComponent","HelloWorld___vue_styles__","HelloWorld_Component","src_components_HelloWorld","toConsumableArray","values","keys","window","Tone","piano","Sampler","C4","D#4","F#4","A4","C5","D#5","F#5","A5","C6","release","baseUrl","toMaster","PluckSynth","recorder","tonepart","bouncepart","timeline","MBMaker","activeNote","timerToStartRecord","recording","replaying","methods","load","startRecord","timer","setInterval","clearInterval","touchStartHandler","e","triggerAttack","$set","performance","toFixed","touchEndHandler","triggerRelease","toggleRecord","_this2","Part","triggerAttackRelease","toggleReplay","Transport","undoRecord","pop","dispose","bounceProject","_events","noteInfo","sort","alert","created","navigator","userAgent","toLowerCase","replace","realname","mounted","updated","MBMaker_render","class","touchstart","stopPropagation","preventDefault","touchend","_k","keyCode","Db4","D4","Eb4","E4","F4","Gb4","G4","Ab4","Bb4","B4","Db5","D5","Eb5","E5","F5","Gb5","G5","Ab5","Bb5","B5","click","MBMaker_staticRenderFns","MBMaker_esExports","components_MBMaker","MBMaker_normalizeComponent","MBMaker___vue_styles__","MBMaker_Component","src_components_MBMaker","MBItem","userInfo","wx","onMenuShareTimeline","link","imgUrl","success","cancel","MBItem_render","MBItem_staticRenderFns","MBItem_esExports","components_MBItem","MBItem_normalizeComponent","MBItem___vue_styles__","MBItem_Component","src_components_MBItem","MBAuthor_piano","MBAuthor_bouncepart","MBAuthor_timeline","MBAuthor","MBAuthor_render","MBAuthor_staticRenderFns","MBAuthor_esExports","components_MBAuthor","MBAuthor_normalizeComponent","MBAuthor___vue_styles__","MBAuthor_Component","src_components_MBAuthor","dist","dist_default","vue_awesome_swiper","touchIdKeyMap","extendBtnsTimeout","NMBMaker_piano","document","documentElement","getBoundingClientRect","width","clientHeight","innerHeight","NMBMaker_bouncepart","recordStartTime","isLinger","replayInterval","playOffset","lingerOffset","NMBMaker","components","swiper","swiperSlide","vueSlider","recordPart","recordParts","playing","generalControllerShow","activeSwiperIndex","lastActiveSwiperIndex","vuetimeline","showExtendBtns","timelineConfig","height","padding","dotSize","eventType","min","interval","disabled","show","tooltip","piecewise","reverse","style","display","direction","speed","bgStyle","backgroundColor","boxShadow","tooltipStyle","borderColor","formatter","processStyle","watch","val","PROGRESS_INTERVAL_TIME","computed","$refs","pianoRoll","activePartIndex","PARTNUM","lastActivePartIndex","confirmRecordPart","handleNoteStart","noteId","noteTime","handleNoteEnd","touchNoteStartHandler","changedTouches","identifier","touchNoteEndHandler","shouldClearTime","clearRecordPart","trackNum","$store","content","cover","mapNoteTimeToColor","t","mapNoteMidiToLength","m","adjustTimeline","onMiniKeyboardScroll","touches","clientY","onMiniKeyboardStart","keng","i","elementFromPoint","clientX","classList","contains","getAttribute","btnStart","setTimeout","btnEnd","clearTimeout","self","docElem","rem","fontSize","pianoRollSwiperOption","initialSlide","slidesPerView","transitionEnd","activeIndex","NMBMaker_render","touchmove","Db6","D6","Eb6","E6","F6","ref","options","_l","stdDeviation","in","x","y","rx","ry","fill","_e","_b","callback","drag-end","model","$$v","NMBMaker_staticRenderFns","NMBMaker_esExports","components_NMBMaker","NMBMaker_normalizeComponent","NMBMaker___vue_styles__","NMBMaker_Component","src_components_NMBMaker","musicPart","MBViewer_mbox","MBViewer","prepareMusic","loadMusicById","query","togglePlay","inWechat","MBViewer_render","MBViewer_staticRenderFns","MBViewer_esExports","components_MBViewer","MBViewer_normalizeComponent","MBViewer___vue_styles__","MBViewer_Component","src_components_MBViewer","router","mode","routes","path","component","config","productionTip","store","Store","top","new","ask","job","el","template","ViPM","e1+N","ibai","v2ns"],"mappings":"AAAAA,cAAc,IAERC,KACA,SAAUC,EAAQC,KAMlBC,KACA,SAAUF,EAAQC,KAMlBE,KACA,SAAUH,EAAQC,KAMlBG,KACA,SAAUJ,EAAQC,KAMlBI,KACA,SAAUL,EAAQM,EAAqBC,GAE7C,YCpBO,SAASC,GAAYC,GAC1B,MAAIC,IACFC,EAAUC,QAAQC,cAAlB,UAA4CH,EACrCI,EAAMC,KAAK,sCAAuC,GAAIJ,MACnDD,IAAiBD,IACpB,GAAAO,GAAAC,EAAY,SAACC,EAASC,GAC3BL,EAAMC,KAAN,0DAAqEN,EAAU,GAAIE,GAChFS,KAAK,SAACC,GACoB,QAArBA,EAAIC,KAAKC,SACXJ,EAAO,MAET,IAAMK,GAAeH,EAAIC,KAAKA,KAAKG,QAKnC,OAJAd,GAAUC,QAAQC,cAAlB,UAA4CW,EAC5CE,EAAA,IAAY,eAAgBF,GAC1BG,QAAS,IAEJb,EAAMC,KAAK,sCAAuC,GAAIJ,IAC5D,WACDQ,MAEDC,KAAK,SAACC,GACLH,EAAQG,KAETO,MAAM,SAACC,GACNV,EAAOU,OAQV,QAASC,GAAaC,EAAQC,GAAM,GAAAC,GAAAC,IACzC,OAAO,IAAAlB,GAAAC,EAAY,SAACC,EAASC,GAC3B,GAAMgB,IAAkBvB,SAAWwB,eAAgB,sBAAuBC,aAAa,IACjFC,EAAO,GAAIC,OAAMC,IAAeT,KAChCU,EAAS,GAAIC,WACnBD,GAAOE,OAAP,cAAAC,GAAAC,IAAAC,EAAA7B,EAAA8B,KAAgB,QAAAC,GAAOC,GAAP,GAAAC,GAAAC,EAAAC,EAAAC,CAAA,OAAAP,GAAA7B,EAAAqC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,aACRP,GAAK,GAAIQ,UACfR,EAAGS,OAAO,QAAS,YACnBT,EAAGS,OAAO,OAAQV,EAAMW,OAAOC,QAHjBN,EAAAE,KAAA,EAIQ3C,EAAMC,KAAK,qCAAsCmC,EAAIf,EAJ7D,cAIRgB,GAJQI,EAAAO,KAKRV,EALQ,oCAKsCD,EAC9CE,EANQU,OAOT/B,GACHgC,IAAKZ,IAEPa,QAAQC,IAAId,GAVEG,EAAAY,OAAA,SAWPrD,EAAMC,KAAK,qCAAsCyB,IAAea,GAAQ1C,GACrES,KAAK,SAACC,GACLH,EAAQG,KAETO,MAAM,SAACC,GACNV,EAAOU,KAhBJ,yBAAA0B,GAAAa,SAAApB,EAAAf,KAAhB,iBAAAoC,GAAA,MAAAzB,GAAA0B,MAAApC,KAAAqC,eAmBA9B,EAAO+B,cAAclC,KAKlB,QAASmC,GAAUC,GACxB,MAAO5D,GAAMC,KAAN,sCAAiD2D,EAAM,GAAI/D,GC3EpE,QAAAgE,GAAAC,GACArE,EAAA,QCDA,QAAAsE,GAAAD,GACArE,EAAA,QCDO,QAASuE,GAAYC,GAC1B,GAAMC,GAAM,GAAIC,QAAJ,QAAmBF,EAAnB,YACNG,EAAQC,SAASC,OAAOF,MAAMF,EACpC,OAAOE,IAASA,EAAM,GCejB,QAASG,GAAUC,GACxBrB,QAAQC,IAAI,yBACZD,QAAQC,IAAI1B,IAAe8C,GAC3B,IAAMC,KACND,GAAME,QAAQ,SAACC,GAEb,GAAMC,GAAeC,SAAmD,EAA1CC,GAAKC,UAAUJ,EAAKK,MAAMC,cAAmB,GACtER,GAASG,KAAiBH,EAASG,OACxCH,EAASG,GAAcM,KAAKP,EAAKQ,OAKnC,IAAMC,GAAYC,KAAYZ,GACxBa,EAAiBC,KAAcd,GAC/Be,KACAC,IAEN,IAAIL,EAAUM,OAAS,GAErB,MADAvC,SAAQC,IAAI,mBACL,CA+CT,IA5CAkC,EAAeZ,QAAQ,SAACiB,EAAWC,GACjC,GAAMC,KACNF,GAAUjB,QAAQ,SAACS,EAAMW,GACvB,GAAMC,MACFC,GAAsB,EACtBC,GAAe,CACnB,IAAU,IAANH,EACFD,EAAMX,KAAK,OACN,CAEL,IADA,GAAIgB,GAAUJ,EACPI,GAAW,IAAMF,GAAqB,CAE3C,GADAE,GAAW,EACNf,EAAOQ,EAAUO,IAAYC,KAAyD,IAAlCJ,EAAKK,QAAQP,EAAMK,IAAkB,CAC5FL,EAAMX,KAAKW,EAAMK,IACjBD,GAAe,CACf,OACK,IAAsC,IAAlCF,EAAKK,QAAQP,EAAMK,MAC5BH,EAAKb,KAAKW,EAAMK,OACZG,OAAAC,KAAI,GAAAC,IAAApG,EAAQ0F,KAAQH,YAAWW,OAAAC,KAAI,GAAAC,IAAApG,EAAQ4F,KAAOL,QAAQ,CAE5DM,GAAsB,CACtB,SAIW,IAAZE,IAAkBD,GAAiBD,IACtCH,EAAMX,KAAKsB,KAAKC,IAALjD,MAAAgD,KAAYX,GAAS,MAItCJ,EAAOP,KAAKW,KAEd1C,QAAQC,IAAIgC,GACZjC,QAAQC,IAAIkC,GACZnC,QAAQC,IAAI,OAAQqC,GAGpBA,EAAOf,QAAQ,SAACgC,EAAOd,GAErB,IADA,GAAIe,GAAQ,EACLA,GAASH,KAAKC,IAALjD,MAAAgD,KAAAF,KAAYI,IAAS,GACnClB,EAASN,KAAKE,EAAUQ,IACxBe,GAAS,IAGTnB,EAASE,OAAS,GAEpB,IADA,GAAMkB,GAAcpB,EAASA,EAASE,OAAS,GACxCF,EAASE,OAAS,IACvBF,EAASN,KAAK0B,OAGX,IAAIpB,EAASE,OAAS,GAE3B,MADAvC,SAAQC,IAAI,eACL,CAETD,SAAQC,IAAIoC,EAKZ,IAAMqB,GAAYpB,EAAOqB,OAAO,SAAC3G,EAAG4G,GAAJ,MAAU5G,GAAEkG,OAAOU,EAAEC,IAAI,SAAArC,GAAA,MAAQA,GAAO6B,KAAKC,IAALjD,MAAAgD,KAAAF,KAAYnG,SAChF8G,EAAe3B,EAAewB,OAAO,SAAC3G,EAAG4G,GAAJ,MAAU5G,GAAEkG,OAAOU,IAC5DE,GAAeA,EAAaD,IAAI,SAAArC,GAAA,MAAgB,IAAPA,EAAa,IACtD,IAAMuC,GAAeL,EAAUG,IAAI,SAACG,EAAKvB,GAAN,qBAA+BqB,EAAarB,GAA5C,IAAsDuB,EAAtD,KACnChE,SAAQC,IAAR,qqBAiBsB8D,EAjBtB,+EAkFK,QAASE,GAAmBjC,GAEjC,GAAMkC,IAAU,IAAK,IAAK,KACpBC,GAAU,GAAI,IAAK,KACnBC,GAAU,IAAK,IAAK,KAEtBC,GAAO,EAAG,EAAG,EAYjB,OAXIrC,GAAO,GAAKA,EAFC,IAINA,GAAQ,KACjBqC,GAAOH,EAAO,GAAOlC,GAAQmC,EAAO,GAAKD,EAAO,IAA5B,GAClBA,EAAO,GAAOlC,GAAQmC,EAAO,GAAKD,EAAO,IAA5B,GACbA,EAAO,GAAOlC,GAAQmC,EAAO,GAAKD,EAAO,IAA5B,KAEjBG,GAAOF,EAAO,GAAOnC,GAAQoC,EAAO,GAAKD,EAAO,IAA5B,GAClBA,EAAO,GAAOnC,GAAQoC,EAAO,GAAKD,EAAO,IAA5B,GACbA,EAAO,GAAOnC,GAAQoC,EAAO,GAAKD,EAAO,IAA5B,IAEf,OAAcd,KAAKiB,MAAMD,EAAI,IAA7B,IAAoChB,KAAKiB,MAAMD,EAAI,IAAnD,IAA0DhB,KAAKiB,MAAMD,EAAI,IAAzE,IAEK,QAASE,GAAoBC,GAIlC,WAAwB7C,GAAKC,UAAU4C,GAAUC,SAAW,IAArC,GAAZ,GAAsE,IClNnF,QAAAC,GAAA/D,GACArE,EAAA,QCDA,QAAAqI,GAAAhE,GACArE,EAAA,QCDA,QAAAsI,GAAAjE,GACArE,EAAA,QCDA,QAAAuI,GAAAlE,GACArE,EAAA,QCDA,QAAAwI,GAAAnE,GACArE,EAAA,QViCAyI,OAAOC,eAAe3I,EAAqB,cAAgB4I,OAAO,GAGlE,IAAIC,GAAU5I,EAAoB,QAG9B6I,EAAmB7I,EAAoB,QAIvC8I,EAAY9I,EAAoB,QAChC+I,EAAiC/I,EAAoBgJ,EAAEF,GAGvDG,EAAWjJ,EAAoB,QAG/BkJ,EAAUlJ,EAAoB,QAC9BS,EAA+BT,EAAoBgJ,EAAEE,GAGrDC,EAAcnJ,EAAoB,QAClCuC,EAAmCvC,EAAoBgJ,EAAEG,GAGzDC,EAAkBpJ,EAAoB,QACtCwD,EAA+BxD,EAAoBgJ,EAAEI,GAGrDC,EAAmBrJ,EAAoB,QACvCsC,EAAwCtC,EAAoBgJ,EAAEK,GAG9DC,EAAYtJ,EAAoB,QAChCiC,EAAiCjC,EAAoBgJ,EAAEM,GAGvDnI,EAAYnB,EAAoB,QCrE9BO,EAAQP,EAAQ,QAEhBI,GACJC,SACEkJ,OAAQ,mBACR1H,eAAgB,qBAId1B,EAAgBgB,EAAA,IAAY,gBUElCqI,GACEC,eAAgB,SAAApH,EAAAqH,GAAArH,EAAGsH,OAAHtH,EAAWuH,KAAX,OAAyCrI,GAAzCmI,EAAsBlI,OAAtBkI,EAA8BjI,OAO9CoI,WAAY,SAAAC,EAAAC,GAAA,GAAGJ,GAAHG,EAAGH,MAAHG,GAAWF,KAAX,OAET1F,GAFS6F,EAAsB5F,IAG7BtD,KAAK,SAACmJ,GAEL,GAAMC,GAAU,GAAIC,eACpBD,GAAQE,KAAK,MAAOH,EAAQjJ,KAAKA,KAAK0C,KAAK,GAC3CwG,EAAQG,KAAK,MACbH,EAAQI,mBAAqB,WACA,IAAvBJ,EAAQK,YAAuC,MAAnBL,EAAQM,QAET,IADhBN,EAAQO,kBAAkB,gBAC9B7D,QAAQ,SACfgD,EAAO,kBAAoBnI,OAAQiJ,KAAKC,MAAMT,EAAQU,cAAelJ,KAAMuI,EAAQjJ,KAAKA,WAMpG6J,gBAAiB,SAAAC,EAAAC,GAA2C,GAAxCnB,GAAwCkB,EAAxClB,OAAQoB,EAAgCF,EAAhCE,SAAqBC,GAAWH,EAAtBjB,MAAsBkB,EAAXE,KAE/C,OADArB,GAAO,mBAAqBqB,cACrBC,IAAeD,GACnBnK,KAAK,SAAAqK,GAAA,MAAOvB,GAAO,YAAcqB,OAAME,UACvCrK,KAAK,iBAAMkK,GAAS,0BAIzBI,oBAAqB,SAAAC,GAAA,OAA2BL,EAA3BK,EAAGL,UAAiC,eACvDG,IADmBE,EAAaC,QACnBC,aAGfC,YAAa,SAAAC,EAAAC,GAAgC,GAA7B9B,GAA6B6B,EAA7B7B,OAAQC,EAAqB4B,EAArB5B,MAAWsB,EAAUO,EAAVP,IAG3BQ,EAAMC,KAAKD,KAWjB,OAVAR,GAAMA,EAAIU,OAAO,SAACzH,GAChB,GAAMe,GAAO0E,EAAM7E,MAAMZ,EACzB,QAAKe,GAGDwG,EAAMxG,EAAK2G,cAAgB,OAK7BX,EAAIjF,YACCgF,IAAWC,GAAKrK,KAAK,SAAAkE,GAAA,MAAS4E,GAAO,aAAe5E,YAEtDtE,EAAAC,EAAQC,WAGjBmL,WAAY,SAAAC,EAAAC,GAAA,GAAGrC,GAAHoC,EAAGpC,OAAQC,EAAXmC,EAAWnC,MAAWzF,EAAtB6H,EAAsB7H,EAAtB,OAAgCyF,GAAMqC,MAAM9H,GAClD1D,EAAAC,EAAQC,QAAQiJ,EAAMqC,MAAM9H,SAC5B8G,IAAU9G,GAAItD,KAAK,SAAAqL,GAAA,MAAQvC,GAAO,YAAcxF,KAAI+H,aCvE5DC,GACEC,cAAe,SAACxC,EAADvH,GAAqB,GAAX2I,GAAW3I,EAAX2I,IACvBpB,GAAMyC,WAAarB,GAGrBsB,cAAe,SAAC1C,EAADF,GAA0B,GAAhBsB,GAAgBtB,EAAhBsB,KAAME,EAAUxB,EAAVwB,GAC7BtB,GAAM2C,MAAMvB,GAAQE,GAGtBsB,mBAAoB,SAAC5C,EAADE,GAAsBA,EAAZ/E,MACtBE,QAAQ,SAACC,GACTA,GACF0D,EAAA,EAAI6D,IAAI7C,EAAM7E,MAAOG,EAAKf,GAAIe,MAIpCwH,mBAAoB,SAAC9C,EAADG,GAAuB,GAAbvI,GAAauI,EAAbvI,MAC5BoI,GAAM+C,cAAgBnL,GAExBoL,eAAgB,SAAChD,EAADiB,GAA6B,GAAnBrJ,GAAmBqJ,EAAnBrJ,OAAQC,EAAWoJ,EAAXpJ,IAChCmI,GAAM+C,cAAgBnL,EACtBoI,EAAMiD,kBAAoBpL,GAE5BqL,eAAgB,SAAClD,EAADkB,GAAqB,GAAXE,GAAWF,EAAXE,IACxBpB,GAAMyC,WAAarB,GAErB+B,SAAU,SAACnD,EAADwB,GAAyB,GAAfjH,GAAeiH,EAAfjH,GAAI+H,EAAWd,EAAXc,IACtBtD,GAAA,EAAI6D,IAAI7C,EAAMqC,MAAO9H,EAAI+H,IAAQ,KC7BrCb,GAGEC,UAHa,SAGF1B,GAAO,GACRyC,GAAoCzC,EAApCyC,WAAYW,EAAwBpD,EAAxBoD,aAAcT,EAAU3C,EAAV2C,MAC5BU,EAAOC,OAAOtD,EAAMuD,MAAMC,OAAOH,OAAS,CAChD,IAAIZ,EAAY,CACd,GAAMgB,IAASJ,EAAO,GAAKD,EACrBM,EAAML,EAAOD,CACnB,OAAOT,GAAMF,GAAYkB,MAAMF,EAAOC,GAEtC,UAMJE,YAjBa,SAiBA5D,EAAOyB,GAClB,MAAOA,GAAQC,UAAU/D,IAAI,SAAApD,GAAA,MAAMyF,GAAM7E,MAAMZ,KAAKyH,OAAO,SAAA6B,GAAA,MAAKA,MCZpE7E,GAAA,EAAI8E,IAAIzE,EAAA,ECCR,IAAA0E,If0YEC,KexYF,OCTAC,EAAA,WAA0B,GAAAC,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBE,OAAOhK,GAAA,SAAY8J,EAAA,oBAC7HG,KACAC,GAAiBR,SAAAO,mBACjBE,EAAA,EdAAC,EAAAvO,EAAA,QAQAwO,EAAApK,EAKAqK,EAAAF,EACAZ,EACAW,GATA,EAWAE,EAPA,KAEA,MAUAE,EAAAD,EAAA,QF4ZIE,EAAiB3O,EAAoB,QiBtYzC4O,GjBybEhB,KiBvbF,ajBwbE7M,KAAM,WACJ,OACE8N,IiBvbN,OjBwbMjB,KiBvbN,GjBwbMkB,QiBvbN,GjBwbMC,MiBvbN,GjBwbMC,IiBtbN,MCzDAC,EAAA,WAA0B,GAAAnB,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBiB,YAAA,UAAoBjB,EAAA,MAAAH,EAAAqB,GAAArB,EAAAsB,GAAAtB,EAAAe,QAAAf,EAAAqB,GAAA,KAAAlB,EAAA,OAA2DiB,YAAA,kBAA4BjB,EAAA,OAAYiB,YAAA,WAAqBjB,EAAA,MAAAH,EAAAqB,GAAA,UAAArB,EAAAqB,GAAA,KAAAlB,EAAA,SAAoDoB,aAAazB,KAAA,QAAA0B,QAAA,UAAA3G,MAAAmF,EAAA,KAAAyB,WAAA,SAAkEpB,OAASnD,KAAA,QAAcwE,UAAW7G,MAAAmF,EAAA,MAAmB2B,IAAKC,MAAA,SAAAC,GAAyBA,EAAAtM,OAAAuM,YAAsC9B,EAAAF,KAAA+B,EAAAtM,OAAAsF,aAA+BmF,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,WAAqBjB,EAAA,MAAAH,EAAAqB,GAAA,UAAArB,EAAAqB,GAAA,KAAAlB,EAAA,SAAoDoB,aAAazB,KAAA,QAAA0B,QAAA,UAAA3G,MAAAmF,EAAA,QAAAyB,WAAA,YAAwEpB,OAASnD,KAAA,QAAcwE,UAAW7G,MAAAmF,EAAA,SAAsB2B,IAAKC,MAAA,SAAAC,GAAyBA,EAAAtM,OAAAuM,YAAsC9B,EAAAgB,QAAAa,EAAAtM,OAAAsF,aAAkCmF,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,WAAqBjB,EAAA,MAAAH,EAAAqB,GAAA,UAAArB,EAAAqB,GAAA,KAAAlB,EAAA,SAAoDoB,aAAazB,KAAA,QAAA0B,QAAA,UAAA3G,MAAAmF,EAAA,MAAAyB,WAAA,UAAoEpB,OAASnD,KAAA,QAAcwE,UAAW7G,MAAAmF,EAAA,OAAoB2B,IAAKC,MAAA,SAAAC,GAAyBA,EAAAtM,OAAAuM,YAAsC9B,EAAAiB,MAAAY,EAAAtM,OAAAsF,aAAgCmF,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,WAAqBjB,EAAA,MAAAH,EAAAqB,GAAA,UAAArB,EAAAqB,GAAA,KAAAlB,EAAA,SAAoDoB,aAAazB,KAAA,QAAA0B,QAAA,UAAA3G,MAAAmF,EAAA,IAAAyB,WAAA,QAAgEpB,OAASnD,KAAA,OAAawE,UAAW7G,MAAAmF,EAAA,KAAkB2B,IAAKC,MAAA,SAAAC,GAAyBA,EAAAtM,OAAAuM,YAAsC9B,EAAAkB,IAAAW,EAAAtM,OAAAsF,aAA8BmF,EAAAqB,GAAA,KAAArB,EAAA+B,GAAA,WAAA/B,EAAAqB,GAAA,KAAAlB,EAAA,OAA8DiB,YAAA,WAAqBjB,EAAA,OAAYiB,YAAA,SAAmBpB,EAAAqB,GAAA,WAAArB,EAAAsB,GAAAtB,EAAAF,MAAA,YAAAE,EAAAqB,GAAA,KAAAlB,EAAA,OAAuEiB,YAAA,YAAsBpB,EAAAqB,GAAA,WAAArB,EAAAsB,GAAAtB,EAAAgB,SAAA,YAAAhB,EAAAqB,GAAA,KAAAlB,EAAA,OAA0EiB,YAAA,UAAoBpB,EAAAqB,GAAA,WAAArB,EAAAsB,GAAAtB,EAAAiB,OAAA,YAAAjB,EAAAqB,GAAA,KAAAlB,EAAA,OAAwEiB,YAAA,QAAkBpB,EAAAqB,GAAA,WAAArB,EAAAsB,GAAAtB,EAAAkB,KAAA,iBACj4Dc,GAAA,WAAoC,GAAAhC,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBiB,YAAA,WAAqBjB,EAAA,MAAAH,EAAAqB,GAAA,YAAArB,EAAAqB,GAAA,KAAAlB,EAAA,UAAqDH,EAAAqB,GAAA,KAAAlB,EAAA,UAAyBH,EAAAqB,GAAA,KAAAlB,EAAA,UAAyBH,EAAAqB,GAAA,KAAAlB,EAAA,cAChP8B,GAAiBlC,OAAAoB,EAAAb,gBAAA0B,GACjBE,EAAA,EfAAC,GAAAjQ,EAAA,QAQAkQ,GAAA5L,EAKA6L,GAAAF,GACArB,EACAoB,GATA,EAWAE,GAPA,kBAEA,MAUAE,GAAAD,GAAA,QHwgBI1D,GAAMzM,EAAoB,QAC1B8G,GAA2B9G,EAAoBgJ,EAAEyD,IAGjD4D,GAAoBrQ,EAAoB,QACxC6G,GAAyC7G,EAAoBgJ,EAAEqH,IAG/DC,GAAStQ,EAAoB,QAC7B8F,GAA8B9F,EAAoBgJ,EAAEsH,IAGpDC,GAAOvQ,EAAoB,QAC3B4F,GAA4B5F,EAAoBgJ,EAAEuH,IK9iBhDlL,GAAOrF,EAAQ,QAEf0G,GAAqB,CcD3B8J,QAAAC,KAAAzQ,EAAA,OAMA,IAAA0Q,IAAA,GAAAD,MAAAE,SnBkwBEC,GmBhwBF,enBiwBEC,MmBhwBF,gBnBiwBEC,MmBhwBF,gBnBiwBEC,GmBhwBF,enBiwBEC,GmBhwBF,enBiwBEC,MmBhwBF,gBnBiwBEC,MmBhwBF,gBnBiwBEC,GmBhwBF,enBiwBEC,GmBhwBF,iBnBkwBEC,QmBhwBF,EnBiwBEC,QmBhwBF,kBAFAC,UAIA,IAAAd,MAAAE,SnBkwBEC,GmBhwBF,enBiwBEC,MmBhwBF,gBnBiwBEC,MmBhwBF,gBnBiwBEC,GmBhwBF,enBiwBEC,GmBhwBF,enBiwBEC,MmBhwBF,gBnBiwBEC,MmBhwBF,gBnBiwBEC,GmBhwBF,enBiwBEC,GmBhwBF,iBnBkwBEC,QmBhwBF,EnBiwBEC,QmBhwBF,kBAFAC,YAIA,GAAAd,MAAAe,YAAAD,UAWAf,QAAAiB,YAEAjB,OAAAkB,WACA,IAAAC,OACAC,GAAA,EACAC,InBkwBE9Q,KAAM,WACJ,OACE+Q,cACAC,mBmBhwBN,EnBiwBMC,WmBhwBN,EnBiwBMC,WmB/vBN,InBmwBEC,SACEC,KAAM,aACNC,YAAa,WmBjwBjB,GAAA1Q,GAAAC,InBowBMA,MAAKoQ,mBmBnwBX,CnBowBM,IAAIM,GAAQC,YAAY,WACtB5Q,EAAMqQ,oBmBnwBd,EnBowBwC,GAA5BrQ,EAAMqQ,oBACRQ,cmBnwBVF,IAEA,MnBswBIG,kBAAmB,SAA2BC,GAC5C/O,QAAQC,IAAI,OAAQ8O,EAAEpP,OmBpwB5Bc,InBqwBMuM,GAAMgC,cAAcD,EAAEpP,OmBpwB5Bc,InBqwBMxC,KAAKgR,KAAKhR,KAAKmQ,WAAYW,EAAEpP,OAAOc,GmBpwB1C,GnBqwBUxC,KAAKqQ,WACPP,SAAShM,MACPF,KAAQkN,EAAEpP,OmBpwBpBc,GnBqwBUuB,QAAWkN,YAAYlH,MAAQkG,IAAY,KAAMiB,QmBnwB3D,MnBuwBIC,gBAAiB,SAAyBL,GAExC/B,GAAMqC,eAAeN,EAAEpP,OmBpwB7Bc,InBswBMxC,KAAKgR,KAAKhR,KAAKmQ,WAAYW,EAAEpP,OAAOc,GmBpwB1C,InBswBI6O,aAAc,SAAsBP,GmBpwBxC,GAAAQ,GAAAtR,InBwwBM,IADAA,KAAKqQ,WAAarQ,KmBtwBxBqQ,UnBuwBUrQ,KAAKqQ,WAGP,GADAP,aACK9P,KAAKsQ,UmBtwBlB,CnBuwBUtQ,KAAKoQ,mBmBtwBf,CnBuwBU,IAAIM,GAAQC,YAAY,WACtBW,EAAOlB,oBmBtwBnB,EnBuwB6C,GAA7BkB,EAAOlB,qBACTQ,cmBtwBdF,GnBuwBcT,GAAWgB,YmBtwBzBlH,QAGA,UnBmxBQhI,SAAQC,ImBtwBhB,YnBuwBY8N,SAASxL,SACXyL,SAASA,SAASzL,QAAU,GAAIwK,MAAKyC,KAAK,SAAUxN,EAAMiD,GAExD+H,GAAMyC,qBAAqBxK,EAAMpD,KAAM,KmBvwBnDG,InBwwBa+L,UAAUpE,MmBvwBvB,KnB2wBI+F,aAAc,WACZ1P,QAAQC,ImBvwBd,GnBwwBMhC,KAAKsQ,WAAatQ,KmBvwBxBsQ,UnBwwBUtQ,KAAKsQ,WACPvO,QAAQC,ImBvwBhB,YnBwwBQiO,GAAWgB,YmBvwBnBlH,MnBwwBQ+E,KAAK4C,UAAUhG,MAAM,UAErBoD,KAAK4C,UAAUxP,KAAK,IAGxByP,WAAY,WAMV5B,SAAS6B,MAAMC,WAGjBC,cAAe,WAGb,GAFA/P,QAAQC,ImBvwBd+N,UnBwwBMC,MACID,SAASzL,OmBvwBnB,CnB6wBQ,IALAyL,SAASzM,QAAQ,SAAUC,GACzBA,EAAKwO,QAAQzO,QAAQ,SAAU0O,GAC7BhC,GAAWlM,KAAKkO,EmBvwB5BhL,WnB0wBe+I,SAASzL,QACdyL,SAAS6B,MAAMC,SAEjB9B,UAAS,GAAK,GAAIjB,MAAKyC,KAAK,SAAUxN,EAAMiD,GAE1C+H,GAAMyC,qBAAqBxK,EAAMpD,KAAM,KmBxwBjDG,InBywBWiM,IAAYtE,MmBvwBvB,GnBywBQsE,GAAWiC,KAAK,SAAUlT,EAAG4G,GAC3B,MAAO,GAAI5G,EAAEgF,KAAO4B,EmBzwB9B5B,OnB2wBQhC,QAAQC,ImB1wBhBgO,SnB2wBuL1G,ImB1wBvL0G,QnB4wBQkC,OmB1wBR,anB8wBEC,QAAS,WAGQ,iBAAiBxN,KAAKyN,UAAUC,UmBzwBnDC,iBnB0xBQ1P,EAAY,SAAWpD,EAAe,IAAE,gBAE1ClB,EAAYsE,EmB1wBlB,SAAA1D,KAAA,SAAAC,GnB2wBYA,EAAIC,KAAKC,SAAW,MAEtBG,EAAkB,OmBzwB5B,gBnB0wBUyD,SmBzwBVsP,QAEA,0QnBywBQL,MAAM,UAAY/S,EAAIC,KAAKA,KmBvwBnCoT,UnBwwBQzQ,QAAQC,IAAI,wBAAyB7C,EAAIC,KmBvwBjDA,QACAM,MAAA,SAAAC,GnBwwBQH,EAAkB,OmBtwB1B,gBnBuwBQyD,SmBtwBRsP,QAEA,2QnBwwBMtP,SmBrwBNsP,QAEA,2QnBswBEE,QAAS,aAGTC,QAAS,coB99BXC,GAAA,WAA0B,GAAAxG,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBE,OAAOhK,GAAA,SAAY8J,EAAA,OAAYsG,OAAA,OAAAzG,EAAAiE,mBAAA,wBAAAjE,EAAAiE,mBAAA,aAAiG9D,EAAA,KAAUiB,YAAA,SAAAf,OAA4BhK,GAAA,WAAc2J,EAAAqB,GAAArB,EAAAsB,GAAAtB,EAAAiE,yBAAAjE,EAAAqB,GAAA,KAAAlB,EAAA,OAAmEiB,YAAA,cAAwBjB,EAAA,OAAYiB,YAAA,OAAAO,IAAuB+E,WAAA,SAAA7E,GAA8BA,EAAA8E,kBAAyB9E,EAAA+E,iBAAwB5G,EAAA0E,kBAAA7C,IAA8BgF,SAAA,SAAAhF,GAA6B,eAAAA,KAAA7B,EAAA8G,GAAAjF,EAAAkF,QAAA,YAAA5J,GAAA0E,EAAAnL,KAA+E,WAAemL,GAAA8E,kBAAyB3G,EAAAgF,gBAAAnD,OAA8B1B,EAAA,OAAYsG,OAAA,YAAAzG,EAAAgE,WAAAlB,GAAA,kBAAAzC,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAgD,IAAA,kBAAA3G,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAiD,GAAA,kBAAA5G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAkD,IAAA,kBAAA7G,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAmD,GAAA,kBAAA9G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAoD,GAAA,kBAAA/G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAqD,IAAA,kBAAAhH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAsD,GAAA,kBAAAjH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAuD,IAAA,kBAAAlH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAf,GAAA,kBAAA5C,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAwD,IAAA,kBAAAnH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAyD,GAAA,kBAAApH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAd,GAAA,kBAAA7C,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA0D,IAAA,kBAAArH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA2D,GAAA,kBAAAtH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA4D,IAAA,kBAAAvH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA6D,GAAA,kBAAAxH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA8D,GAAA,kBAAAzH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA+D,IAAA,kBAAA1H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAgE,GAAA,kBAAA3H,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAiE,IAAA,kBAAA5H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAX,GAAA,kBAAAhD,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAkE,IAAA,kBAAA7H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAmE,GAAA,kBAAA9H,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAV,GAAA,kBAAAjD,OAAgEhK,GAAA,UAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAyBjB,EAAA,OAAYiB,YAAA,iBAAAqF,MAAAzG,EAAAkE,UAAA,YAAAvC,IAAiEyG,MAAApI,EAAAkF,gBAA0B/E,EAAA,OAAYiB,YAAA,iBAAyBpB,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAAqF,MAAAzG,EAAAmE,UAAA,YAAAxC,IAA+DyG,MAAApI,EAAAsF,gBAA0BnF,EAAA,OAAYsG,OAAA,SAAAzG,EAAAmE,UAAA,2BAAqDnE,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAAO,IAA+ByG,MAAApI,EAAAwF,cAAwBrF,EAAA,OAAYiB,YAAA,sBAA8BpB,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,iBAAAO,IAAiCyG,MAAApI,EAAA2F,iBAA2BxF,EAAA,OAAYiB,YAAA,+BAC1vHiH,MACAC,IAAiBvI,OAAAyG,GAAAlG,gBAAA+H,IACjBE,GAAA,GdAAC,GAAAtW,EAAA,QAQAuW,GAAAnO,EAKAoO,GAAAF,GACAzE,GACAwE,IATA,EAWAE,GAPA,kBAEA,MAUAE,GAAAD,GAAA,OexBAhG,QAAAC,KAAAzQ,EAAA,OAMA,IAgCA0W,KAhCA,GAAAjG,MAAAE,SrBmgCEC,GqBjgCF,erBkgCEC,MqBjgCF,gBrBkgCEC,MqBjgCF,gBrBkgCEC,GqBjgCF,erBkgCEC,GqBjgCF,erBkgCEC,MqBjgCF,gBrBkgCEC,MqBjgCF,gBrBkgCEC,GqBjgCF,erBkgCEC,GqBjgCF,iBrBmgCEC,QqBjgCF,ErBkgCEC,QqBjgCF,kBAFAC,WAIA,GAAAd,MAAAE,SrBmgCEC,GqBjgCF,erBkgCEC,MqBjgCF,gBrBkgCEC,MqBjgCF,gBrBkgCEC,GqBjgCF,erBkgCEC,GqBjgCF,erBkgCEC,MqBjgCF,gBrBkgCEC,MqBjgCF,gBrBkgCEC,GqBjgCF,erBkgCEC,GqBjgCF,iBrBmgCEC,QqBjgCF,ErBkgCEC,QqBjgCF,kBAFAC,YrBygCExQ,KAAM,WACJ,OACE4V,YACA5E,mBqBjgCN,ErBkgCMC,WqBjgCN,ErBkgCMC,WqBhgCN,IrBogCEC,SACEC,KAAM,cAER2B,QAAS,WAGQ,iBAAiBxN,KAAKyN,UAAUC,UqBjgCnDC,gBrBkhCI2C,GAAGC,qBACD9H,MqBlgCN,arBmgCM+H,KqBlgCN,gBrBmgCMC,OqBlgCN,GrBmgCMC,QAAS,WACPnD,MqBlgCR,SrBogCMoD,OAAQ,WACNpD,MqBlgCR,YrBsgCEO,QAAS,aAGTC,QAAS,esBzlCX6C,GAAA,WAA0B,GAAApJ,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBE,OAAOhK,GAAA,SAAY8J,EAAA,OAAYsG,OAAA,OAAAzG,EAAAiE,mBAAA,wBAAAjE,EAAAiE,mBAAA,aAAiG9D,EAAA,KAAUiB,YAAA,SAAAf,OAA4BhK,GAAA,WAAc2J,EAAAqB,GAAArB,EAAAsB,GAAAtB,EAAAiE,yBAAAjE,EAAAqB,GAAA,KAAAlB,EAAA,OAAmEiB,YAAA,cAAwBjB,EAAA,OAAYiB,YAAA,OAAAO,IAAuB+E,WAAA,SAAA7E,GAA8BA,EAAA8E,kBAAyB9E,EAAA+E,iBAAwB5G,EAAA0E,kBAAA7C,IAA8BgF,SAAA,SAAAhF,GAA6B,eAAAA,KAAA7B,EAAA8G,GAAAjF,EAAAkF,QAAA,YAAA5J,GAAA0E,EAAAnL,KAA+E,WAAemL,GAAA8E,kBAAyB3G,EAAAgF,gBAAAnD,OAA8B1B,EAAA,OAAYsG,OAAA,YAAAzG,EAAAgE,WAAAlB,GAAA,kBAAAzC,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAgD,IAAA,kBAAA3G,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAiD,GAAA,kBAAA5G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAkD,IAAA,kBAAA7G,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAmD,GAAA,kBAAA9G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAoD,GAAA,kBAAA/G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAqD,IAAA,kBAAAhH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAsD,GAAA,kBAAAjH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAuD,IAAA,kBAAAlH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAf,GAAA,kBAAA5C,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAwD,IAAA,kBAAAnH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAyD,GAAA,kBAAApH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAd,GAAA,kBAAA7C,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA0D,IAAA,kBAAArH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA2D,GAAA,kBAAAtH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA4D,IAAA,kBAAAvH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA6D,GAAA,kBAAAxH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA8D,GAAA,kBAAAzH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA+D,IAAA,kBAAA1H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAgE,GAAA,kBAAA3H,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAiE,IAAA,kBAAA5H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAX,GAAA,kBAAAhD,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAkE,IAAA,kBAAA7H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAmE,GAAA,kBAAA9H,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAV,GAAA,kBAAAjD,OAAgEhK,GAAA,UAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAyBjB,EAAA,OAAYiB,YAAA,iBAAAqF,MAAAzG,EAAAkE,UAAA,YAAAvC,IAAiEyG,MAAApI,EAAAkF,gBAA0B/E,EAAA,OAAYiB,YAAA,iBAAyBpB,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAAqF,MAAAzG,EAAAmE,UAAA,YAAAxC,IAA+DyG,MAAApI,EAAAsF,gBAA0BnF,EAAA,OAAYsG,OAAA,SAAAzG,EAAAmE,UAAA,2BAAqDnE,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAAO,IAA+ByG,MAAApI,EAAAwF,cAAwBrF,EAAA,OAAYiB,YAAA,sBAA8BpB,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,iBAAAO,IAAiCyG,MAAApI,EAAA2F,iBAA2BxF,EAAA,OAAYiB,YAAA,+BAC1vHiI,MACAC,IAAiBvJ,OAAAqJ,GAAA9I,gBAAA+I,IACjBE,GAAA,GfAAC,GAAAtX,EAAA,QAQAuX,GAAAlP,EAKAmP,GAAAF,GACAZ,GACAW,IATA,EAWAE,GAPA,kBAEA,MAUAE,GAAAD,GAAA,OgBxBAhH,QAAAC,KAAAzQ,EAAA,OAMA,IAAA0X,IAAA,GAAAjH,MAAAE,SvB8nCEC,GuB5nCF,evB6nCEC,MuB5nCF,gBvB6nCEC,MuB5nCF,gBvB6nCEC,GuB5nCF,evB6nCEC,GuB5nCF,evB6nCEC,MuB5nCF,gBvB6nCEC,MuB5nCF,gBvB6nCEC,GuB5nCF,evB6nCEC,GuB5nCF,iBvB8nCEC,QuB5nCF,EvB6nCEC,QuB5nCF,kBAFAC,UAIA,IAAAd,MAAAE,SvB8nCEC,GuB5nCF,evB6nCEC,MuB5nCF,gBvB6nCEC,MuB5nCF,gBvB6nCEC,GuB5nCF,evB6nCEC,GuB5nCF,evB6nCEC,MuB5nCF,gBvB6nCEC,MuB5nCF,gBvB6nCEC,GuB5nCF,evB6nCEC,GuB5nCF,iBvB8nCEC,QuB5nCF,EvB6nCEC,QuB5nCF,kBAFAC,YAIA,GAAAd,MAAAe,YAAAD,UAWAf,QAAAiB,YAEAjB,OAAAkB,WACA,IAAAiG,OACAC,GAAA,EACAC,IvB8nCE9W,KAAM,WACJ,OACE+Q,cACAC,mBuB5nCN,EvB6nCMC,WuB5nCN,EvB6nCMC,WuB3nCN,IvB+nCEC,SACEC,KAAM,aACNC,YAAa,WuB7nCjB,GAAA1Q,GAAAC,IvBgoCMA,MAAKoQ,mBuB/nCX,CvBgoCM,IAAIM,GAAQC,YAAY,WACtB5Q,EAAMqQ,oBuB/nCd,EvBgoCwC,GAA5BrQ,EAAMqQ,oBACRQ,cuB/nCVF,IAEA,MvBkoCIG,kBAAmB,SAA2BC,GAC5C/O,QAAQC,IAAI,OAAQ8O,EAAEpP,OuBhoC5Bc,IvBioCMuT,GAAehF,cAAcD,EAAEpP,OuBhoCrCc,IvBioCMxC,KAAKgR,KAAKhR,KAAKmQ,WAAYW,EAAEpP,OAAOc,GuBhoC1C,GvBioCUxC,KAAKqQ,WACPP,SAAShM,MACPF,KAAQkN,EAAEpP,OuBhoCpBc,GvBioCUuB,QAAWkN,YAAYlH,MAAQkM,IAAqB,KAAM/E,QuB/nCpE,MvBmoCIC,gBAAiB,SAAyBL,GAExCiF,GAAe3E,eAAeN,EAAEpP,OuBhoCtCc,IvBkoCMxC,KAAKgR,KAAKhR,KAAKmQ,WAAYW,EAAEpP,OAAOc,GuBhoC1C,IvBkoCI6O,aAAc,SAAsBP,GuBhoCxC,GAAAQ,GAAAtR,IvBooCM,IADAA,KAAKqQ,WAAarQ,KuBloCxBqQ,UvBmoCUrQ,KAAKqQ,WAGP,GADAP,aACK9P,KAAKsQ,UuBloClB,CvBmoCUtQ,KAAKoQ,mBuBloCf,CvBmoCU,IAAIM,GAAQC,YAAY,WACtBW,EAAOlB,oBuBloCnB,EvBmoC6C,GAA7BkB,EAAOlB,qBACTQ,cuBloCdF,GvBmoCcuF,GAAoBhF,YuBloClClH,QAGA,UvB+oCQhI,SAAQC,IuBloChB,YvBmoCY8N,SAASxL,SACXyL,SAASA,SAASzL,QAAU,GAAIwK,MAAKyC,KAAK,SAAUxN,EAAMiD,GAExD+O,GAAevE,qBAAqBxK,EAAMpD,KAAM,KuBnoC5DG,IvBooCa+L,UAAUpE,MuBnoCvB,KvBuoCI+F,aAAc,WACZ1P,QAAQC,IuBnoCd,GvBooCMhC,KAAKsQ,WAAatQ,KuBnoCxBsQ,UvBooCUtQ,KAAKsQ,WACPvO,QAAQC,IuBnoChB,YvBooCQiU,GAAoBhF,YuBnoC5BlH,MvBooCQ+E,KAAK4C,UAAUhG,MAAM,UAErBoD,KAAK4C,UAAUxP,KAAK,IAGxByP,WAAY,WAMV5B,SAAS6B,MAAMC,WAGjBC,cAAe,WAGb,GAFA/P,QAAQC,IuBnoCd+N,UvBooCMiG,MACIjG,SAASzL,OuBnoCnB,CvByoCQ,IALAyL,SAASzM,QAAQ,SAAUC,GACzBA,EAAKwO,QAAQzO,QAAQ,SAAU0O,GAC7BgE,GAAoBlS,KAAKkO,EuBnoCrChL,WvBsoCe+I,SAASzL,QACdyL,SAAS6B,MAAMC,SAEjB9B,UAAS,GAAK,GAAIjB,MAAKyC,KAAK,SAAUxN,EAAMiD,GAE1C+O,GAAevE,qBAAqBxK,EAAMpD,KAAM,KuBpoC1DG,IvBqoCWiS,IAAqBtK,MuBnoChC,GvBqoCQsK,GAAoB/D,KAAK,SAAUlT,EAAG4G,GACpC,MAAO,GAAI5G,EAAEgF,KAAO4B,EuBroC9B5B,OvBuoCQhC,QAAQC,IuBtoChBgU,SvBuoCuL1M,IuBtoCvL0M,QvBwoCQ9D,OuBtoCR,avB0oCEC,QAAS,WAGQ,iBAAiBxN,KAAKyN,UAAUC,UuBroCnDC,iBvBspCQ1P,EAAY,SAAWpD,EAAe,IAAE,gBAE1ClB,EAAYsE,EuBtoClB,SAAA1D,KAAA,SAAAC,GvBuoCYA,EAAIC,KAAKC,SAAW,MAEtBG,EAAkB,OuBroC5B,gBvBsoCUyD,SuBroCVsP,QAEA,0QvBqoCQL,MAAM,UAAY/S,EAAIC,KAAKA,KuBnoCnCoT,UvBooCQzQ,QAAQC,IAAI,wBAAyB7C,EAAIC,KuBnoCjDA,QACAM,MAAA,SAAAC,GvBooCQH,EAAkB,OuBloC1B,gBvBmoCQyD,SuBloCRsP,QAEA,2QvBooCMtP,SuBjoCNsP,QAEA,2QvBkoCEE,QAAS,aAGTC,QAAS,cwB11CXyD,GAAA,WAA0B,GAAAhK,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBE,OAAOhK,GAAA,SAAY8J,EAAA,OAAYsG,OAAA,OAAAzG,EAAAiE,mBAAA,wBAAAjE,EAAAiE,mBAAA,aAAiG9D,EAAA,KAAUiB,YAAA,SAAAf,OAA4BhK,GAAA,WAAc2J,EAAAqB,GAAArB,EAAAsB,GAAAtB,EAAAiE,yBAAAjE,EAAAqB,GAAA,KAAAlB,EAAA,OAAmEiB,YAAA,cAAwBjB,EAAA,OAAYiB,YAAA,OAAAO,IAAuB+E,WAAA,SAAA7E,GAA8BA,EAAA8E,kBAAyB9E,EAAA+E,iBAAwB5G,EAAA0E,kBAAA7C,IAA8BgF,SAAA,SAAAhF,GAA6B,eAAAA,KAAA7B,EAAA8G,GAAAjF,EAAAkF,QAAA,YAAA5J,GAAA0E,EAAAnL,KAA+E,WAAemL,GAAA8E,kBAAyB3G,EAAAgF,gBAAAnD,OAA8B1B,EAAA,OAAYsG,OAAA,YAAAzG,EAAAgE,WAAAlB,GAAA,kBAAAzC,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAgD,IAAA,kBAAA3G,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAiD,GAAA,kBAAA5G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAkD,IAAA,kBAAA7G,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAmD,GAAA,kBAAA9G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAoD,GAAA,kBAAA/G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAqD,IAAA,kBAAAhH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAsD,GAAA,kBAAAjH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAuD,IAAA,kBAAAlH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAf,GAAA,kBAAA5C,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAwD,IAAA,kBAAAnH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAyD,GAAA,kBAAApH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAd,GAAA,kBAAA7C,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA0D,IAAA,kBAAArH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA2D,GAAA,kBAAAtH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA4D,IAAA,kBAAAvH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA6D,GAAA,kBAAAxH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA8D,GAAA,kBAAAzH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA+D,IAAA,kBAAA1H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAgE,GAAA,kBAAA3H,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAiE,IAAA,kBAAA5H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAX,GAAA,kBAAAhD,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAkE,IAAA,kBAAA7H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAmE,GAAA,kBAAA9H,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAV,GAAA,kBAAAjD,OAAgEhK,GAAA,UAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAyBjB,EAAA,OAAYiB,YAAA,iBAAAqF,MAAAzG,EAAAkE,UAAA,YAAAvC,IAAiEyG,MAAApI,EAAAkF,gBAA0B/E,EAAA,OAAYiB,YAAA,iBAAyBpB,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAAqF,MAAAzG,EAAAmE,UAAA,YAAAxC,IAA+DyG,MAAApI,EAAAsF,gBAA0BnF,EAAA,OAAYsG,OAAA,SAAAzG,EAAAmE,UAAA,2BAAqDnE,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,eAAAO,IAA+ByG,MAAApI,EAAAwF,cAAwBrF,EAAA,OAAYiB,YAAA,sBAA8BpB,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,iBAAAO,IAAiCyG,MAAApI,EAAA2F,iBAA2BxF,EAAA,OAAYiB,YAAA,+BAC1vH6I,MACAC,IAAiBnK,OAAAiK,GAAA1J,gBAAA2J,IACjBE,GAAA,GhBAAC,GAAAlY,EAAA,QAQAmY,GAAA7P,EAKA8P,GAAAF,GACAL,GACAI,IATA,EAWAE,GAPA,kBAEA,MAUAE,GAAAD,GAAA,QRy2CIE,IAJStY,EAAoB,QAItBA,EAAoB,SAC3BuY,GAA4BvY,EAAoBgJ,EAAEsP,IAGlDE,GAAqBxY,EAAoB,OyBr4C7CwQ,QAAAC,KAAAzQ,EAAA,OAWA,IAAAyY,OAIAC,OAAA,GAEAC,GAAA,GAAAlI,MAAAE,SzBw4CEC,GyBt4CF,ezBu4CEC,MyBt4CF,gBzBu4CEC,MyBt4CF,gBzBu4CEC,GyBt4CF,ezBu4CEC,GyBt4CF,ezBu4CEC,MyBt4CF,gBzBu4CEC,MyBt4CF,gBzBu4CEC,GyBt4CF,ezBu4CEC,GyBt4CF,iBzBw4CEC,QyBt4CF,EzBu4CEC,QyBt4CF,kBAFAC,UAIA,IAAAd,MAAAE,SzBw4CEC,GyBt4CF,ezBu4CEC,MyBt4CF,gBzBu4CEC,MyBt4CF,gBzBu4CEC,GyBt4CF,ezBu4CEC,GyBt4CF,ezBu4CEC,MyBt4CF,gBzBu4CEC,MyBt4CF,gBzBu4CEC,GyBt4CF,ezBu4CEC,GyBt4CF,iBzBw4CEC,QyBt4CF,EzBu4CEC,QyBt4CF,kBAFAC,YAIA,GAAAd,MAAAe,YAAAD,WAEAqH,SAAAC,gBAAAC,wBAAAC,MACAhS,KAAAC,IAAA4R,SAAAC,gBAAAG,aAAAxI,OAAAyI,aAAA,EAEAzI,QAAAkB,WACA,IAAAwH,OAEAC,GAAA,EAEAC,IAAA,EACAC,OAAApO,GACAqO,GAAA,EACAC,GAAA,EAEAC,IzBw4CEC,YyBr4CFC,OAAAlB,GAAA,OACAmB,YAAAnB,GAAA,YAEAoB,UAAArB,GAAA7X,GzBu4CEK,KAAM,WACJ,OACE+Q,cACA+H,cACAC,eACAC,SyBt4CN,EzBu4CMC,uByBt4CN,EzBu4CMC,kByBt4CN,EzBu4CMC,sBAAuB,EACvBC,YyBt4CN,EzBu4CMC,eyBt4CN,EzBu4CMC,gBACE1R,MyBt4CR,EzBu4CQoQ,MyBt4CR,EzBu4CQuB,OyBt4CR,MzBu4CQC,QyBt4CR,IzBu4CQC,QyBt4CR,GzBu4CQC,UyBt4CR,OzBu4CQC,IyBt4CR,EzBu4CQ1T,IyBt4CR,IzBu4CQ2T,SyBt4CR,EzBu4CQC,UyBt4CR,EzBu4CQC,MyBt4CR,EzBu4CQC,QyBt4CR,SzBw4CQC,WyBt4CR,EzBu4CQC,SyBt4CR,EzBu4CQC,OACEC,QyBr4CV,gBzBu4CQ3G,MyBt4CR,czBu4CQ4G,UyBt4CR,WzBu4CQC,MyB96CR,GzB+6CQC,SACEC,gByBt4CV,mBzBu4CUC,UyBr4CV,6CzBu4CQC,cACEF,gByBt4CV,oBzBu4CUG,YyBt4CV,qBzBy4CQC,UAAW,SAAmB/S,GAC5B,MAAIA,IACMA,EAAQ,IAAIkK,QyBt4ChC,WAEA,YzB04CQ8I,cACEL,gByBp4CV,sBzB04CEM,OACE7B,QAAS,SAAiB8B,GyBx4C9B,GAAAna,GAAAC,IzB24CM+B,SAAQC,IAAI,iByB14ClBkY,GzB24CUA,EAEFxC,GAAiB/G,YAAY,WAE3B5Q,EAAMyY,ayB14ChB,EzB24CczY,EAAMyY,aAAe,MACvBzY,EyB14CZ0R,ezB24CY1R,EAAMyY,YyBz4ClB,IzB24CW2B,KAGHvJ,cyBx4CR8G,MzB44CE0C,UACErC,OAAQ,WACN,MAAO/X,MAAKqa,MAAMC,UyBx4CxBvC,QzB04CIwC,gBAAiB,WACf,MAAOva,MAAKwa,QAAUxa,KAAKsY,kByBx4CjC,GzB04CImC,oBAAqB,WACnB,MAAOza,MAAKwa,QAAUxa,KAAKuY,sByBx4CjC,IzB24CEhI,SACEC,KAAM,aACNiB,aAAc,WACZ1P,QAAQC,IyBx4Cd,GzBy4CMhC,KAAKoY,SAAWpY,KyBx4CtBoY,QzBy4CUpY,KAAKoY,SACHpY,KAAKwY,aAAe,MACtBxY,KAAKwY,YyBx4Cf,GzB24CQb,GAAa1G,YAAYlH,MyBx4CjC,IzBw4CyC/J,KAAKwY,YACtCzW,QAAQC,IyBx4ChB,QzBy4CQhC,KAAK0a,kByBx4Cb,GzBy4CQ3Y,QAAQC,IyBx4ChB,YzBy4CQwV,GAAkBvG,YyBx4C1BlH,MzBy4CQhI,QAAQC,IAAI,mByBx4CpB,IzBw4CyChC,KAAKwY,aACtC1J,KAAK4C,UAAUhG,MAAM,QAA4B,IAAnB1L,KAAKwY,YAAoB,OAEvDzW,QAAQC,IyBx4ChB,QzBy4CQ8M,KAAK4C,UAAUxP,KAAK,KAIxByY,gBAAiB,SAAyBC,GACxC,GAAIC,GyBx4CV,CzB04CM7D,IAAejG,cyBx4CrB6J,GzB04CM5a,KAAKgR,KAAKhR,KAAKmQ,WAAYyK,EyBx4CjC,GzBy4CW5a,KAAKoY,QAQRyC,EAAW5J,YAAYlH,MyBx4C/B4N,IzBi4CYF,KACFD,GAAkBvG,YyBx4C5BlH,MzBy4CU6N,GyBx4CV,IzBw4CyB5X,KAAKwY,YACpBf,IyBx4CV,GzB04CQoD,EAAW5J,YAAYlH,MAAQyN,GyBx4CvCI,IzB+4CUiD,EAAW,KACb7a,KAAKwY,YAAc,GAAKqC,EyBx4ChC,IzBy4CQ7a,KAAKkY,WAAWpU,MACdF,KyBx4CVgX,EzBy4CU7W,OAAU8W,EAAW,KAAM3J,QyBv4CrC,OzB04CQlR,KAAKwY,YAAc,IACnBzW,QAAQC,IyBx4ChB,wCzB24CI8Y,cAAe,SAAuBF,GACpC5D,GAAe5F,eyBx4CrBwJ,GzBy4CM5a,KAAKgR,KAAKhR,KAAKmQ,WAAYyK,EyBx4CjC,IzB04CIG,sBAAuB,SAA+BjK,GACpD/O,QAAQC,IyBx4Cd8O,GzB04CMgG,GAAchG,EAAEkK,eAAe,GAAGC,YAAcnK,EAAEpP,OAAOc,GACzDxC,KAAK2a,gBAAgB7J,EAAEpP,OyBx4C7Bc,KzB04CI0Y,oBAAqB,SAA6BpK,GAChD9Q,KAAK8a,cAAchK,EAAEpP,OyBx4C3Bc,IzBy4CMxC,KAAK8a,cAAchE,GAAchG,EAAEkK,eAAe,GAAGC,cAEvDP,kBAAmB,SAA2BS,GACxCnb,KAAKkY,WAAW5T,QAClBvC,QAAQC,IAAI,qBAAsBhC,KyBx4C1Cya,qBzBy4CYza,KAAKmY,YAAYnY,KAAKya,sBAAwBza,KAAKmY,YAAYnY,KAAKya,qBAAqBnW,SAE3FtE,KAAKkY,WAAalY,KAAKkY,WAAWjT,OAAOjF,KAAKmY,YAAYnY,KyBx4CpEya,uBzB04CY1K,SAAS/P,KAAKya,sBAChB1K,SAAS/P,KAAKya,qBAAqB5I,UAErC9B,SAAS/P,KAAKya,qBAAuB,GAAI3L,MAAKyC,KAAK,SAAUxN,EAAMiD,GAEjEgQ,GAAexF,qBAAqBxK,EAAMpD,KAAM,KyBz4C1DG,IzB04CW/D,KAAKkY,YAAYxM,MyBz4C5B,GzB04CQ1L,KAAKmY,YAAYnY,KAAKya,qBAAuBza,KyBz4CrDkY,WzB04CQlY,KAAKkY,eAELnW,QAAQC,IyBz4ChB,QzB24CMhC,KAAKuY,sBAAwBvY,KyBz4CnCsY,kBzB24CU6C,IACFnb,KAAKwY,YAAc,EACnBhB,GyBz4CR,GzB24CMC,IyBz4CN,GzB24CI2D,gBAAiB,SAAyBC,GACxCtZ,QAAQC,IAAI,kByBz4ClBqZ,GzB04CUrb,KAAKua,kBAAoBc,IAC3Brb,KAAKkY,eAEHlY,KAAKmY,YAAYkD,IAAarb,KAAKmY,YAAYkD,GAAU/W,QAC3DtE,KAAKgR,KAAKhR,KAAKmY,YAAakD,MAC5BtL,SAASsL,GAAUxJ,UACnB9B,SAASsL,OAAY/R,IAErBvH,QAAQC,IAAI,SyBz4CpBqZ,EAAA,oBzB44CIvJ,cAAe,WAMb,GALAI,MyBz4CN,gBzB04CMlS,KAAK0a,kByBz4CX,GzB04CM3Y,QAAQC,IyBz4CdhC,MzB04CM+B,QAAQC,IyBz4Cd+N,UzB04CMwH,MACIxH,SAASzL,OyBz4CnB,CzB+5CQ,IArBAyL,SAASzM,QAAQ,SAAUC,GACzBA,EAAKwO,QAAQzO,QAAQ,SAAU0O,GAC7BuF,GAAoBzT,KAAKkO,EyBz4CrChL,WzB44CQuQ,GAAoBtF,KAAK,SAAUlT,EAAG4G,GACpC,MAAO,GAAI5G,EAAEgF,KAAO4B,EyB14C9B5B,OzB64CQ/D,KAAKsb,OAAOlS,SAAS,kBACnBvJ,OyB34CV0X,GzB44CUzX,MACEsN,MyB34CZ,UzB44CYmO,QyB34CZ,UzB44CYC,MyB14CZ,aANAtc,KAAA,WzBm5CU6C,QAAQC,IyB34ClB,wBzB44CUkQ,MyB34CV,azB84CenC,SAASzL,QACdyL,SAAS6B,MAAMC,SAEjB9B,UAAS,GAAK,GAAIjB,MAAKyC,KAAK,SAAUxN,EAAMiD,GAC1CgQ,GAAexF,qBAAqBxK,EAAMpD,KAAM,KyB34C1DG,IzB44CWwT,IAAqB7L,MyB34ChC,GzB44CQvI,EyB34CRoU,QzB84CQrF,OyB34CR,YzB84CIuJ,mBAAoB,SAA4BC,GAC9C,MAAO1V,GyB34Cb0V,IzB64CIC,oBAAqB,SAA6BC,GAChD,MAAOtV,GyB34CbsV,IzB64CIC,eAAgB,SAAwB/K,GAClC9Q,KAAKoY,SACPrW,QAAQC,IyB34ChB,azB44CQhC,KAAKyR,gBAELgG,IAAW,GAGfqE,qBAAsB,SAA8BhL,GAClD/O,QAAQC,IAAI8O,EAAEiL,QAAQ,GyB34C5BC,UzB64CIC,oBAAqB,SAA6BnL,GAChD/O,QAAQC,IyB34Cd8O,IzB64CIoL,KAAM,SAAcpL,GAGlB/O,QAAQC,IAAI8O,EACZ,KAAK,GAAIqL,GAAI,EAAGA,GAAKrL,EAAEkK,eAAe1W,OAAS,EAAG6X,IyB34CxD,CzB44CQ,GAAIpd,GAAIkY,SAASmF,iBAAiBtL,EAAEkK,eAAemB,GAAGE,QAASvL,EAAEkK,eAAemB,GyB34CxFH,QzB44CYjd,GAAEud,UAAUC,SAAS,UAAYxd,EAAEud,UAAUC,SAAS,SACpDzF,GAAchG,EAAEkK,eAAemB,GAAGlB,aAAenE,GAAchG,EAAEkK,eAAemB,GAAGlB,aAAelc,EAAEyd,aAAa,OAEnHza,QAAQC,IyB54CpB8U,IzB64CY9W,KAAK2a,gBAAgB5b,EAAEyd,ayB54CnC,OzB64CYxc,KAAK8a,cAAchE,GAAchG,EAAEkK,eAAemB,GyB54C9DlB,azB64CYnE,GAAchG,EAAEkK,eAAemB,GAAGlB,YAAclc,EAAEyd,ayB54C9D,OzB64CsB1F,GAAchG,EAAEkK,eAAemB,GAAGlB,YAK5ClZ,QAAQC,IyB54CpB,IzBw4CYD,QAAQC,IyB54CpB,GzB64CYhC,KAAK2a,gBAAgB5b,EAAEyd,ayB54CnC,OzB64CY1F,GAAchG,EAAEkK,eAAemB,GAAGlB,YAAclc,EAAEyd,ayB54C9D,QzBk5CUza,QAAQC,IyB54ClB,MzB64Cc8U,GAAchG,EAAEkK,eAAemB,GAAGlB,aACpCjb,KAAK8a,cAAchE,GAAchG,EAAEkK,eAAemB,GyB54C9DlB,azB84CUnE,GAAchG,EAAEkK,eAAemB,GAAGlB,gByB54C5C3R,MzBg5CImT,SAAU,SAAkB3L,GyB54ChC,GAAAQ,GAAAtR,IzB+4CM+B,SAAQC,IyB94Cd8O,GzB+4CMiG,GAAoB2F,WAAW,WAE7BpL,EAAOmH,gByB94Cf,GAEA,MzB+4CIkE,OAAQ,SAAgB7L,GAEtB8L,ayB74CN7F,GzB84CM,IAAIhY,GAAIkY,SAASmF,iBAAiBtL,EAAEkK,eAAe,GAAGqB,QAASvL,EAAEkK,eAAe,GyB74CtFgB,QzB84CMja,SAAQC,IyB74CdjD,GzB84CUA,GAAKA,EAAEud,UAAUC,SAAS,aAE5Bvc,KyB74CR8R,gBzB84CiB/S,IAAMA,EAAEud,UAAUC,SAAS,YAAcxd,EAAEud,UAAUC,SAAS,cAEvEvc,KyB74CRyR,ezB+4CMzR,KAAKyY,gByB74CX,IzBi5CEtG,QAAS,WAGP,GAAI0K,GyB74CR7c,KzB+4CQ8c,EAAU7F,SyB74ClBC,ezB84CIrI,QAAOkO,IAAMD,EAAQ3F,wBAAwBC,MyB74CjD,GzB84CI0F,EAAQxD,MAAM0D,SAAWnO,OAAOkO,IyB74CpC,KzB84CI/c,KAAKwa,QyB74CT,EzB84CIxa,KAAKid,uBACHC,aAAcld,KyB74CpBwa,QzB+4CM2C,cyB74CN,EzB84CMrP,IAOEsP,cAAe,SAAuBtM,GACpC/O,QAAQC,IAAI,IAAKhC,KAAKqd,aACtBR,EAAKvE,kBAAoBtY,KyB74CnCqd,YzB84CUR,EAAKnC,mByB74CfjD,OzBi5CmB,iBAAiB9S,KAAKyN,UAAUC,UyB74CnDC,iBzB+4CQ1P,EAAY,SAAWpD,EAAe,IAAE,gBAE1ClB,EAAYsE,EyB74ClB,SAAA1D,KAAA,SAAAC,GzB84CYA,EAAIC,KAAKC,SAAW,MAEtBG,EAAkB,OyB54C5B,gBzB64CUyD,SyB54CVsP,QAGA,6RzB64CQL,MAAM,UAAY/S,EAAIC,KAAKA,KyB34CnCoT,UzB44CQzQ,QAAQC,IAAI,wBAAyB7C,EAAIC,KyB34CjDA,QACAM,MAAA,SAAAC,GzB44CQH,EAAkB,OyB14C1B,gBzB24CQyD,SyB14CRsP,QAEA,8RzB44CMtP,SyBz4CNsP,QAEA,8RzB04CEE,QAAS,aAOTC,QAAS,c0B5zDX4K,GAAA,WAA0B,GAAAnR,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBE,OAAOhK,GAAA,eAAkB8J,EAAA,OAAYiB,YAAA,OAAAO,IAAuByP,UAAApR,EAAA+P,KAAArJ,WAAA,SAAA7E,GAAmDA,EAAA8E,kBAAyB9E,EAAA+E,iBAAwB5G,EAAA4O,sBAAA/M,IAAkCgF,SAAA,SAAAhF,GAA6B,eAAAA,KAAA7B,EAAA8G,GAAAjF,EAAAkF,QAAA,YAAA5J,GAAA0E,EAAAnL,KAA+E,WAAemL,GAAA8E,kBAAyB3G,EAAA+O,oBAAAlN,OAAkC1B,EAAA,OAAYsG,OAAA,YAAAzG,EAAAgE,WAAAlB,GAAA,kBAAAzC,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAgD,IAAA,kBAAA3G,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAiD,GAAA,kBAAA5G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAkD,IAAA,kBAAA7G,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAmD,GAAA,kBAAA9G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAoD,GAAA,kBAAA/G,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAqD,IAAA,kBAAAhH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAsD,GAAA,kBAAAjH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAuD,IAAA,kBAAAlH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAf,GAAA,kBAAA5C,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAwD,IAAA,kBAAAnH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAyD,GAAA,kBAAApH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAd,GAAA,kBAAA7C,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA0D,IAAA,kBAAArH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA2D,GAAA,kBAAAtH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA4D,IAAA,kBAAAvH,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA6D,GAAA,kBAAAxH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAA8D,GAAA,kBAAAzH,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAA+D,IAAA,kBAAA1H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAgE,GAAA,kBAAA3H,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAiE,IAAA,kBAAA5H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAX,GAAA,kBAAAhD,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAkE,IAAA,kBAAA7H,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAmE,GAAA,kBAAA9H,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAV,GAAA,kBAAAjD,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAqN,IAAA,kBAAAhR,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAsN,GAAA,kBAAAjR,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,kBAAAzG,EAAAgE,WAAAuN,IAAA,kBAAAlR,OAAuEhK,GAAA,SAAY2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAwN,GAAA,kBAAAnR,OAAgEhK,GAAA,QAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAA,YAAAzG,EAAAgE,WAAAyN,GAAA,kBAAApR,OAAgEhK,GAAA,UAAW2J,EAAAqB,GAAA,KAAAlB,EAAA,OAA0BiB,YAAA,kBAAAO,IAAkCyP,UAAA,SAAAvP,GAA6BA,EAAA8E,kBAAyB9E,EAAA+E,qBAA2BzG,EAAA,UAAeuR,IAAA,YAAArR,OAAuBsR,QAAA3R,EAAA8Q,yBAAqC9Q,EAAA4R,GAAA5R,EAAA,iBAAA9E,GAAmC,MAAAiF,GAAA,gBAAAA,EAAA,OAAoCiB,YAAA,uBAAiCjB,EAAA,OAAYgN,OAAQX,OAAA,MAAAC,QAAAzM,EAAAuM,eAAAG,QAAA,YAA2DvM,EAAA,QAAAA,EAAA,UAA0BE,OAAOhK,GAAA,aAAgB8J,EAAA,kBAAuBE,OAAOwR,aAAA,IAAArc,OAAA,iBAA2CwK,EAAAqB,GAAA,KAAAlB,EAAA,WAAAA,EAAA,eAA8CE,OAAOyR,GAAA,iBAAoB9R,EAAAqB,GAAA,KAAAlB,EAAA,eAAgCE,OAAOyR,GAAA,oBAAsB,SAAA9R,EAAAqB,GAAA,KAAArB,EAAA4R,GAAA5R,EAAA,oBAAA5I,EAAAiB,GAAqE,MAAA2H,GAAAoO,kBAAApO,EAAAqO,QAAAnT,EAAAiF,EAAA,QAA0DE,OAAO0R,EAAA,EAAAC,EAAA,IAAA5a,EAAAQ,KAAA,OAAAqT,MAAAjL,EAAAwP,oBAAApY,EAAAK,MAAA+U,OAAA,IAAAyF,GAAA,IAAAC,GAAA,IAAAC,KAAAnS,EAAAsP,mBAAAlY,EAAAQ,MAAAkG,OAAA,mBAA8KkC,EAAAoS,OAAWpS,EAAAqB,GAAA,KAAArB,EAAA4R,GAAA5R,EAAAgM,YAAAhM,EAAAqO,QAAAnT,GAAA,SAAA9D,EAAAiB,GAA2E,MAAA8H,GAAA,QAAkBE,OAAO0R,EAAA,EAAAC,EAAA,IAAA5a,EAAAQ,KAAA,OAAAqT,MAAAjL,EAAAwP,oBAAApY,EAAAK,MAAA+U,OAAA,IAAAyF,GAAA,IAAAC,GAAA,IAAAC,KAAAnS,EAAAoO,kBAAApO,EAAAqO,QAAAnT,EAAA8E,EAAAsP,mBAAAlY,EAAAQ,MAAA,mBAAAkG,OAAAkC,EAAAoO,kBAAApO,EAAAqO,QAAAnT,EAAA,yBAAkR,GAAA8E,EAAAqB,GAAA,KAAAlB,EAAA,OAA4BiB,YAAA,OAAAO,IAAuByG,MAAA,SAAAvG,GAAyB7B,EAAAiP,gBAAAjP,EAAAqO,QAAAnT,aAA2C8E,EAAAqB,GAAA,KAAAlB,EAAA,gBAAAH,EAAAqB,GAAA,KAAAlB,EAAA,wBAAAH,EAAAqB,GAAA,KAAAlB,EAAA,OAA8FiB,YAAA,iBAA2BjB,EAAA,aAAAH,EAAAqS,IAA0B1Q,IAAI2Q,SAAAtS,EAAA0P,eAAA6C,WAAA,SAAA1Q,MAA4D2Q,OAAQ3X,MAAAmF,EAAA,YAAAsS,SAAA,SAAAG,GAAiDzS,EAAAqM,YAAAoG,GAAoBhR,WAAA,gBAA2B,aAAAzB,EAAAuM,gBAAA,IAAAvM,EAAAqB,GAAA,KAAAlB,EAAA,OAA+DiB,YAAA,eAAAO,IAA+B+E,WAAA,SAAA7E,GAA8BA,EAAA8E,kBAAyB9E,EAAA+E,iBAAwB5G,EAAAsQ,SAAAzO,IAAqBgF,SAAA,SAAAhF,GAA6B,eAAAA,KAAA7B,EAAA8G,GAAAjF,EAAAkF,QAAA,YAAA5J,GAAA0E,EAAAnL,KAA+E,WAAemL,GAAA8E,kBAAyB3G,EAAAwQ,OAAA3O,OAAqB1B,EAAA,OAAYsG,OAAAzG,EAAAiM,QAAA,+BAAAtK,IAAuDyG,MAAApI,EAAAsF,gBAA0BtF,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBsG,OAAAzG,EAAAsM,eAAA,kDAA0EnM,EAAA,OAAYiB,YAAA,0BAA+B,MAC3xLsR,MACAC,IAAiB5S,OAAAoR,GAAA7Q,gBAAAoS,IACjBE,GAAA,GjBAAC,GAAA3gB,EAAA,QAQA4gB,GAAArY,EAKAsY,GAAAF,GACAnH,GACAkH,IATA,EAWAE,GAPA,kBAEA,MAUAE,GAAAD,GAAA,OkBxBArQ,QAAAC,KAAAzQ,EAAA,OAIA,IAAA+gB,QAAA9V,GAEA+V,GAAA,GAAAvQ,MAAAE,S3Bi2DEC,G2B/1DF,e3Bg2DEC,M2B/1DF,gB3Bg2DEC,M2B/1DF,gB3Bg2DEC,G2B/1DF,e3Bg2DEC,G2B/1DF,e3Bg2DEC,M2B/1DF,gB3Bg2DEC,M2B/1DF,gB3Bg2DEC,G2B/1DF,e3Bg2DEC,G2B/1DF,iB3Bi2DEC,Q2B/1DF,E3Bg2DEC,Q2B/1DF,kBAFAC,WAIA0P,I3Bi2DExH,cACA1Y,KAAM,WACJ,OACEgZ,S2B51DN,I3Bg2DEgC,UACE/R,QAAS,WACP,MAAOrI,MAAKsb,OAAOrT,M2B91DzB+C,gB3Bi2DEuF,SACEC,KAAM,aACN+O,aAAc,WACZ,IACEH,G2B91DRvN,U3B+1DQ,MAAOf,IAGTsO,GAAY,GAAItQ,MAAKyC,KAAK,SAAUxN,EAAMiD,GACxCqY,GAAc7N,qBAAqBxK,EAAMpD,KAAM,K2B91DvDG,I3B+1DS/D,KAAKqI,SAASqD,M2B91DvB,I3Bg2DI8T,cAAe,W2B91DnB,GAAAzf,GAAAC,I3Bi2DM+B,SAAQC,IAAI,OAAQhC,KAAKsb,O2Bh2D/BrT,M3Bi2DM,IAAIzF,GAAKxC,KAAKsb,OAAOrT,MAAMuD,M2Bh2DjCiU,MAAAjd,E3Bm2DM,KAAKA,IAAOxC,KAAKqI,Q2B/1DvB,W3Bg2DQtG,SAAQC,I2Bj2DhB,U3Bo2DUQ,IAEFT,QAAQC,IAAI,M2Bl2DpBQ,G3Bm2DQxC,KAAKsb,OAAOlS,SAAS,cAAgB5G,GAAIA,IAAMtD,KAAK,WAClDa,E2Bl2DVwf,kB3Bo2DiBvf,KAAKqI,SAEdrI,K2Bn2DRuf,gB3Bs2DIG,WAAY,WACV1f,KAAKoY,SAAWpY,K2Bn2DtBoY,Q3Bo2DUpY,KAAKoY,QAEPtJ,KAAK4C,UAAUhG,MAAM,Q2Bn2D7B,G3Bq2DQoD,KAAK4C,UAAUxP,KAAK,KAI1BiQ,QAAS,WAGP,GAAI0K,G2Bn2DR7c,K3Bo2DQ2f,EAAW,iBAAiBhb,KAAKyN,UAAUC,U2Bn2DnDC,c3Bo2DIuK,G2Bn2DJ2C,gB3Bo2DSG,IACD/c,EAAY,SAAWpD,EAAe,IAAE,gBAE1ClB,EAAYsE,E2Bn2DlB,SAAA1D,KAAA,SAAAC,G3Bo2DYA,EAAIC,KAAKC,SAAW,MAEtBG,EAAkB,O2Bl2D5B,gB3Bm2DUyD,S2Bl2DVsP,QAEA,0Q3Bk2DQL,MAAM,UAAY/S,EAAIC,KAAKA,K2Bh2DnCoT,U3Bi2DQzQ,QAAQC,IAAI,wBAAyB7C,EAAIC,K2Bh2DjDA,QACAM,MAAA,SAAAC,G3Bi2DQH,EAAkB,O2B/1D1B,gB3Bg2DQyD,S2B/1DRsP,QAEA,2Q3Bi2DMtP,S2B91DNsP,QAEA,2Q3B+1DEE,QAAS,aAGTC,QAAS,c4B58DXkN,GAAA,WAA0B,GAAAzT,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBE,OAAOhK,GAAA,eAAkB8J,EAAA,OAAYiB,YAAA,OAAiBjB,EAAA,OAAYsG,OAAAzG,EAAAiM,QAAA,+BAAAtK,IAAuDyG,MAAApI,EAAAuT,gBAAwBvT,EAAAqB,GAAA,KAAArB,EAAA+B,GAAA,YAC3P2R,IAAA,WAAoC,GAAA1T,GAAAnM,KAAaoM,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAAwB,OAAAE,GAAA,OAAiBiB,YAAA,YAAsBjB,EAAA,OAAYiB,YAAA,UAAoBpB,EAAAqB,GAAA,KAAAlB,EAAA,OAAwBiB,YAAA,iBAClMuS,IAAiB5T,OAAA0T,GAAAnT,gBAAAoT,IACjBE,GAAA,GlBAAC,GAAA3hB,EAAA,QAQA4hB,GAAApZ,EAKAqZ,GAAAF,GACAV,GACAS,IATA,EAWAE,GAPA,kBAEA,MAUAE,GAAAD,GAAA,OmBhBAjZ,GAAA,EAAI8E,IAAIiB,EAAA,EAER,IAAAoT,IAAA,GAAmBpT,GAAA,GACjBqT,KAAM,UACNC,SAEIC,KAAM,IACNtU,KAAM,aACNuU,UAAW/R,KAGX8R,KAAM,mBACNtU,KAAM,UACNuU,UAAW1L,KAGXyL,KAAM,uBACNtU,KAAM,WACNuU,UAAWrB,KAGXoB,KAAM,oBACNtU,KAAM,WACNuU,UAAWL,KAGXI,KAAM,kBACNtU,KAAM,SACNuU,UAAW1K,KAGXyK,KAAM,oBACNtU,KAAM,WACNuU,UAAW9J,MCjCjBzP,GAAA,EAAI8E,IAAI3E,EAAArI,GAAYkN,KAAM,YAC1BhF,EAAA,EAAIwZ,OAAOC,eAAgB,CAC3B,IAAMC,IhBHC,WACL,MAAO,IAAIrZ,GAAA,EAAKsZ,OACd3Y,OACEyC,WAAY,KACZW,aAAc,GACdjI,SACAkH,SACAM,OACEiW,OACAC,OACA5H,QACA6H,OACAC,QAEF7I,eACAnN,kBAEFnD,UACA2C,YACAd,cgBfJ5C,QAAAI,EAAA,MAAKyZ,GAAOP,IAGZ,GAAInZ,GAAA,GACFga,GAAI,OACJb,UACAO,SACAO,SAAU,SACVpJ,YAAc9L,IAAAe,M9B6hEVoU,KACA,SAAUrjB,EAAQC,KAMlBqjB,OACA,SAAUtjB,EAAQC,KAMlBsjB,KACA,SAAUvjB,EAAQC,KAMlBujB,KACA,SAAUxjB,EAAQC,OAMrB","file":"static/js/app.7139261859a4dbbba8de.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ \"BoD0\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"CA19\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"GWyx\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"IEmI\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"NHnr\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// EXTERNAL MODULE: ./node_modules/vue/dist/vue.esm.js\nvar vue_esm = __webpack_require__(\"7+uW\");\n\n// EXTERNAL MODULE: ./node_modules/vuex-router-sync/index.js\nvar vuex_router_sync = __webpack_require__(\"9JMe\");\nvar vuex_router_sync_default = /*#__PURE__*/__webpack_require__.n(vuex_router_sync);\n\n// EXTERNAL MODULE: ./node_modules/vue-touch/dist/vue-touch.js\nvar vue_touch = __webpack_require__(\"I0MY\");\nvar vue_touch_default = /*#__PURE__*/__webpack_require__.n(vue_touch);\n\n// EXTERNAL MODULE: ./node_modules/vuex/dist/vuex.esm.js\nvar vuex_esm = __webpack_require__(\"NYxO\");\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/core-js/promise.js\nvar promise = __webpack_require__(\"//Fk\");\nvar promise_default = /*#__PURE__*/__webpack_require__.n(promise);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/regenerator/index.js\nvar regenerator = __webpack_require__(\"Xxa5\");\nvar regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/helpers/extends.js\nvar helpers_extends = __webpack_require__(\"Dd8w\");\nvar extends_default = /*#__PURE__*/__webpack_require__.n(helpers_extends);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/helpers/asyncToGenerator.js\nvar asyncToGenerator = __webpack_require__(\"exGp\");\nvar asyncToGenerator_default = /*#__PURE__*/__webpack_require__.n(asyncToGenerator);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/core-js/json/stringify.js\nvar stringify = __webpack_require__(\"mvHQ\");\nvar stringify_default = /*#__PURE__*/__webpack_require__.n(stringify);\n\n// EXTERNAL MODULE: ./node_modules/js-cookie/src/js.cookie.js\nvar js_cookie = __webpack_require__(\"lbHh\");\nvar js_cookie_default = /*#__PURE__*/__webpack_require__.n(js_cookie);\n\n// CONCATENATED MODULE: ./src/_common/js/api.js\n\n\n\n\n\n\n\nvar axios = __webpack_require__(\"mtWM\");\n\nvar reqConfig = {\n  headers: {\n    Accept: 'application/json',\n    'Content-Type': 'application/json'\n  }\n};\n// TODO:cause 500?????? just cuz this few lines???\nvar tokenInCookie = js_cookie[\"get\"]('serviceToken');\n\nfunction getUserInfo(wxcode) {\n  if (tokenInCookie) {\n    reqConfig.headers.Authorization = 'Bearer ' + tokenInCookie;\n    return axios.post('//api.musixise.com/api/user/getInfo', '', reqConfig);\n  } else if (!tokenInCookie && wxcode) {\n    return new promise_default.a(function (resolve, reject) {\n      axios.post('//api.musixise.com/api/user/oauth/wechat/callback?code=' + wxcode, '', reqConfig).then(function (res) {\n        if (res.data.errcode === 20001) {\n          reject(20001); // 相当于return了\n        }\n        var serviceToken = res.data.data.id_token;\n        reqConfig.headers.Authorization = 'Bearer ' + serviceToken;\n        js_cookie[\"set\"]('serviceToken', serviceToken, {\n          expires: 7\n        });\n        return axios.post('//api.musixise.com/api/user/getInfo', '', reqConfig);\n      }, function () {\n        reject();\n      }).then(function (res) {\n        resolve(res);\n      }).catch(function (err) {\n        reject(err);\n      });\n    });\n  }\n  // !tokenInCookie&&!wxcode的情况在app.js里处理, 不会走到这里\n  return false;\n}\n\nfunction uploadRecord(record, info) {\n  var _this = this;\n\n  return new promise_default.a(function (resolve, reject) {\n    var formReqConfig = { headers: { 'Content-Type': 'multipart/form-data', processData: false } };\n    var blob = new Blob([stringify_default()(record)]);\n    var reader = new FileReader();\n    reader.onload = function () {\n      var _ref = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee(event) {\n        var fd, postFix, workURL, param;\n        return regenerator_default.a.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                fd = new FormData();\n\n                fd.append('fname', 'test.txt');\n                fd.append('data', event.target.result);\n                _context.next = 5;\n                return axios.post('//api.musixise.com/api/uploadAudio', fd, formReqConfig);\n\n              case 5:\n                postFix = _context.sent;\n                workURL = 'http://oiqvdjk3s.bkt.clouddn.com/' + postFix;\n                param = extends_default()({}, info, {\n                  url: workURL\n                });\n\n                console.log(workURL);\n                return _context.abrupt('return', axios.post('//api.musixise.com/api/work/create', stringify_default()(param), reqConfig).then(function (res) {\n                  resolve(res);\n                }).catch(function (err) {\n                  reject(err);\n                }));\n\n              case 10:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, _this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    reader.readAsDataURL(blob);\n  });\n  // trigger the read from the reader...\n}\n\nfunction fetchMbox(id) {\n  return axios.post('//api.musixise.com/api/work/detail/' + id, '', reqConfig);\n}\n// CONCATENATED MODULE: ./src/store/actions.js\n\n\n/*\n  getUserInfo\n  getWorkInfo\n  getMusixiserInfo\n  saveWork\n*/\n/* harmony default export */ var actions = ({\n  BOUNCE_PROJECT: function BOUNCE_PROJECT(_ref, _ref2) {\n    var commit = _ref.commit,\n        state = _ref.state;\n    var record = _ref2.record,\n        info = _ref2.info;\n    return uploadRecord(record, info);\n  },\n  // 存作品到后台\n  // uploadRecord(record, info).then(() => {\n  //   // commit('SET_BOUNCE_PROJECT', { record, info });\n  //   // 可以在组建直接跳链接，不commit 存store一道\n  // });\n\n  FETCH_MBOX: function FETCH_MBOX(_ref3, _ref4) {\n    var commit = _ref3.commit,\n        state = _ref3.state;\n    var id = _ref4.id;\n    return (\n      // 获取某id的音乐盒音乐内容\n      fetchMbox(id).then(function (project) {\n        // console.log('xxi', project.data.data.url);\n        var request = new XMLHttpRequest();\n        request.open('GET', project.data.data.url, true);\n        request.send(null);\n        request.onreadystatechange = function () {\n          if (request.readyState === 4 && request.status === 200) {\n            var type = request.getResponseHeader('Content-Type');\n            if (type.indexOf('text') !== 1) {\n              commit('SET_ID_PROJECT', { record: JSON.parse(request.responseText), info: project.data.data });\n            }\n          }\n        };\n      })\n    );\n  },\n  // ensure data for rendering given list type\n  FETCH_LIST_DATA: function FETCH_LIST_DATA(_ref5, _ref6) {\n    var commit = _ref5.commit,\n        dispatch = _ref5.dispatch,\n        state = _ref5.state;\n    var type = _ref6.type;\n\n    commit('SET_ACTIVE_TYPE', { type: type });\n    return /* Cannot get final name for export \"fetchIdsByType\" in \"./src/_common/js/api.js\" (known exports: getUserInfo uploadRecord fetchMbox, known reexports: ) */ undefined(type).then(function (ids) {\n      return commit('SET_LIST', { type: type, ids: ids });\n    }).then(function () {\n      return dispatch('ENSURE_ACTIVE_ITEMS');\n    });\n  },\n\n  // ensure all active items are fetched\n  ENSURE_ACTIVE_ITEMS: function ENSURE_ACTIVE_ITEMS(_ref7) {\n    var dispatch = _ref7.dispatch,\n        getters = _ref7.getters;\n    return dispatch('FETCH_ITEMS', {\n      ids: getters.activeIds\n    });\n  },\n\n  FETCH_ITEMS: function FETCH_ITEMS(_ref8, _ref9) {\n    var commit = _ref8.commit,\n        state = _ref8.state;\n    var ids = _ref9.ids;\n\n    // on the client, the store itself serves as a cache.\n    // only fetch items that we do not already have, or has expired (3 minutes)\n    var now = Date.now();\n    ids = ids.filter(function (id) {\n      var item = state.items[id];\n      if (!item) {\n        return true;\n      }\n      if (now - item.__lastUpdated > 1000 * 60 * 3) {\n        return true;\n      }\n      return false;\n    });\n    if (ids.length) {\n      return /* Cannot get final name for export \"fetchItems\" in \"./src/_common/js/api.js\" (known exports: getUserInfo uploadRecord fetchMbox, known reexports: ) */ undefined(ids).then(function (items) {\n        return commit('SET_ITEMS', { items: items });\n      });\n    }\n    return promise_default.a.resolve();\n  },\n\n  FETCH_USER: function FETCH_USER(_ref10, _ref11) {\n    var commit = _ref10.commit,\n        state = _ref10.state;\n    var id = _ref11.id;\n    return state.users[id] ? promise_default.a.resolve(state.users[id]) : /* Cannot get final name for export \"fetchUser\" in \"./src/_common/js/api.js\" (known exports: getUserInfo uploadRecord fetchMbox, known reexports: ) */ undefined(id).then(function (user) {\n      return commit('SET_USER', { id: id, user: user });\n    });\n  }\n});\n// CONCATENATED MODULE: ./src/store/mutations.js\n\n\n/* harmony default export */ var mutations = ({\n  SET_USER_INFO: function SET_USER_INFO(state, _ref) {\n    var type = _ref.type;\n    // 个人信息\n    state.activeType = type;\n  },\n\n  SET_WORK_INFO: function SET_WORK_INFO(state, _ref2) {\n    var type = _ref2.type,\n        ids = _ref2.ids;\n    // 作品详情\n    state.lists[type] = ids;\n  },\n\n  SET_MUSIXISER_INFO: function SET_MUSIXISER_INFO(state, _ref3) {\n    var items = _ref3.items;\n    // 作者信息\n    items.forEach(function (item) {\n      if (item) {\n        vue_esm[\"a\" /* default */].set(state.items, item.id, item);\n      }\n    });\n  },\n  SET_BOUNCE_PROJECT: function SET_BOUNCE_PROJECT(state, _ref4) {\n    var record = _ref4.record;\n    // 储存录制信息\n    state.recordProject = record;\n  },\n  SET_ID_PROJECT: function SET_ID_PROJECT(state, _ref5) {\n    var record = _ref5.record,\n        info = _ref5.info;\n    // 储存录制信息\n    state.recordProject = record; // this is the music itself\n    state.recordProjectInfo = info; // this includes all the relative info\n  },\n  SET_FINAL_WORK: function SET_FINAL_WORK(state, _ref6) {\n    var type = _ref6.type;\n    // 储存成品信息\n    state.activeType = type;\n  },\n  SET_USER: function SET_USER(state, _ref7) {\n    var id = _ref7.id,\n        user = _ref7.user;\n\n    vue_esm[\"a\" /* default */].set(state.users, id, user || false); /* false means user not found */\n  }\n});\n// CONCATENATED MODULE: ./src/store/getters.js\n/* harmony default export */ var getters = ({\n  // ids of the items that should be currently displayed based on\n  // current list type and current pagination\n  activeIds: function activeIds(state) {\n    var activeType = state.activeType,\n        itemsPerPage = state.itemsPerPage,\n        lists = state.lists;\n\n    var page = Number(state.route.params.page) || 1;\n    if (activeType) {\n      var start = (page - 1) * itemsPerPage;\n      var end = page * itemsPerPage;\n      return lists[activeType].slice(start, end);\n    } else {\n      return [];\n    }\n  },\n\n\n  // items that should be currently displayed.\n  // this Array may not be fully fetched.\n  activeItems: function activeItems(state, getters) {\n    return getters.activeIds.map(function (id) {\n      return state.items[id];\n    }).filter(function (_) {\n      return _;\n    });\n  }\n});\n// CONCATENATED MODULE: ./src/store/index.js\n\n\n\n\n\n\nvue_esm[\"a\" /* default */].use(vuex_esm[\"a\" /* default */]);\n\nfunction createStore() {\n  return new vuex_esm[\"a\" /* default */].Store({\n    state: {\n      activeType: null,\n      itemsPerPage: 20,\n      items: {/* [id: number]: Item */},\n      users: {/* [id: string]: User */},\n      lists: {\n        top: [/* number */],\n        new: [],\n        show: [],\n        ask: [],\n        job: []\n      },\n      recordParts: [],\n      recordProject: []\n    },\n    actions: actions,\n    mutations: mutations,\n    getters: getters\n  });\n}\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/App.vue\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ var App = ({\n  name: 'app'\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-091aadf1\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ var selectortype_template_index_0_src_App = (esExports);\n// CONCATENATED MODULE: ./src/App.vue\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"ViPM\")\n}\nvar normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  App,\n  selectortype_template_index_0_src_App,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ var src_App = (Component.exports);\n\n// EXTERNAL MODULE: ./node_modules/vue-router/dist/vue-router.esm.js\nvar vue_router_esm = __webpack_require__(\"/ocq\");\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/components/HelloWorld.vue\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ var HelloWorld = ({\n  name: 'HelloWorld',\n  data: function data() {\n    return {\n      msg: '名片制作',\n      name: '',\n      company: '',\n      title: '',\n      tel: ''\n    };\n  }\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-52bc8902\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/HelloWorld.vue\nvar HelloWorld_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"hello\"},[_c('h1',[_vm._v(_vm._s(_vm.msg))]),_vm._v(\" \"),_c('div',{staticClass:\"input-section\"},[_c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"姓名: \")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.name),expression:\"name\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.name=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"公司: \")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.company),expression:\"company\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.company)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.company=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"职位: \")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.title),expression:\"title\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.title)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.title=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"电话: \")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.tel),expression:\"tel\"}],attrs:{\"type\":\"num\"},domProps:{\"value\":(_vm.tel)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.tel=$event.target.value}}})]),_vm._v(\" \"),_vm._m(0,false,false)]),_vm._v(\" \"),_c('div',{staticClass:\"b-card\"},[_c('div',{staticClass:\"name\"},[_vm._v(\"\\n      \"+_vm._s(_vm.name)+\"\\n    \")]),_vm._v(\" \"),_c('div',{staticClass:\"company\"},[_vm._v(\"\\n      \"+_vm._s(_vm.company)+\"\\n    \")]),_vm._v(\" \"),_c('div',{staticClass:\"title\"},[_vm._v(\"\\n      \"+_vm._s(_vm.title)+\"\\n    \")]),_vm._v(\" \"),_c('div',{staticClass:\"tel\"},[_vm._v(\"\\n      \"+_vm._s(_vm.tel)+\"\\n    \")])])])}\nvar HelloWorld_staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"背景颜色: \")]),_vm._v(\" \"),_c('div',{}),_vm._v(\" \"),_c('div',{}),_vm._v(\" \"),_c('div',{}),_vm._v(\" \"),_c('div',{})])}]\nvar HelloWorld_esExports = { render: HelloWorld_render, staticRenderFns: HelloWorld_staticRenderFns }\n/* harmony default export */ var components_HelloWorld = (HelloWorld_esExports);\n// CONCATENATED MODULE: ./src/components/HelloWorld.vue\nfunction HelloWorld_injectStyle (ssrContext) {\n  __webpack_require__(\"e1+N\")\n}\nvar HelloWorld_normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* template functional */\nvar HelloWorld___vue_template_functional__ = false\n/* styles */\nvar HelloWorld___vue_styles__ = HelloWorld_injectStyle\n/* scopeId */\nvar HelloWorld___vue_scopeId__ = \"data-v-52bc8902\"\n/* moduleIdentifier (server only) */\nvar HelloWorld___vue_module_identifier__ = null\nvar HelloWorld_Component = HelloWorld_normalizeComponent(\n  HelloWorld,\n  components_HelloWorld,\n  HelloWorld___vue_template_functional__,\n  HelloWorld___vue_styles__,\n  HelloWorld___vue_scopeId__,\n  HelloWorld___vue_module_identifier__\n)\n\n/* harmony default export */ var src_components_HelloWorld = (HelloWorld_Component.exports);\n\n// CONCATENATED MODULE: ./src/_common/js/util.js\nfunction getUrlParam(key) {\n  var reg = new RegExp(\"[?|&]\" + key + \"=([^&]+)\");\n  var match = location.search.match(reg);\n  return match && match[1];\n}\n\nfunction getUrlParam1(key) {\n  var reg = new RegExp(\"[?|&]\" + key + \"=([^&]+)\");\n  var match = location.search.match(reg);\n  return match && match[1];\n}\n// EXTERNAL MODULE: ./node_modules/babel-runtime/core-js/set.js\nvar set = __webpack_require__(\"lHA8\");\nvar set_default = /*#__PURE__*/__webpack_require__.n(set);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/helpers/toConsumableArray.js\nvar toConsumableArray = __webpack_require__(\"Gu7T\");\nvar toConsumableArray_default = /*#__PURE__*/__webpack_require__.n(toConsumableArray);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/core-js/object/values.js\nvar values = __webpack_require__(\"gRE1\");\nvar values_default = /*#__PURE__*/__webpack_require__.n(values);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/core-js/object/keys.js\nvar keys = __webpack_require__(\"fZjL\");\nvar keys_default = /*#__PURE__*/__webpack_require__.n(keys);\n\n// CONCATENATED MODULE: ./src/_common/js/magic.js\n\n\n\n\n\nvar magic_Tone = __webpack_require__(\"ZnLv\");\n\nvar SAME_NOTE_INTERVAL = 1; // 同一个音不能相距小于1秒，不然音片打击出问题\nvar notesObj = {};\nvar notesArray = [];\nvar FreqsResult = [];\n\n// notesInfo example\n// let work = [{note: \"E4\", time: 0.14585000000000037},\n// {note: \"G4\", time: 1.0295},\n// {note: \"G4\", time: 1.3985},\n// {note: \"E4\", time: 2.6605300000000005},\n// {note: \"D4\", time: 3.4207450000000006},\n// {note: \"C4\", time: 4.196245000000001},\n// {note: \"G4\", time: 2.671395000000004},\n// {note: \"A4\", time: 3.35932},\n// {note: \"B4\", time: 4.183044999999998}]\n\nfunction RealMagic(items) {\n  console.log('== Enter RealMagic ==');\n  console.log(stringify_default()(items));\n  var tasksObj = {};\n  items.forEach(function (item) {\n    //* 2 cuz print mbox need 1 octave higher.\n    var itemNoteFreq = parseInt(magic_Tone.Frequency(item.note).toFrequency() * 2, 10);\n    if (!tasksObj[itemNoteFreq]) {\n      tasksObj[itemNoteFreq] = [];\n    }\n    tasksObj[itemNoteFreq].push(item.time);\n  });\n  // tasksObj is like {784:[1.0295,1.39,2.6713],659:[2.66],...}\n\n  // then we focus on each task\n  var taskTypes = keys_default()(tasksObj); // [659,784,...]  freq array, 排好序的（object.keys）\n  var taskTimeArrays = values_default()(tasksObj); // [[2.66]，[1.0295,1.39,2.6713]] 顺序跟上面对应的\n  var machines = []; // init with existing types, will add more machines\n  var groups = []; // will final be [[1],[1,2,1],...], corespond to taskTimeArrays\n\n  if (taskTypes.length > 18) {\n    console.log('音种类超过18个，这个做不了');\n    return false;\n  }\n\n  taskTimeArrays.forEach(function (timeArray, index) {\n    var final = [];\n    timeArray.forEach(function (time, j) {\n      var test = []; // 校验当前final里不能用的序号， final里序号种类和test种类相同则证明不行\n      var allPreviousOccupied = false;\n      var successFound = false;\n      if (j === 0) {\n        final.push(1); // 给第1组的第一个任务分配第一个机器\n      } else {\n        var counter = j;\n        while (counter >= 1 && !allPreviousOccupied) {\n          // TODO: -1 or 0\n          counter -= 1;\n          if (time - timeArray[counter] >= SAME_NOTE_INTERVAL && test.indexOf(final[counter]) === -1) {\n            final.push(final[counter]);\n            successFound = true;\n            break;\n          } else if (test.indexOf(final[counter]) === -1) {\n            test.push(final[counter]);\n            if ([].concat(toConsumableArray_default()(new set_default.a(final))).length === [].concat(toConsumableArray_default()(new set_default.a(test))).length) {\n              // final目前已有的都不满足，set可以取unique elements [1,1,2,2,3,1] => [1,2,3]\n              allPreviousOccupied = true;\n              break;\n            }\n          }\n        }\n        if (counter === 0 && !successFound || allPreviousOccupied) {\n          final.push(Math.max.apply(Math, final) + 1);\n        }\n      }\n    });\n    groups.push(final);\n  });\n  console.log(taskTypes);\n  console.log(taskTimeArrays);\n  console.log('hehe', groups); // [[1],[1,2,1],...], corespond to taskTimeArrays\n\n  // now we have groups, let's build machines based on this\n  groups.forEach(function (group, index) {\n    var count = 0;\n    while (count <= Math.max.apply(Math, toConsumableArray_default()(group)) - 1) {\n      machines.push(taskTypes[index]);\n      count += 1;\n    }\n  });\n  if (machines.length < 18) {\n    var lastMachine = machines[machines.length - 1];\n    while (machines.length < 18) {\n      machines.push(lastMachine); // make it length of 18\n    }\n    // machines is like [\"1046\", \"1174\", \"1318\", \"1318\", \"1318\", \"1396\", \"1567\"] of 18 length\n  } else if (machines.length > 18) {\n    console.log('所需音片儿超过18个');\n    return false;\n  }\n  console.log(machines);\n  // then we merge all the tasks\n\n  // test1: [[1],[1,2,1]] => [1,2,3,2]\n  // test2: [[1,2,1],[1,2,3]] => [1,2,1,3,4,5]\n  var finalBins = groups.reduce(function (a, b) {\n    return a.concat(b.map(function (item) {\n      return item + Math.max.apply(Math, toConsumableArray_default()(a));\n    }));\n  });\n  var finalTimings = taskTimeArrays.reduce(function (a, b) {\n    return a.concat(b);\n  }); // just flatten it\n  finalTimings = finalTimings.map(function (item) {\n    return item * 15 / 20;\n  }); // normalize from 20s to 15s\n  var musicboxPins = finalBins.map(function (bin, index) {\n    return 'generatePin(' + finalTimings[index] + ',' + bin + ')';\n  });\n  console.log('\\n    //\\u5E95\\u4E0B\\u4F4E\\u97F3,\\u4E0A\\u9762\\u9AD8\\u97F3\\n  const DOT_WIDTH = 0.6\\n  const RATIO = 0.98\\n  const OFFSET = 2.2 //1.95 is center\\n  const OUTER_RADIUS = 6.6\\n  const INNER_RADIUS = 5.9\\n  function generatePin(noteSec, noteNo) {\\n    return rotate(90, [1, 0, 4 * noteSec * RATIO / 15], cylinder({\\n      h: 1,\\n      r: DOT_WIDTH / 2,\\n      center: true\\n    })).translate([sin(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -cos(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -9.95 + OFFSET + 0.4 + (noteNo - 1) * .9])\\n  }\\n\\n  function main() {\\n    let cylinderBody = difference(cylinder({h: 19.9,r: OUTER_RADIUS,center: true}),cylinder({h: 19.9,r: INNER_RADIUS,center: true}))\\n    let holes = union(' + musicboxPins + ')\\n    return union(cylinderBody,holes).translate([0, 0, 0]).scale(1);\\n  }');\n}\n\n// export function generateFreqs(notesInfo) {\n//   notesObj = {};\n//   notesArray = [];\n//   FreqsResult = [];\n//   console.log(notesInfo);\n//   notesInfo.forEach((item) => {\n//     // console.log(item.note)\n//     // console.log(notesObj)\n//     if (!(item.note in notesObj)) {\n//       console.log('!!');\n//       notesObj[item.note] = 1;\n//       notesArray.push({\n//         note: item.note,\n//         freq: Tone.Frequency(item.note).toFrequency(),\n//       });\n//     }\n//   });\n//   notesArray.sort((a, b) => (a.freq - b.freq));\n//   console.log(`本首作品共有${notesArray.length}种音符`);\n//   notesArray.forEach((item, index) => {\n//     FreqsResult.push(item.freq * 2);\n//     notesObj[item.note] = index + 1; // 这个note占18音的第几个\n//   });\n//   console.log('它们的频率是', FreqsResult);\n//   return FreqsResult;\n// }\n\n// export function generateJSCadCode(notesInfo) {\n//   let musicboxPins = [];\n//   // norm timing to 15 second\n//   const lastNoteTime = notesInfo[notesInfo.length - 1].time;\n//   if (lastNoteTime > 15) {\n//     notesInfo.forEach((item) => {\n//       item.time = (item.time * 15) / lastNoteTime;\n//     });\n//   }\n//   // get note types\n//   const freqs = generateFreqs(notesInfo);\n//   if (freqs.length > 18) { return false; }\n//   musicboxPins = notesInfo.map(item => `generatePin(${item.time},${notesObj[item.note]})`);\n//   console.log(`\n//   const DOT_WIDTH = 0.6\n//   const RATIO = 0.98\n//   const OFFSET = 2.2 //1.95 is center\n//   const OUTER_RADIUS = 6.6\n//   const INNER_RADIUS = 5.9\n//   function generatePin(noteSec, noteNo) {\n//     return rotate(90, [1, 0, 4 * noteSec * RATIO / 15], cylinder({\n//       h: 1,\n//       r: DOT_WIDTH / 2,\n//       center: true\n//     })).translate([sin(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -cos(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -9.95 + OFFSET + 0.4 + (noteNo - 1) * .9])\n//   }\n//   function main() {\n//     let cylinderBody = difference(cylinder({h: 19.9,r: OUTER_RADIUS,center: true}),cylinder({h: 19.9,r: INNER_RADIUS,center: true}))\n//     let holes = union(${musicboxPins})\n//     return union(cylinderBody,holes).translate([0, 0, 0]).scale(1);\n//   }`);\n// }\n\nfunction magic_mapNoteTimeToColor(time) {\n  // let rgb = [0, 0, 0];\n  var COLOR1 = [151, 255, 241];\n  var COLOR2 = [98, 166, 223];\n  var COLOR3 = [154, 124, 255];\n  var TIME_MAX = 20;\n  var rgb = [0, 0, 0];\n  if (time < 0 || time > TIME_MAX) {\n    // console.warn('we don\\'t allow time above 20. from \\'mapNoteTimeToColor\\' util function');\n  } else if (time <= 10) {\n    rgb = [COLOR1[0] + time * (COLOR2[0] - COLOR1[0]) / (TIME_MAX / 2), COLOR1[1] + time * (COLOR2[1] - COLOR1[1]) / (TIME_MAX / 2), COLOR1[2] + time * (COLOR2[2] - COLOR1[2]) / (TIME_MAX / 2)];\n  }\n  rgb = [COLOR2[0] + time * (COLOR3[0] - COLOR2[0]) / (TIME_MAX / 2), COLOR2[1] + time * (COLOR3[1] - COLOR2[1]) / (TIME_MAX / 2), COLOR2[2] + time * (COLOR3[2] - COLOR2[2]) / (TIME_MAX / 2)];\n  // console.log(`rgb(${Math.floor(rgb[0])},${Math.floor(rgb[1])},${Math.floor(rgb[2])})`);\n  return 'rgb(' + Math.floor(rgb[0]) + ',' + Math.floor(rgb[1]) + ',' + Math.floor(rgb[2]) + ')';\n}\nfunction magic_mapNoteMidiToLength(noteName) {\n  // in our context, the midi range would be from 60 - 84\n  // return `${(75 * 0.8 * ((Tone.Frequency(noteName).toMidi() - 60) / (84 - 40))) + 0.2}`; // 75 is rem to px\n  // 50 - 110\n  return '' + (75 * 0.8 * ((magic_Tone.Frequency(noteName).toMidi() - 50) / (110 - 40)) + 0.2); // 75 is rem to px\n}\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/components/MBMaker.vue\n\nwindow.Tone = __webpack_require__(\"ZnLv\");\n\n\n\n\n\nvar piano = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\nvar mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\nvar plucky = new Tone.PluckSynth().toMaster();\n// var part = new Tone.Part(function(time, value){\n// \t//the value is an object which contains both the note and the velocity\n// piano.triggerAttackRelease(value.note, \"8n\", time)\n// }, [{\"time\" : 1.9, \"note\" : \"C3\"},\n// \t   {\"time\" : 2, \"note\" : \"C4\"},\n//      {\"time\" : 3, \"note\" : \"C3\"},\n//      \t   {\"time\" : 4, \"note\" : \"C4\"}\n// ]).start(0)\n// Tone.Transport.start()\n\nwindow.recorder = []; //Tone.Part => schedule notes\n\nwindow.tonepart = []; // store all the music parts. (ummm,that's why it's named part...)\nvar bouncepart = [];\nvar timeline = 0;\n/* harmony default export */ var MBMaker = ({\n  data: function data() {\n    return {\n      activeNote: {},\n      timerToStartRecord: 0,\n      recording: false,\n      replaying: false\n    };\n  },\n\n  methods: {\n    load: function load() {},\n    startRecord: function startRecord() {\n      var _this = this;\n\n      this.timerToStartRecord = 3;\n      var timer = setInterval(function () {\n        _this.timerToStartRecord -= 1;\n        if (_this.timerToStartRecord == 0) {\n          clearInterval(timer);\n        }\n      }, 1000);\n    },\n\n    touchStartHandler: function touchStartHandler(e) {\n      console.log('down', e.target.id);\n      piano.triggerAttack(e.target.id);\n      this.$set(this.activeNote, e.target.id, 1);\n      if (this.recording) {\n        recorder.push({\n          'note': e.target.id,\n          'time': +((performance.now() - timeline) / 1000).toFixed(4)\n        });\n      }\n    },\n    touchEndHandler: function touchEndHandler(e) {\n      // console.log('up',e.target.id)\n      piano.triggerRelease(e.target.id);\n      // plucky.triggerRelease(e.target.id)\n      this.$set(this.activeNote, e.target.id, 0);\n    },\n    toggleRecord: function toggleRecord(e) {\n      var _this2 = this;\n\n      this.recording = !this.recording;\n      if (this.recording) {\n        //start recording\n        recorder = [];\n        if (!this.replaying) {\n          this.timerToStartRecord = 3;\n          var timer = setInterval(function () {\n            _this2.timerToStartRecord -= 1;\n            if (_this2.timerToStartRecord == 0) {\n              clearInterval(timer);\n              timeline = performance.now();\n            }\n          }, 1000);\n\n          // timeline = performance.now()\n          // 1. e.timestamp behave not consistent\n          // 2. if currently playing, follow that timeline\n        }\n\n        try {\n          // tonepart.dispose()//此处必须dispose，否则会一直往part里面加\n        } catch (e) {\n          console.warn('tone cannot be disposed');\n        }\n      } else {\n        //stop recording\n        console.log('kikikiki');\n        if (recorder.length) {\n          tonepart[tonepart.length] = new Tone.Part(function (time, value) {\n            //不能老这new啊，要每次一个数组，每次改动最后一个\n            piano.triggerAttackRelease(value.note, \"8n\", time);\n          }, recorder).start(0);\n        }\n      }\n    },\n    toggleReplay: function toggleReplay() {\n      console.log(1);\n      this.replaying = !this.replaying;\n      if (this.replaying) {\n        console.log('kokokoko');\n        timeline = performance.now();\n        Tone.Transport.start(\"+0.01\"); // in case < context.currentTime\n      } else {\n        Tone.Transport.stop(0); // TODO：必须stop才能start。。。有没有自动stop啊..\n      }\n    },\n    undoRecord: function undoRecord() {\n      //TODO:可以改造为选择哪个进行删除\n      // tonepart[tonepart.length-1].dispose() //dispose是一个part被dispose\n      //TODO:若tonepart里只有一个，应让用户确认是否继续操作\n      // TODO: 如果tonepart里没东西，undo按钮应该grayout\n\n      tonepart.pop().dispose(); //最后一个被dispose，同时要从数组中删掉\n      // Tone.Transport.clear(tonepart);\n    },\n    bounceProject: function bounceProject() {\n      console.log(tonepart);\n      bouncepart = [];\n      if (tonepart.length) {\n        tonepart.forEach(function (item) {\n          item._events.forEach(function (noteInfo) {\n            bouncepart.push(noteInfo.value);\n          });\n        });\n        while (tonepart.length) {\n          tonepart.pop().dispose(); //最后一个被dispose，同时要从数组中删掉\n        }\n        tonepart[0] = new Tone.Part(function (time, value) {\n          //不能老这new啊，要每次一个数组，每次改动最后一个\n          piano.triggerAttackRelease(value.note, \"8n\", time);\n        }, bouncepart).start(0);\n\n        bouncepart.sort(function (a, b) {\n          return 0 + a.time - b.time;\n        });\n        console.log(bouncepart);\n        /* Cannot get final name for export \"generateJSCadCode\" in \"./src/_common/js/magic.js\" (known exports: RealMagic mapNoteTimeToColor mapNoteMidiToLength, known reexports: ) */ undefined(bouncepart);\n      } else {\n        alert('tm什么都没录');\n      }\n    }\n  },\n  created: function created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    var inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase());\n\n    //test magic.js\n    // const work = [{note: \"E4\", time: 0.14585000000000037},\n    // {note: \"G4\", time: 1.0295},\n    // {note: \"G4\", time: 1.3985},\n    // {note: \"E4\", time: 2.6605300000000005},\n    // {note: \"D4\", time: 3.4207450000000006},\n    // {note: \"C4\", time: 4.196245000000001},\n    // {note: \"G4\", time: 2.671395000000004},\n    // {note: \"A4\", time: 3.35932},\n    // {note: \"B4\", time: 4.183044999999998}]\n    //\n    // Magic.generateJSCadCode(work)\n\n\n    if (!inWechat) return;\n    if (getUrlParam('code') || js_cookie[\"get\"]('serviceToken')) {\n      //TODO:ajax call to get info\n      getUserInfo(getUrlParam('code')).then(function (res) {\n        if (res.data.errcode >= 20000) {\n          // 网页内cookie失效，需要重新验证\n          js_cookie[\"remove\"]('serviceToken');\n          location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n        }\n        alert('welcome' + res.data.data.realname);\n        console.log('get user info success', res.data.data);\n      }).catch(function (err) {\n        js_cookie[\"remove\"]('serviceToken');\n        location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n      });\n    } else {\n      //又没有微信给的auth code又没有token存在cookie，只得验证\n      location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n    }\n  },\n  mounted: function mounted() {\n    // this.startRecord();\n  },\n  updated: function updated() {}\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-94d961f8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MBMaker.vue\nvar MBMaker_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{class:['mask', _vm.timerToStartRecord>1?'fadein':'fadeout', _vm.timerToStartRecord==0?'hide':'']},[_c('p',{staticClass:\"rotate\",attrs:{\"id\":\"timer\"}},[_vm._v(_vm._s(_vm.timerToStartRecord))])]),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"keys\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.touchStartHandler($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.touchEndHandler($event)}}},[_c('div',{class:['white', 'c', _vm.activeNote.C4?'active-note':''],attrs:{\"id\":\"C4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db4?'active-note':''],attrs:{\"id\":\"Db4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D4?'active-note':''],attrs:{\"id\":\"D4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb4?'active-note':''],attrs:{\"id\":\"Eb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E4?'active-note':''],attrs:{\"id\":\"E4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F4?'active-note':''],attrs:{\"id\":\"F4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb4?'active-note':''],attrs:{\"id\":\"Gb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G4?'active-note':''],attrs:{\"id\":\"G4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab4?'active-note':''],attrs:{\"id\":\"Ab4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A4?'active-note':''],attrs:{\"id\":\"A4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb4?'active-note':''],attrs:{\"id\":\"Bb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B4?'active-note':''],attrs:{\"id\":\"B4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C5?'active-note':''],attrs:{\"id\":\"C5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db5?'active-note':''],attrs:{\"id\":\"Db5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D5?'active-note':''],attrs:{\"id\":\"D5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb5?'active-note':''],attrs:{\"id\":\"Eb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E5?'active-note':''],attrs:{\"id\":\"E5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F5?'active-note':''],attrs:{\"id\":\"F5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb5?'active-note':''],attrs:{\"id\":\"Gb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G5?'active-note':''],attrs:{\"id\":\"G5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab5?'active-note':''],attrs:{\"id\":\"Ab5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A5?'active-note':''],attrs:{\"id\":\"A5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb5?'active-note':''],attrs:{\"id\":\"Bb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B5?'active-note':''],attrs:{\"id\":\"B5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C6?'active-note':''],attrs:{\"id\":\"C6\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"controller\"},[_c('div',{staticClass:\"funcBtn record\",class:_vm.recording?'active':'',on:{\"click\":_vm.toggleRecord}},[_c('div',{staticClass:\"recordHint\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn play\",class:_vm.replaying?'active':'',on:{\"click\":_vm.toggleReplay}},[_c('div',{class:['rotate',_vm.replaying?'playHint':'stopHint']})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn undo\",on:{\"click\":_vm.undoRecord}},[_c('div',{staticClass:\"undoHint rotate\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn bounce\",on:{\"click\":_vm.bounceProject}},[_c('div',{staticClass:\"bounceHint rotate\"})])])])])}\nvar MBMaker_staticRenderFns = []\nvar MBMaker_esExports = { render: MBMaker_render, staticRenderFns: MBMaker_staticRenderFns }\n/* harmony default export */ var components_MBMaker = (MBMaker_esExports);\n// CONCATENATED MODULE: ./src/components/MBMaker.vue\nfunction MBMaker_injectStyle (ssrContext) {\n  __webpack_require__(\"GWyx\")\n}\nvar MBMaker_normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* template functional */\nvar MBMaker___vue_template_functional__ = false\n/* styles */\nvar MBMaker___vue_styles__ = MBMaker_injectStyle\n/* scopeId */\nvar MBMaker___vue_scopeId__ = \"data-v-94d961f8\"\n/* moduleIdentifier (server only) */\nvar MBMaker___vue_module_identifier__ = null\nvar MBMaker_Component = MBMaker_normalizeComponent(\n  MBMaker,\n  components_MBMaker,\n  MBMaker___vue_template_functional__,\n  MBMaker___vue_styles__,\n  MBMaker___vue_scopeId__,\n  MBMaker___vue_module_identifier__\n)\n\n/* harmony default export */ var src_components_MBMaker = (MBMaker_Component.exports);\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/components/MBItem.vue\n\nwindow.Tone = __webpack_require__(\"ZnLv\");\n\n\n\n\n\nvar MBItem_piano = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\nvar MBItem_mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\nvar MBItem_bouncepart = [];\nvar MBItem_timeline = 0;\n/* harmony default export */ var MBItem = ({\n  data: function data() {\n    return {\n      userInfo: {},\n      timerToStartRecord: 0,\n      recording: false,\n      replaying: false\n    };\n  },\n\n  methods: {\n    load: function load() {}\n  },\n  created: function created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    var inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase());\n\n    //test magic.js\n    // const work = [{note: \"E4\", time: 0.14585000000000037},\n    // {note: \"G4\", time: 1.0295},\n    // {note: \"G4\", time: 1.3985},\n    // {note: \"E4\", time: 2.6605300000000005},\n    // {note: \"D4\", time: 3.4207450000000006},\n    // {note: \"C4\", time: 4.196245000000001},\n    // {note: \"G4\", time: 2.671395000000004},\n    // {note: \"A4\", time: 3.35932},\n    // {note: \"B4\", time: 4.183044999999998}]\n    //\n    // Magic.generateJSCadCode(work)\n\n\n    if (!inWechat) return;\n    wx.onMenuShareTimeline({\n      title: 'test share',\n      link: '//m.baidu.com',\n      imgUrl: '',\n      success: function success() {\n        alert('成功分享');\n      },\n      cancel: function cancel() {\n        alert('取消分享');\n      }\n    });\n  },\n  mounted: function mounted() {\n    // this.startRecord();\n  },\n  updated: function updated() {}\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-15915e84\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MBItem.vue\nvar MBItem_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{class:['mask', _vm.timerToStartRecord>1?'fadein':'fadeout', _vm.timerToStartRecord==0?'hide':'']},[_c('p',{staticClass:\"rotate\",attrs:{\"id\":\"timer\"}},[_vm._v(_vm._s(_vm.timerToStartRecord))])]),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"keys\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.touchStartHandler($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.touchEndHandler($event)}}},[_c('div',{class:['white', 'c', _vm.activeNote.C4?'active-note':''],attrs:{\"id\":\"C4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db4?'active-note':''],attrs:{\"id\":\"Db4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D4?'active-note':''],attrs:{\"id\":\"D4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb4?'active-note':''],attrs:{\"id\":\"Eb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E4?'active-note':''],attrs:{\"id\":\"E4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F4?'active-note':''],attrs:{\"id\":\"F4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb4?'active-note':''],attrs:{\"id\":\"Gb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G4?'active-note':''],attrs:{\"id\":\"G4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab4?'active-note':''],attrs:{\"id\":\"Ab4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A4?'active-note':''],attrs:{\"id\":\"A4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb4?'active-note':''],attrs:{\"id\":\"Bb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B4?'active-note':''],attrs:{\"id\":\"B4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C5?'active-note':''],attrs:{\"id\":\"C5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db5?'active-note':''],attrs:{\"id\":\"Db5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D5?'active-note':''],attrs:{\"id\":\"D5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb5?'active-note':''],attrs:{\"id\":\"Eb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E5?'active-note':''],attrs:{\"id\":\"E5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F5?'active-note':''],attrs:{\"id\":\"F5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb5?'active-note':''],attrs:{\"id\":\"Gb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G5?'active-note':''],attrs:{\"id\":\"G5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab5?'active-note':''],attrs:{\"id\":\"Ab5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A5?'active-note':''],attrs:{\"id\":\"A5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb5?'active-note':''],attrs:{\"id\":\"Bb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B5?'active-note':''],attrs:{\"id\":\"B5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C6?'active-note':''],attrs:{\"id\":\"C6\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"controller\"},[_c('div',{staticClass:\"funcBtn record\",class:_vm.recording?'active':'',on:{\"click\":_vm.toggleRecord}},[_c('div',{staticClass:\"recordHint\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn play\",class:_vm.replaying?'active':'',on:{\"click\":_vm.toggleReplay}},[_c('div',{class:['rotate',_vm.replaying?'playHint':'stopHint']})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn undo\",on:{\"click\":_vm.undoRecord}},[_c('div',{staticClass:\"undoHint rotate\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn bounce\",on:{\"click\":_vm.bounceProject}},[_c('div',{staticClass:\"bounceHint rotate\"})])])])])}\nvar MBItem_staticRenderFns = []\nvar MBItem_esExports = { render: MBItem_render, staticRenderFns: MBItem_staticRenderFns }\n/* harmony default export */ var components_MBItem = (MBItem_esExports);\n// CONCATENATED MODULE: ./src/components/MBItem.vue\nfunction MBItem_injectStyle (ssrContext) {\n  __webpack_require__(\"CA19\")\n}\nvar MBItem_normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* template functional */\nvar MBItem___vue_template_functional__ = false\n/* styles */\nvar MBItem___vue_styles__ = MBItem_injectStyle\n/* scopeId */\nvar MBItem___vue_scopeId__ = \"data-v-15915e84\"\n/* moduleIdentifier (server only) */\nvar MBItem___vue_module_identifier__ = null\nvar MBItem_Component = MBItem_normalizeComponent(\n  MBItem,\n  components_MBItem,\n  MBItem___vue_template_functional__,\n  MBItem___vue_styles__,\n  MBItem___vue_scopeId__,\n  MBItem___vue_module_identifier__\n)\n\n/* harmony default export */ var src_components_MBItem = (MBItem_Component.exports);\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/components/MBAuthor.vue\n\nwindow.Tone = __webpack_require__(\"ZnLv\");\n\n\n\n\n\nvar MBAuthor_piano = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\nvar MBAuthor_mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\nvar MBAuthor_plucky = new Tone.PluckSynth().toMaster();\n// var part = new Tone.Part(function(time, value){\n// \t//the value is an object which contains both the note and the velocity\n// piano.triggerAttackRelease(value.note, \"8n\", time)\n// }, [{\"time\" : 1.9, \"note\" : \"C3\"},\n// \t   {\"time\" : 2, \"note\" : \"C4\"},\n//      {\"time\" : 3, \"note\" : \"C3\"},\n//      \t   {\"time\" : 4, \"note\" : \"C4\"}\n// ]).start(0)\n// Tone.Transport.start()\n\nwindow.recorder = []; //Tone.Part => schedule notes\n\nwindow.tonepart = []; // store all the music parts. (ummm,that's why it's named part...)\nvar MBAuthor_bouncepart = [];\nvar MBAuthor_timeline = 0;\n/* harmony default export */ var MBAuthor = ({\n  data: function data() {\n    return {\n      activeNote: {},\n      timerToStartRecord: 0,\n      recording: false,\n      replaying: false\n    };\n  },\n\n  methods: {\n    load: function load() {},\n    startRecord: function startRecord() {\n      var _this = this;\n\n      this.timerToStartRecord = 3;\n      var timer = setInterval(function () {\n        _this.timerToStartRecord -= 1;\n        if (_this.timerToStartRecord == 0) {\n          clearInterval(timer);\n        }\n      }, 1000);\n    },\n\n    touchStartHandler: function touchStartHandler(e) {\n      console.log('down', e.target.id);\n      MBAuthor_piano.triggerAttack(e.target.id);\n      this.$set(this.activeNote, e.target.id, 1);\n      if (this.recording) {\n        recorder.push({\n          'note': e.target.id,\n          'time': +((performance.now() - MBAuthor_timeline) / 1000).toFixed(4)\n        });\n      }\n    },\n    touchEndHandler: function touchEndHandler(e) {\n      // console.log('up',e.target.id)\n      MBAuthor_piano.triggerRelease(e.target.id);\n      // plucky.triggerRelease(e.target.id)\n      this.$set(this.activeNote, e.target.id, 0);\n    },\n    toggleRecord: function toggleRecord(e) {\n      var _this2 = this;\n\n      this.recording = !this.recording;\n      if (this.recording) {\n        //start recording\n        recorder = [];\n        if (!this.replaying) {\n          this.timerToStartRecord = 3;\n          var timer = setInterval(function () {\n            _this2.timerToStartRecord -= 1;\n            if (_this2.timerToStartRecord == 0) {\n              clearInterval(timer);\n              MBAuthor_timeline = performance.now();\n            }\n          }, 1000);\n\n          // timeline = performance.now()\n          // 1. e.timestamp behave not consistent\n          // 2. if currently playing, follow that timeline\n        }\n\n        try {\n          // tonepart.dispose()//此处必须dispose，否则会一直往part里面加\n        } catch (e) {\n          console.warn('tone cannot be disposed');\n        }\n      } else {\n        //stop recording\n        console.log('kikikiki');\n        if (recorder.length) {\n          tonepart[tonepart.length] = new Tone.Part(function (time, value) {\n            //不能老这new啊，要每次一个数组，每次改动最后一个\n            MBAuthor_piano.triggerAttackRelease(value.note, \"8n\", time);\n          }, recorder).start(0);\n        }\n      }\n    },\n    toggleReplay: function toggleReplay() {\n      console.log(1);\n      this.replaying = !this.replaying;\n      if (this.replaying) {\n        console.log('kokokoko');\n        MBAuthor_timeline = performance.now();\n        Tone.Transport.start(\"+0.01\"); // in case < context.currentTime\n      } else {\n        Tone.Transport.stop(0); // TODO：必须stop才能start。。。有没有自动stop啊..\n      }\n    },\n    undoRecord: function undoRecord() {\n      //TODO:可以改造为选择哪个进行删除\n      // tonepart[tonepart.length-1].dispose() //dispose是一个part被dispose\n      //TODO:若tonepart里只有一个，应让用户确认是否继续操作\n      // TODO: 如果tonepart里没东西，undo按钮应该grayout\n\n      tonepart.pop().dispose(); //最后一个被dispose，同时要从数组中删掉\n      // Tone.Transport.clear(tonepart);\n    },\n    bounceProject: function bounceProject() {\n      console.log(tonepart);\n      MBAuthor_bouncepart = [];\n      if (tonepart.length) {\n        tonepart.forEach(function (item) {\n          item._events.forEach(function (noteInfo) {\n            MBAuthor_bouncepart.push(noteInfo.value);\n          });\n        });\n        while (tonepart.length) {\n          tonepart.pop().dispose(); //最后一个被dispose，同时要从数组中删掉\n        }\n        tonepart[0] = new Tone.Part(function (time, value) {\n          //不能老这new啊，要每次一个数组，每次改动最后一个\n          MBAuthor_piano.triggerAttackRelease(value.note, \"8n\", time);\n        }, MBAuthor_bouncepart).start(0);\n\n        MBAuthor_bouncepart.sort(function (a, b) {\n          return 0 + a.time - b.time;\n        });\n        console.log(MBAuthor_bouncepart);\n        /* Cannot get final name for export \"generateJSCadCode\" in \"./src/_common/js/magic.js\" (known exports: RealMagic mapNoteTimeToColor mapNoteMidiToLength, known reexports: ) */ undefined(MBAuthor_bouncepart);\n      } else {\n        alert('tm什么都没录');\n      }\n    }\n  },\n  created: function created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    var inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase());\n\n    //test magic.js\n    // const work = [{note: \"E4\", time: 0.14585000000000037},\n    // {note: \"G4\", time: 1.0295},\n    // {note: \"G4\", time: 1.3985},\n    // {note: \"E4\", time: 2.6605300000000005},\n    // {note: \"D4\", time: 3.4207450000000006},\n    // {note: \"C4\", time: 4.196245000000001},\n    // {note: \"G4\", time: 2.671395000000004},\n    // {note: \"A4\", time: 3.35932},\n    // {note: \"B4\", time: 4.183044999999998}]\n    //\n    // Magic.generateJSCadCode(work)\n\n\n    if (!inWechat) return;\n    if (getUrlParam('code') || js_cookie[\"get\"]('serviceToken')) {\n      //TODO:ajax call to get info\n      getUserInfo(getUrlParam('code')).then(function (res) {\n        if (res.data.errcode >= 20000) {\n          // 网页内cookie失效，需要重新验证\n          js_cookie[\"remove\"]('serviceToken');\n          location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n        }\n        alert('welcome' + res.data.data.realname);\n        console.log('get user info success', res.data.data);\n      }).catch(function (err) {\n        js_cookie[\"remove\"]('serviceToken');\n        location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n      });\n    } else {\n      //又没有微信给的auth code又没有token存在cookie，只得验证\n      location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n    }\n  },\n  mounted: function mounted() {\n    // this.startRecord();\n  },\n  updated: function updated() {}\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-94d961f8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MBAuthor.vue\nvar MBAuthor_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{class:['mask', _vm.timerToStartRecord>1?'fadein':'fadeout', _vm.timerToStartRecord==0?'hide':'']},[_c('p',{staticClass:\"rotate\",attrs:{\"id\":\"timer\"}},[_vm._v(_vm._s(_vm.timerToStartRecord))])]),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"keys\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.touchStartHandler($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.touchEndHandler($event)}}},[_c('div',{class:['white', 'c', _vm.activeNote.C4?'active-note':''],attrs:{\"id\":\"C4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db4?'active-note':''],attrs:{\"id\":\"Db4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D4?'active-note':''],attrs:{\"id\":\"D4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb4?'active-note':''],attrs:{\"id\":\"Eb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E4?'active-note':''],attrs:{\"id\":\"E4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F4?'active-note':''],attrs:{\"id\":\"F4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb4?'active-note':''],attrs:{\"id\":\"Gb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G4?'active-note':''],attrs:{\"id\":\"G4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab4?'active-note':''],attrs:{\"id\":\"Ab4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A4?'active-note':''],attrs:{\"id\":\"A4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb4?'active-note':''],attrs:{\"id\":\"Bb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B4?'active-note':''],attrs:{\"id\":\"B4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C5?'active-note':''],attrs:{\"id\":\"C5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db5?'active-note':''],attrs:{\"id\":\"Db5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D5?'active-note':''],attrs:{\"id\":\"D5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb5?'active-note':''],attrs:{\"id\":\"Eb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E5?'active-note':''],attrs:{\"id\":\"E5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F5?'active-note':''],attrs:{\"id\":\"F5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb5?'active-note':''],attrs:{\"id\":\"Gb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G5?'active-note':''],attrs:{\"id\":\"G5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab5?'active-note':''],attrs:{\"id\":\"Ab5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A5?'active-note':''],attrs:{\"id\":\"A5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb5?'active-note':''],attrs:{\"id\":\"Bb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B5?'active-note':''],attrs:{\"id\":\"B5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C6?'active-note':''],attrs:{\"id\":\"C6\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"controller\"},[_c('div',{staticClass:\"funcBtn record\",class:_vm.recording?'active':'',on:{\"click\":_vm.toggleRecord}},[_c('div',{staticClass:\"recordHint\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn play\",class:_vm.replaying?'active':'',on:{\"click\":_vm.toggleReplay}},[_c('div',{class:['rotate',_vm.replaying?'playHint':'stopHint']})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn undo\",on:{\"click\":_vm.undoRecord}},[_c('div',{staticClass:\"undoHint rotate\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn bounce\",on:{\"click\":_vm.bounceProject}},[_c('div',{staticClass:\"bounceHint rotate\"})])])])])}\nvar MBAuthor_staticRenderFns = []\nvar MBAuthor_esExports = { render: MBAuthor_render, staticRenderFns: MBAuthor_staticRenderFns }\n/* harmony default export */ var components_MBAuthor = (MBAuthor_esExports);\n// CONCATENATED MODULE: ./src/components/MBAuthor.vue\nfunction MBAuthor_injectStyle (ssrContext) {\n  __webpack_require__(\"IEmI\")\n}\nvar MBAuthor_normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* template functional */\nvar MBAuthor___vue_template_functional__ = false\n/* styles */\nvar MBAuthor___vue_styles__ = MBAuthor_injectStyle\n/* scopeId */\nvar MBAuthor___vue_scopeId__ = \"data-v-94d961f8\"\n/* moduleIdentifier (server only) */\nvar MBAuthor___vue_module_identifier__ = null\nvar MBAuthor_Component = MBAuthor_normalizeComponent(\n  MBAuthor,\n  components_MBAuthor,\n  MBAuthor___vue_template_functional__,\n  MBAuthor___vue_styles__,\n  MBAuthor___vue_scopeId__,\n  MBAuthor___vue_module_identifier__\n)\n\n/* harmony default export */ var src_components_MBAuthor = (MBAuthor_Component.exports);\n\n// EXTERNAL MODULE: ./node_modules/swiper/dist/css/swiper.css\nvar swiper = __webpack_require__(\"v2ns\");\nvar swiper_default = /*#__PURE__*/__webpack_require__.n(swiper);\n\n// EXTERNAL MODULE: ./node_modules/vue-slider-component/dist/index.js\nvar dist = __webpack_require__(\"GDE4\");\nvar dist_default = /*#__PURE__*/__webpack_require__.n(dist);\n\n// EXTERNAL MODULE: ./node_modules/vue-awesome-swiper/dist/vue-awesome-swiper.js\nvar vue_awesome_swiper = __webpack_require__(\"7QTg\");\nvar vue_awesome_swiper_default = /*#__PURE__*/__webpack_require__.n(vue_awesome_swiper);\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/components/NMBMaker.vue\n\nwindow.Tone = __webpack_require__(\"ZnLv\");\n\n\n\n\n\n\n\nvar touchIdKeyMap = {}; //touch move can have several threads, each thread only activate one note at most\n// e.g. {0:a4,1:b5}\n\nvar MINI_KEY_LENGTH = 200; // px\nvar extendBtnsTimeout = void 0;\n\nvar NMBMaker_piano = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\nvar NMBMaker_mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\nvar NMBMaker_plucky = new Tone.PluckSynth().toMaster();\n\nvar SCREEN_WIDTH = document.documentElement.getBoundingClientRect().width;\nvar SCREEN_HEIGHT = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n\nwindow.tonepart = []; // store all the music parts. (ummm,that's why it's named part...)\nvar NMBMaker_bouncepart = [];\n\nvar recordStartTime = 0;\n\nvar isLinger = true; //非播放状态中未开始录音\nvar replayInterval = undefined; //控制progressbar的setinterval\nvar playOffset = 0; //播放状态的拉条bar初始时间记录\nvar lingerOffset = 0; //未播放状态的拉条bar初始时间记录\nvar PROGRESS_INTERVAL_TIME = 0.1; //0.1秒挪一下\n/* harmony default export */ var NMBMaker = ({\n  components: {\n    swiper: vue_awesome_swiper[\"swiper\"],\n    swiperSlide: vue_awesome_swiper[\"swiperSlide\"],\n    vueSlider: dist_default.a\n  },\n  data: function data() {\n    return {\n      activeNote: {},\n      recordPart: [], //current record part\n      recordParts: [], //each new record goes in here.\n      playing: false,\n      generalControllerShow: false,\n      activeSwiperIndex: 3,\n      lastActiveSwiperIndex: 3 - 1,\n      vuetimeline: 0,\n      showExtendBtns: 0,\n      timelineConfig: {\n        value: 0,\n        width: 8,\n        height: '90%',\n        padding: '0',\n        dotSize: 20,\n        eventType: 'auto',\n        min: 0,\n        max: 200,\n        interval: 1,\n        disabled: false,\n        show: true,\n        tooltip: 'always',\n        // tooltip: 'hidden',\n        piecewise: false,\n        reverse: true,\n        style: {\n          display: 'inline-block'\n        },\n        class: 'star-slider',\n        direction: 'vertical',\n        speed: PROGRESS_INTERVAL_TIME,\n        bgStyle: {\n          backgroundColor: 'rgb(110,113,158)',\n          boxShadow: 'inset 0.5px 0.5px 3px 1px rgba(0,0,0,.36)'\n        },\n        tooltipStyle: {\n          backgroundColor: 'rgb(69, 106, 255)',\n          borderColor: 'rgb(69, 106, 255)'\n          // transform: 'rotate(90deg)',\n        },\n        formatter: function formatter(value) {\n          if (value) {\n            return (value / 10).toFixed(1) + 's/20s';\n          } else {\n            return '0.0s/20s';\n          }\n        },\n\n        processStyle: {\n          backgroundColor: 'rgb(69,106,255)'\n        }\n      }\n    };\n  },\n\n  watch: {\n    playing: function playing(val) {\n      var _this = this;\n\n      console.log('playing status', val);\n      if (val) {\n        //start progress bar\n        replayInterval = setInterval(function () {\n\n          _this.vuetimeline += 1;\n          if (_this.vuetimeline >= 200) {\n            _this.toggleReplay();\n            _this.vuetimeline = 0;\n          }\n        }, PROGRESS_INTERVAL_TIME * 1000);\n      } else {\n        //stop progress bar\n        clearInterval(replayInterval);\n      }\n    }\n  },\n  computed: {\n    swiper: function swiper() {\n      return this.$refs.pianoRoll.swiper;\n    },\n    activePartIndex: function activePartIndex() {\n      return this.PARTNUM - this.activeSwiperIndex - 1;\n    },\n    lastActivePartIndex: function lastActivePartIndex() {\n      return this.PARTNUM - this.lastActiveSwiperIndex - 1;\n    }\n  },\n  methods: {\n    load: function load() {},\n    toggleReplay: function toggleReplay() {\n      console.log(1);\n      this.playing = !this.playing;\n      if (this.playing) {\n        if (this.vuetimeline >= 200) {\n          this.vuetimeline = 0;\n        }\n        // this.confirmRecordPart(!isLinger)\n        playOffset = performance.now() - this.vuetimeline * 100;\n        console.log('播放开始');\n        this.confirmRecordPart(0);\n        console.log('kokokoko');\n        recordStartTime = performance.now();\n        console.log('activeOffsetTime' + this.vuetimeline * 100);\n        Tone.Transport.start(\"+0.01\", this.vuetimeline * 100 / 1000); // TODO:有问题in case < context.currentTime\n      } else {\n        console.log('播放停了');\n        Tone.Transport.stop(0); // TODO：必须stop才能start。。。有没有自动stop啊..\n        // recordStartTime = performance.now()\n      }\n    },\n    handleNoteStart: function handleNoteStart(noteId) {\n      var noteTime = 0;\n      // console.log('down', e.target.id)\n      NMBMaker_piano.triggerAttack(noteId);\n      // console.log('midi no. :', Tone.Frequency(noteId).toMidi())\n      this.$set(this.activeNote, noteId, 1);\n      if (!this.playing) {\n        if (isLinger) {\n          recordStartTime = performance.now();\n          lingerOffset = this.vuetimeline * 100;\n          isLinger = false;\n        }\n        noteTime = performance.now() - recordStartTime + lingerOffset;\n      } else {\n        noteTime = performance.now() - playOffset;\n        // noteTime = this.vuetimeline * 100\n        // console.log('1', this.vuetimeline * 100)\n        // console.log('2', performance.now() - recordStartTime + this.vuetimeline*100)\n      }\n      if (noteTime < 20000) {\n        this.vuetimeline = 10 * noteTime / 1000;\n        this.recordPart.push({\n          'note': noteId,\n          'time': +(noteTime / 1000).toFixed(4)\n        });\n      } else {\n        this.vuetimeline = 20 * 10; // 颗粒度是0.1s => 200份\n        console.log('cannot record more than 20 seconds');\n      }\n    },\n    handleNoteEnd: function handleNoteEnd(noteId) {\n      NMBMaker_piano.triggerRelease(noteId);\n      this.$set(this.activeNote, noteId, 0);\n    },\n    touchNoteStartHandler: function touchNoteStartHandler(e) {\n      console.log(e);\n      //先存起来，防止在该键位touchmove重复\n      touchIdKeyMap[e.changedTouches[0].identifier] = e.target.id; // TODO: 猜测 touchstart只会有一个changetouches///\n      this.handleNoteStart(e.target.id);\n    },\n    touchNoteEndHandler: function touchNoteEndHandler(e) {\n      this.handleNoteEnd(e.target.id);\n      this.handleNoteEnd(touchIdKeyMap[e.changedTouches[0].identifier]); // TODO: 猜测 touchend只会有一个changetouches,记录的正好是该停的\n    },\n    confirmRecordPart: function confirmRecordPart(shouldClearTime) {\n      if (this.recordPart.length) {\n        console.log('processing track: ', this.lastActivePartIndex);\n        if (this.recordParts[this.lastActivePartIndex] && this.recordParts[this.lastActivePartIndex].length) {\n          //已在该track录过,merge both\n          this.recordPart = this.recordPart.concat(this.recordParts[this.lastActivePartIndex]);\n        }\n        if (tonepart[this.lastActivePartIndex]) {\n          tonepart[this.lastActivePartIndex].dispose(); //覆盖之前的需要dispose\n        }\n        tonepart[this.lastActivePartIndex] = new Tone.Part(function (time, value) {\n          //不能老这new啊，要每次一个数组，每次改动最后一个\n          NMBMaker_piano.triggerAttackRelease(value.note, \"8n\", time);\n        }, this.recordPart).start(0);\n        this.recordParts[this.lastActivePartIndex] = this.recordPart;\n        this.recordPart = [];\n      } else {\n        console.log('啥也没录');\n      }\n      this.lastActiveSwiperIndex = this.activeSwiperIndex;\n      // reinit time\n      if (shouldClearTime) {\n        this.vuetimeline = 0; // this is kind of separate for progress view\n        recordStartTime = 0;\n      }\n      isLinger = true;\n    },\n    clearRecordPart: function clearRecordPart(trackNum) {\n      console.log('cleaning track ' + trackNum);\n      if (this.activePartIndex === trackNum) {\n        this.recordPart = [];\n      }\n      if (this.recordParts[trackNum] && this.recordParts[trackNum].length) {\n        this.$set(this.recordParts, trackNum, []);\n        tonepart[trackNum].dispose(); //dispose掉\n        tonepart[trackNum] = undefined; //同时要从数组中删掉\n      } else {\n        console.log('track ' + trackNum + ' has no content');\n      }\n    },\n    bounceProject: function bounceProject() {\n      alert('此步骤确认，需要微信支付');\n      this.confirmRecordPart(0);\n      console.log(this);\n      console.log(tonepart);\n      NMBMaker_bouncepart = [];\n      if (tonepart.length) {\n        tonepart.forEach(function (item) {\n          item._events.forEach(function (noteInfo) {\n            NMBMaker_bouncepart.push(noteInfo.value);\n          });\n        });\n        NMBMaker_bouncepart.sort(function (a, b) {\n          return 0 + a.time - b.time;\n        });\n        //TODO, semi done\n        this.$store.dispatch('BOUNCE_PROJECT', {\n          record: NMBMaker_bouncepart,\n          info: {\n            title: 'default',\n            content: 'default',\n            cover: 'default'\n          }\n        }).then(function () {\n          console.log('successfully bounced');\n          alert('作品已为您存储');\n          // this.$router.push('/music-box-viewer')\n        });\n        while (tonepart.length) {\n          tonepart.pop().dispose(); //最后一个被dispose，同时要从数组中删掉\n        }\n        tonepart[0] = new Tone.Part(function (time, value) {\n          NMBMaker_piano.triggerAttackRelease(value.note, \"8n\", time);\n        }, NMBMaker_bouncepart).start(0);\n        RealMagic(NMBMaker_bouncepart);\n        // Magic.generateJSCadCode(bouncepart)\n      } else {\n        alert('tm什么都没录');\n      }\n    },\n    mapNoteTimeToColor: function mapNoteTimeToColor(t) {\n      return magic_mapNoteTimeToColor(t);\n    },\n    mapNoteMidiToLength: function mapNoteMidiToLength(m) {\n      return magic_mapNoteMidiToLength(m);\n    },\n    adjustTimeline: function adjustTimeline(e) {\n      if (this.playing) {\n        console.log('ccccccccc');\n        this.toggleReplay(); //现在播放中拉条，直接停，涉及到ref读不到最新值貌似，无法直接继续播放 this is TODO\n      } else {\n        isLinger = true; //你拉条了肯定是\n      }\n    },\n    onMiniKeyboardScroll: function onMiniKeyboardScroll(e) {\n      console.log(e.touches[0].clientY);\n    },\n    onMiniKeyboardStart: function onMiniKeyboardStart(e) {\n      console.log(e);\n    },\n    keng: function keng(e) {\n      // console.log(e)\n      // console.log(document.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY).style.backgroundColor=\"yellow\")\n      console.log(e); //e.touches is array like object\n      for (var i = 0; i <= e.changedTouches.length - 1; i++) {\n        var a = document.elementFromPoint(e.changedTouches[i].clientX, e.changedTouches[i].clientY);\n        if (a.classList.contains('white') || a.classList.contains('black')) {\n          if (touchIdKeyMap[e.changedTouches[i].identifier] && touchIdKeyMap[e.changedTouches[i].identifier] != a.getAttribute('id')) {\n            //这个touch已经触发，且和当前不一致\n            console.log(touchIdKeyMap);\n            this.handleNoteStart(a.getAttribute('id'));\n            this.handleNoteEnd(touchIdKeyMap[e.changedTouches[i].identifier]);\n            touchIdKeyMap[e.changedTouches[i].identifier] = a.getAttribute('id');\n          } else if (!touchIdKeyMap[e.changedTouches[i].identifier]) {\n            console.log(2);\n            this.handleNoteStart(a.getAttribute('id'));\n            touchIdKeyMap[e.changedTouches[i].identifier] = a.getAttribute('id');\n          } else {\n            console.log(3);\n            //新旧相同什么都不做\n          }\n        } else {\n          console.log('外边');\n          if (touchIdKeyMap[e.changedTouches[i].identifier]) {\n            this.handleNoteEnd(touchIdKeyMap[e.changedTouches[i].identifier]);\n          }\n          touchIdKeyMap[e.changedTouches[i].identifier] = undefined;\n        }\n      }\n    },\n    btnStart: function btnStart(e) {\n      var _this2 = this;\n\n      console.log(e);\n      extendBtnsTimeout = setTimeout(function () {\n        //show extend buttons\n        _this2.showExtendBtns = true;\n      }, 500);\n    },\n    btnEnd: function btnEnd(e) {\n      // console.log(e)\n      clearTimeout(extendBtnsTimeout);\n      var a = document.elementFromPoint(e.changedTouches[0].clientX, e.changedTouches[0].clientY);\n      console.log(a);\n      if (a && a.classList.contains('bounceBtn')) {\n        //导出\n        this.bounceProject();\n      } else if (a && (a.classList.contains('playBtn') || a.classList.contains('pauseBtn'))) {\n        //播放\n        this.toggleReplay();\n      }\n      this.showExtendBtns = false;\n      //hide extend buttons\n    }\n  },\n  created: function created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    var self = this;\n    // this is very important\n    var docElem = document.documentElement;\n    window.rem = docElem.getBoundingClientRect().width / 10;\n    docElem.style.fontSize = window.rem + 'px';\n    this.PARTNUM = 3;\n    this.pianoRollSwiperOption = {\n      initialSlide: this.PARTNUM,\n      // centeredSlides: true,\n      slidesPerView: 3,\n      on: {\n        // slideChange(e){\n        //   console.log('1',e)\n        // },\n        // slideNextTransitionStart(e) {\n        //   console.log('2',e)\n        // },\n        transitionEnd: function transitionEnd(e) {\n          console.log('3', this.activeIndex); // THIS!!! within swiper...\n          self.activeSwiperIndex = this.activeIndex;\n          self.confirmRecordPart(!isLinger);\n        }\n      }\n    };\n    var inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase());\n    if (!inWechat) return;\n    if (getUrlParam('code') || js_cookie[\"get\"]('serviceToken')) {\n      //TODO:ajax call to get info\n      getUserInfo(getUrlParam('code')).then(function (res) {\n        if (res.data.errcode >= 20000) {\n          // 网页内cookie失效，需要重新验证\n          js_cookie[\"remove\"]('serviceToken');\n          location.replace(\n          // will publish to node project m-musixise, under '/music-box' path\n          'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect');\n        }\n        alert('welcome' + res.data.data.realname);\n        console.log('get user info success', res.data.data);\n      }).catch(function (err) {\n        js_cookie[\"remove\"]('serviceToken');\n        location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect');\n      });\n    } else {\n      //又没有微信给的auth code又没有token存在cookie，只得验证\n      location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect');\n    }\n  },\n  mounted: function mounted() {\n    // this.startRecord();\n    // document.querySelector('#D5').addEventListener( \"pointerenter\", ()=>{\n    //   console.log('jinru')\n    // })\n\n  },\n  updated: function updated() {}\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1a98cf2c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/NMBMaker.vue\nvar NMBMaker_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"container\"}},[_c('div',{staticClass:\"keys\",on:{\"touchmove\":_vm.keng,\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.touchNoteStartHandler($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.touchNoteEndHandler($event)}}},[_c('div',{class:['white', 'c', _vm.activeNote.C4?'active-note':''],attrs:{\"id\":\"C4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db4?'active-note':''],attrs:{\"id\":\"Db4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D4?'active-note':''],attrs:{\"id\":\"D4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb4?'active-note':''],attrs:{\"id\":\"Eb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E4?'active-note':''],attrs:{\"id\":\"E4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F4?'active-note':''],attrs:{\"id\":\"F4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb4?'active-note':''],attrs:{\"id\":\"Gb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G4?'active-note':''],attrs:{\"id\":\"G4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab4?'active-note':''],attrs:{\"id\":\"Ab4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A4?'active-note':''],attrs:{\"id\":\"A4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb4?'active-note':''],attrs:{\"id\":\"Bb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B4?'active-note':''],attrs:{\"id\":\"B4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C5?'active-note':''],attrs:{\"id\":\"C5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db5?'active-note':''],attrs:{\"id\":\"Db5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D5?'active-note':''],attrs:{\"id\":\"D5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb5?'active-note':''],attrs:{\"id\":\"Eb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E5?'active-note':''],attrs:{\"id\":\"E5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F5?'active-note':''],attrs:{\"id\":\"F5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb5?'active-note':''],attrs:{\"id\":\"Gb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G5?'active-note':''],attrs:{\"id\":\"G5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab5?'active-note':''],attrs:{\"id\":\"Ab5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A5?'active-note':''],attrs:{\"id\":\"A5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb5?'active-note':''],attrs:{\"id\":\"Bb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B5?'active-note':''],attrs:{\"id\":\"B5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C6?'active-note':''],attrs:{\"id\":\"C6\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db6?'active-note':''],attrs:{\"id\":\"Db6\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D6?'active-note':''],attrs:{\"id\":\"D6\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb6?'active-note':''],attrs:{\"id\":\"Eb6\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E6?'active-note':''],attrs:{\"id\":\"E6\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F6?'active-note':''],attrs:{\"id\":\"F6\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"semi-piano-roll\",on:{\"touchmove\":function($event){$event.stopPropagation();$event.preventDefault();}}},[_c('swiper',{ref:\"pianoRoll\",attrs:{\"options\":_vm.pianoRollSwiperOption}},[_vm._l((_vm.PARTNUM),function(n){return _c('swiper-slide',[_c('div',{staticClass:\"current-piano-roll\"},[_c('svg',{style:({height:'90%',padding:_vm.timelineConfig.dotSize/2+'px 0'})},[_c('defs',[_c('filter',{attrs:{\"id\":\"glowing\"}},[_c('feGaussianBlur',{attrs:{\"stdDeviation\":\"1\",\"result\":\"coloredBlur\"}}),_vm._v(\" \"),_c('feMerge',[_c('feMergeNode',{attrs:{\"in\":\"coloredBlur\"}}),_vm._v(\" \"),_c('feMergeNode',{attrs:{\"in\":\"SourceGraphic\"}})],1)],1)]),_vm._v(\" \"),_vm._l((_vm.recordPart),function(item,index){return (_vm.activePartIndex===(_vm.PARTNUM-n))?_c('rect',{attrs:{\"x\":2,\"y\":100*item.time/20 + '%',\"width\":_vm.mapNoteMidiToLength(item.note),\"height\":\"3\",\"rx\":\"2\",\"ry\":\"2\",\"fill\":_vm.mapNoteTimeToColor(item.time),\"filter\":\"url(#glowing)\"}}):_vm._e()}),_vm._v(\" \"),_vm._l((_vm.recordParts[_vm.PARTNUM-n]),function(item,index){return _c('rect',{attrs:{\"x\":2,\"y\":100*item.time/20 + '%',\"width\":_vm.mapNoteMidiToLength(item.note),\"height\":\"3\",\"rx\":\"2\",\"ry\":\"2\",\"fill\":_vm.activePartIndex===(_vm.PARTNUM-n)?_vm.mapNoteTimeToColor(item.time):'rgb(120,120,120)',\"filter\":_vm.activePartIndex===(_vm.PARTNUM-n)?'url(#glowing)':''}})})],2),_vm._v(\" \"),_c('div',{staticClass:\"temp\",on:{\"click\":function($event){_vm.clearRecordPart(_vm.PARTNUM-n)}}})])])}),_vm._v(\" \"),_c('swiper-slide'),_vm._v(\" \"),_c('swiper-slide')],2)],1),_vm._v(\" \"),_c('div',{staticClass:\"g-controller\"},[_c('vue-slider',_vm._b({on:{\"callback\":_vm.adjustTimeline,\"drag-end\":function($event){}},model:{value:(_vm.vuetimeline),callback:function ($$v) {_vm.vuetimeline=$$v},expression:\"vuetimeline\"}},'vue-slider',_vm.timelineConfig,false)),_vm._v(\" \"),_c('div',{staticClass:\"btnContainer\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.btnStart($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.btnEnd($event)}}},[_c('div',{class:[_vm.playing?'pauseBtn':'playBtn', 'rotate'],on:{\"click\":_vm.toggleReplay}}),_vm._v(\" \"),_c('div',{class:[_vm.showExtendBtns?'extendBtnsShow':'extendBtnsHide','extendBtns']},[_c('div',{staticClass:\"bounceBtn rotate\"})])])],1)])}\nvar NMBMaker_staticRenderFns = []\nvar NMBMaker_esExports = { render: NMBMaker_render, staticRenderFns: NMBMaker_staticRenderFns }\n/* harmony default export */ var components_NMBMaker = (NMBMaker_esExports);\n// CONCATENATED MODULE: ./src/components/NMBMaker.vue\nfunction NMBMaker_injectStyle (ssrContext) {\n  __webpack_require__(\"BoD0\")\n}\nvar NMBMaker_normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* template functional */\nvar NMBMaker___vue_template_functional__ = false\n/* styles */\nvar NMBMaker___vue_styles__ = NMBMaker_injectStyle\n/* scopeId */\nvar NMBMaker___vue_scopeId__ = \"data-v-1a98cf2c\"\n/* moduleIdentifier (server only) */\nvar NMBMaker___vue_module_identifier__ = null\nvar NMBMaker_Component = NMBMaker_normalizeComponent(\n  NMBMaker,\n  components_NMBMaker,\n  NMBMaker___vue_template_functional__,\n  NMBMaker___vue_styles__,\n  NMBMaker___vue_scopeId__,\n  NMBMaker___vue_module_identifier__\n)\n\n/* harmony default export */ var src_components_NMBMaker = (NMBMaker_Component.exports);\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/components/MBViewer.vue\n\nwindow.Tone = __webpack_require__(\"ZnLv\");\n\n\n\nvar musicPart = undefined;\n\nvar MBViewer_mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]'\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster();\n\n/* harmony default export */ var MBViewer = ({\n  components: {},\n  data: function data() {\n    return {\n      playing: false\n    };\n  },\n\n  computed: {\n    project: function project() {\n      return this.$store.state.recordProject;\n    }\n  },\n  methods: {\n    load: function load() {},\n    prepareMusic: function prepareMusic() {\n      try {\n        musicPart.dispose();\n      } catch (e) {\n        //\n      }\n      musicPart = new Tone.Part(function (time, value) {\n        MBViewer_mbox.triggerAttackRelease(value.note, \"8n\", time);\n      }, this.project).start(0);\n    },\n    loadMusicById: function loadMusicById() {\n      var _this = this;\n\n      console.log('hehe', this.$store.state);\n      var id = this.$store.state.route.query.id;\n      // const id = 29\n\n      if (!id || !this.project) {\n        console.log('搞飞机，没内容');\n        return;\n      }\n      if (id) {\n        //从id取作品\n        console.log('mmm', id);\n        this.$store.dispatch('FETCH_MBOX', { id: id }).then(function () {\n          _this.prepareMusic();\n        });\n      } else if (this.project) {\n        //store里边的作品，刚录的\n        this.prepareMusic();\n      }\n    },\n    togglePlay: function togglePlay() {\n      this.playing = !this.playing;\n      if (this.playing) {\n        // Tone.Transport.start(\"+0.01\", this.vuetimeline * 100 / 1000)\n        Tone.Transport.start(\"+0.01\", 0);\n      } else {\n        Tone.Transport.stop(0); // TODO：必须stop才能start。。。有没有自动stop啊..\n      }\n    }\n  },\n  created: function created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    var self = this;\n    var inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase());\n    self.loadMusicById();\n    if (!inWechat) return;\n    if (getUrlParam('code') || js_cookie[\"get\"]('serviceToken')) {\n      //TODO:ajax call to get info\n      getUserInfo(getUrlParam('code')).then(function (res) {\n        if (res.data.errcode >= 20000) {\n          // 网页内cookie失效，需要重新验证\n          js_cookie[\"remove\"]('serviceToken');\n          location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n        }\n        alert('welcome' + res.data.data.realname);\n        console.log('get user info success', res.data.data);\n      }).catch(function (err) {\n        js_cookie[\"remove\"]('serviceToken');\n        location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n      });\n    } else {\n      //又没有微信给的auth code又没有token存在cookie，只得验证\n      location.replace('https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect');\n    }\n  },\n  mounted: function mounted() {\n    // this.startRecord();\n  },\n  updated: function updated() {}\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-9843fa82\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MBViewer.vue\nvar MBViewer_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"container\"}},[_c('div',{staticClass:\"mb\"},[_c('div',{class:[_vm.playing?'pauseBtn':'playBtn', 'rotate'],on:{\"click\":_vm.togglePlay}})]),_vm._v(\" \"),_vm._m(0,false,false)])}\nvar MBViewer_staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"operate\"},[_c('div',{staticClass:\"share\"}),_vm._v(\" \"),_c('div',{staticClass:\"purchase\"})])}]\nvar MBViewer_esExports = { render: MBViewer_render, staticRenderFns: MBViewer_staticRenderFns }\n/* harmony default export */ var components_MBViewer = (MBViewer_esExports);\n// CONCATENATED MODULE: ./src/components/MBViewer.vue\nfunction MBViewer_injectStyle (ssrContext) {\n  __webpack_require__(\"ibai\")\n}\nvar MBViewer_normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* template functional */\nvar MBViewer___vue_template_functional__ = false\n/* styles */\nvar MBViewer___vue_styles__ = MBViewer_injectStyle\n/* scopeId */\nvar MBViewer___vue_scopeId__ = \"data-v-9843fa82\"\n/* moduleIdentifier (server only) */\nvar MBViewer___vue_module_identifier__ = null\nvar MBViewer_Component = MBViewer_normalizeComponent(\n  MBViewer,\n  components_MBViewer,\n  MBViewer___vue_template_functional__,\n  MBViewer___vue_styles__,\n  MBViewer___vue_scopeId__,\n  MBViewer___vue_module_identifier__\n)\n\n/* harmony default export */ var src_components_MBViewer = (MBViewer_Component.exports);\n\n// CONCATENATED MODULE: ./src/router/index.js\n\n\n\n\n\n\n\n\n\nvue_esm[\"a\" /* default */].use(vue_router_esm[\"a\" /* default */]);\n\n/* harmony default export */ var router = (new vue_router_esm[\"a\" /* default */]({\n  mode: 'history', // avoid hash in url\n  routes: [{\n    path: '/',\n    name: 'HelloWorld',\n    component: src_components_HelloWorld\n  }, {\n    path: '/music-box-maker',\n    name: 'MBMaker',\n    component: src_components_MBMaker\n  }, {\n    path: '/new-music-box-maker',\n    name: 'NMBMaker',\n    component: src_components_NMBMaker\n  }, {\n    path: '/music-box-viewer',\n    name: 'MBViewer',\n    component: src_components_MBViewer\n  }, {\n    path: '/music-box-item',\n    name: 'MBItem',\n    component: src_components_MBItem\n  }, {\n    path: '/music-box-author',\n    name: 'MBAuthor',\n    component: src_components_MBAuthor\n  }]\n}));\n// CONCATENATED MODULE: ./src/main.js\n// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\n\n\n\n\n\n\n\nvue_esm[\"a\" /* default */].use(vue_touch_default.a, { name: 'v-touch' });\nvue_esm[\"a\" /* default */].config.productionTip = false;\nvar store = createStore();\nObject(vuex_router_sync[\"sync\"])(store, router);\n\n/* eslint-disable no-new */\nnew vue_esm[\"a\" /* default */]({\n  el: '#app',\n  router: router,\n  store: store,\n  template: '<App/>',\n  components: { App: src_App }\n});\n\n/***/ }),\n\n/***/ \"ViPM\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"e1+N\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"ibai\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"v2ns\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n},[\"NHnr\"]);\n\n\n// WEBPACK FOOTER //\n// static/js/app.7139261859a4dbbba8de.js","import * as Cookies from 'js-cookie';\n\nconst axios = require('axios');\n\nconst reqConfig = {\n  headers: {\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n  },\n};\n// TODO:cause 500?????? just cuz this few lines???\nconst tokenInCookie = Cookies.get('serviceToken');\n\nexport function getUserInfo(wxcode) {\n  if (tokenInCookie) {\n    reqConfig.headers.Authorization = `Bearer ${tokenInCookie}`;\n    return axios.post('//api.musixise.com/api/user/getInfo', '', reqConfig);\n  } else if (!tokenInCookie && wxcode) {\n    return new Promise((resolve, reject) => {\n      axios.post(`//api.musixise.com/api/user/oauth/wechat/callback?code=${wxcode}`, '', reqConfig)\n        .then((res) => {\n          if (res.data.errcode === 20001) {\n            reject(20001); // 相当于return了\n          }\n          const serviceToken = res.data.data.id_token;\n          reqConfig.headers.Authorization = `Bearer ${serviceToken}`;\n          Cookies.set('serviceToken', serviceToken, {\n            expires: 7,\n          });\n          return axios.post('//api.musixise.com/api/user/getInfo', '', reqConfig);\n        }, () => {\n          reject();\n        })\n        .then((res) => {\n          resolve(res);\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n  // !tokenInCookie&&!wxcode的情况在app.js里处理, 不会走到这里\n  return false;\n}\n\nexport function uploadRecord(record, info) {\n  return new Promise((resolve, reject) => {\n    const formReqConfig = { headers: { 'Content-Type': 'multipart/form-data', processData: false } };\n    const blob = new Blob([JSON.stringify(record)]);\n    const reader = new FileReader();\n    reader.onload = async (event) => {\n      const fd = new FormData();\n      fd.append('fname', 'test.txt');\n      fd.append('data', event.target.result);\n      const postFix = await axios.post('//api.musixise.com/api/uploadAudio', fd, formReqConfig);\n      const workURL = `http://oiqvdjk3s.bkt.clouddn.com/${postFix}`;\n      const param = {\n        ...info,\n        url: workURL,\n      };\n      console.log(workURL);\n      return axios.post('//api.musixise.com/api/work/create', JSON.stringify(param), reqConfig)\n               .then((res) => {\n                 resolve(res);\n               })\n               .catch((err) => {\n                 reject(err);\n               });\n    };\n    reader.readAsDataURL(blob);\n  });\n  // trigger the read from the reader...\n}\n\nexport function fetchMbox(id) {\n  return axios.post(`//api.musixise.com/api/work/detail/${id}`, '', reqConfig);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/_common/js/api.js","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-091aadf1\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-091aadf1\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-52bc8902\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./HelloWorld.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./HelloWorld.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-52bc8902\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./HelloWorld.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-52bc8902\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/HelloWorld.vue\n// module id = null\n// module chunks = ","export function getUrlParam(key) {\n  const reg = new RegExp(`[?|&]${key}=([^&]+)`);\n  const match = location.search.match(reg);\n  return match && match[1];\n}\n\nexport function getUrlParam1(key) {\n  const reg = new RegExp(`[?|&]${key}=([^&]+)`);\n  const match = location.search.match(reg);\n  return match && match[1];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/_common/js/util.js","const Tone = require('tone');\n\nconst SAME_NOTE_INTERVAL = 1; // 同一个音不能相距小于1秒，不然音片打击出问题\nconst notesObj = {};\nconst notesArray = [];\nconst FreqsResult = [];\n\n// notesInfo example\n// let work = [{note: \"E4\", time: 0.14585000000000037},\n// {note: \"G4\", time: 1.0295},\n// {note: \"G4\", time: 1.3985},\n// {note: \"E4\", time: 2.6605300000000005},\n// {note: \"D4\", time: 3.4207450000000006},\n// {note: \"C4\", time: 4.196245000000001},\n// {note: \"G4\", time: 2.671395000000004},\n// {note: \"A4\", time: 3.35932},\n// {note: \"B4\", time: 4.183044999999998}]\n\nexport function RealMagic(items) {\n  console.log('== Enter RealMagic ==');\n  console.log(JSON.stringify(items));\n  const tasksObj = {};\n  items.forEach((item) => {\n    //* 2 cuz print mbox need 1 octave higher.\n    const itemNoteFreq = parseInt(Tone.Frequency(item.note).toFrequency() * 2, 10);\n    if (!tasksObj[itemNoteFreq]) { tasksObj[itemNoteFreq] = []; }\n    tasksObj[itemNoteFreq].push(item.time);\n  });\n  // tasksObj is like {784:[1.0295,1.39,2.6713],659:[2.66],...}\n\n  // then we focus on each task\n  const taskTypes = Object.keys(tasksObj); // [659,784,...]  freq array, 排好序的（object.keys）\n  const taskTimeArrays = Object.values(tasksObj); // [[2.66]，[1.0295,1.39,2.6713]] 顺序跟上面对应的\n  const machines = []; // init with existing types, will add more machines\n  const groups = []; // will final be [[1],[1,2,1],...], corespond to taskTimeArrays\n\n  if (taskTypes.length > 18) {\n    console.log('音种类超过18个，这个做不了');\n    return false;\n  }\n\n  taskTimeArrays.forEach((timeArray, index) => {\n    const final = [];\n    timeArray.forEach((time, j) => {\n      const test = []; // 校验当前final里不能用的序号， final里序号种类和test种类相同则证明不行\n      let allPreviousOccupied = false;\n      let successFound = false;\n      if (j === 0) {\n        final.push(1); // 给第1组的第一个任务分配第一个机器\n      } else {\n        let counter = j;\n        while (counter >= 1 && !allPreviousOccupied) { // TODO: -1 or 0\n          counter -= 1;\n          if ((time - timeArray[counter] >= SAME_NOTE_INTERVAL) && test.indexOf(final[counter]) === -1) {\n            final.push(final[counter]);\n            successFound = true;\n            break;\n          } else if (test.indexOf(final[counter]) === -1) {\n            test.push(final[counter]);\n            if ([...new Set(final)].length === [...new Set(test)].length) {\n              // final目前已有的都不满足，set可以取unique elements [1,1,2,2,3,1] => [1,2,3]\n              allPreviousOccupied = true;\n              break;\n            }\n          }\n        }\n        if ((counter === 0 && !successFound) || allPreviousOccupied) {\n          final.push(Math.max(...final) + 1);\n        }\n      }\n    });\n    groups.push(final);\n  });\n  console.log(taskTypes);\n  console.log(taskTimeArrays);\n  console.log('hehe', groups); // [[1],[1,2,1],...], corespond to taskTimeArrays\n\n  // now we have groups, let's build machines based on this\n  groups.forEach((group, index) => {\n    let count = 0;\n    while (count <= Math.max(...group) - 1) {\n      machines.push(taskTypes[index]);\n      count += 1;\n    }\n  });\n  if (machines.length < 18) {\n    const lastMachine = machines[machines.length - 1];\n    while (machines.length < 18) {\n      machines.push(lastMachine); // make it length of 18\n    }\n    // machines is like [\"1046\", \"1174\", \"1318\", \"1318\", \"1318\", \"1396\", \"1567\"] of 18 length\n  } else if (machines.length > 18) {\n    console.log('所需音片儿超过18个');\n    return false;\n  }\n  console.log(machines);\n  // then we merge all the tasks\n\n  // test1: [[1],[1,2,1]] => [1,2,3,2]\n  // test2: [[1,2,1],[1,2,3]] => [1,2,1,3,4,5]\n  const finalBins = groups.reduce((a, b) => a.concat(b.map(item => item + Math.max(...a))));\n  let finalTimings = taskTimeArrays.reduce((a, b) => a.concat(b)); // just flatten it\n  finalTimings = finalTimings.map(item => (item * 15) / 20); // normalize from 20s to 15s\n  const musicboxPins = finalBins.map((bin, index) => `generatePin(${finalTimings[index]},${bin})`);\n  console.log(`\n    //底下低音,上面高音\n  const DOT_WIDTH = 0.6\n  const RATIO = 0.98\n  const OFFSET = 2.2 //1.95 is center\n  const OUTER_RADIUS = 6.6\n  const INNER_RADIUS = 5.9\n  function generatePin(noteSec, noteNo) {\n    return rotate(90, [1, 0, 4 * noteSec * RATIO / 15], cylinder({\n      h: 1,\n      r: DOT_WIDTH / 2,\n      center: true\n    })).translate([sin(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -cos(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -9.95 + OFFSET + 0.4 + (noteNo - 1) * .9])\n  }\n\n  function main() {\n    let cylinderBody = difference(cylinder({h: 19.9,r: OUTER_RADIUS,center: true}),cylinder({h: 19.9,r: INNER_RADIUS,center: true}))\n    let holes = union(${musicboxPins})\n    return union(cylinderBody,holes).translate([0, 0, 0]).scale(1);\n  }`);\n}\n\n// export function generateFreqs(notesInfo) {\n//   notesObj = {};\n//   notesArray = [];\n//   FreqsResult = [];\n//   console.log(notesInfo);\n//   notesInfo.forEach((item) => {\n//     // console.log(item.note)\n//     // console.log(notesObj)\n//     if (!(item.note in notesObj)) {\n//       console.log('!!');\n//       notesObj[item.note] = 1;\n//       notesArray.push({\n//         note: item.note,\n//         freq: Tone.Frequency(item.note).toFrequency(),\n//       });\n//     }\n//   });\n//   notesArray.sort((a, b) => (a.freq - b.freq));\n//   console.log(`本首作品共有${notesArray.length}种音符`);\n//   notesArray.forEach((item, index) => {\n//     FreqsResult.push(item.freq * 2);\n//     notesObj[item.note] = index + 1; // 这个note占18音的第几个\n//   });\n//   console.log('它们的频率是', FreqsResult);\n//   return FreqsResult;\n// }\n\n// export function generateJSCadCode(notesInfo) {\n//   let musicboxPins = [];\n//   // norm timing to 15 second\n//   const lastNoteTime = notesInfo[notesInfo.length - 1].time;\n//   if (lastNoteTime > 15) {\n//     notesInfo.forEach((item) => {\n//       item.time = (item.time * 15) / lastNoteTime;\n//     });\n//   }\n//   // get note types\n//   const freqs = generateFreqs(notesInfo);\n//   if (freqs.length > 18) { return false; }\n//   musicboxPins = notesInfo.map(item => `generatePin(${item.time},${notesObj[item.note]})`);\n//   console.log(`\n//   const DOT_WIDTH = 0.6\n//   const RATIO = 0.98\n//   const OFFSET = 2.2 //1.95 is center\n//   const OUTER_RADIUS = 6.6\n//   const INNER_RADIUS = 5.9\n//   function generatePin(noteSec, noteNo) {\n//     return rotate(90, [1, 0, 4 * noteSec * RATIO / 15], cylinder({\n//       h: 1,\n//       r: DOT_WIDTH / 2,\n//       center: true\n//     })).translate([sin(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -cos(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -9.95 + OFFSET + 0.4 + (noteNo - 1) * .9])\n//   }\n//   function main() {\n//     let cylinderBody = difference(cylinder({h: 19.9,r: OUTER_RADIUS,center: true}),cylinder({h: 19.9,r: INNER_RADIUS,center: true}))\n//     let holes = union(${musicboxPins})\n//     return union(cylinderBody,holes).translate([0, 0, 0]).scale(1);\n//   }`);\n// }\n\nexport function mapNoteTimeToColor(time) {\n  // let rgb = [0, 0, 0];\n  const COLOR1 = [151, 255, 241];\n  const COLOR2 = [98, 166, 223];\n  const COLOR3 = [154, 124, 255];\n  const TIME_MAX = 20;\n  let rgb = [0, 0, 0];\n  if (time < 0 || time > TIME_MAX) {\n    // console.warn('we don\\'t allow time above 20. from \\'mapNoteTimeToColor\\' util function');\n  } else if (time <= 10) {\n    rgb = [COLOR1[0] + ((time * (COLOR2[0] - COLOR1[0])) / (TIME_MAX / 2)),\n      COLOR1[1] + ((time * (COLOR2[1] - COLOR1[1])) / (TIME_MAX / 2)),\n      COLOR1[2] + ((time * (COLOR2[2] - COLOR1[2])) / (TIME_MAX / 2))];\n  }\n  rgb = [COLOR2[0] + ((time * (COLOR3[0] - COLOR2[0])) / (TIME_MAX / 2)),\n    COLOR2[1] + ((time * (COLOR3[1] - COLOR2[1])) / (TIME_MAX / 2)),\n    COLOR2[2] + ((time * (COLOR3[2] - COLOR2[2])) / (TIME_MAX / 2))];\n  // console.log(`rgb(${Math.floor(rgb[0])},${Math.floor(rgb[1])},${Math.floor(rgb[2])})`);\n  return `rgb(${Math.floor(rgb[0])},${Math.floor(rgb[1])},${Math.floor(rgb[2])})`;\n}\nexport function mapNoteMidiToLength(noteName) {\n  // in our context, the midi range would be from 60 - 84\n  // return `${(75 * 0.8 * ((Tone.Frequency(noteName).toMidi() - 60) / (84 - 40))) + 0.2}`; // 75 is rem to px\n  // 50 - 110\n  return `${(75 * 0.8 * ((Tone.Frequency(noteName).toMidi() - 50) / (110 - 40))) + 0.2}`; // 75 is rem to px\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/_common/js/magic.js","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-94d961f8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./MBMaker.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./MBMaker.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-94d961f8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./MBMaker.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-94d961f8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/MBMaker.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-15915e84\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./MBItem.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./MBItem.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-15915e84\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./MBItem.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-15915e84\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/MBItem.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-94d961f8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./MBAuthor.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./MBAuthor.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-94d961f8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./MBAuthor.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-94d961f8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/MBAuthor.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1a98cf2c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./NMBMaker.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./NMBMaker.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1a98cf2c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./NMBMaker.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1a98cf2c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/NMBMaker.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-9843fa82\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./MBViewer.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./MBViewer.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-9843fa82\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./MBViewer.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-9843fa82\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/MBViewer.vue\n// module id = null\n// module chunks = ","import {\n  fetchUser,\n  fetchItems,\n  fetchIdsByType,\n  fetchMbox,\n  uploadRecord,\n} from '../_common/js/api';\n/*\n  getUserInfo\n  getWorkInfo\n  getMusixiserInfo\n  saveWork\n*/\nexport default {\n  BOUNCE_PROJECT: ({ commit, state }, { record, info }) => uploadRecord(record, info),\n    // 存作品到后台\n         // uploadRecord(record, info).then(() => {\n    //   // commit('SET_BOUNCE_PROJECT', { record, info });\n    //   // 可以在组建直接跳链接，不commit 存store一道\n    // });\n\n  FETCH_MBOX: ({ commit, state }, { id }) =>\n    // 获取某id的音乐盒音乐内容\n     fetchMbox(id)\n      .then((project) => {\n        // console.log('xxi', project.data.data.url);\n        const request = new XMLHttpRequest();\n        request.open('GET', project.data.data.url, true);\n        request.send(null);\n        request.onreadystatechange = function () {\n          if (request.readyState === 4 && request.status === 200) {\n            const type = request.getResponseHeader('Content-Type');\n            if (type.indexOf('text') !== 1) {\n              commit('SET_ID_PROJECT', { record: JSON.parse(request.responseText), info: project.data.data });\n            }\n          }\n        };\n      }),\n  // ensure data for rendering given list type\n  FETCH_LIST_DATA: ({ commit, dispatch, state }, { type }) => {\n    commit('SET_ACTIVE_TYPE', { type });\n    return fetchIdsByType(type)\n      .then(ids => commit('SET_LIST', { type, ids }))\n      .then(() => dispatch('ENSURE_ACTIVE_ITEMS'));\n  },\n\n  // ensure all active items are fetched\n  ENSURE_ACTIVE_ITEMS: ({ dispatch, getters }) => dispatch('FETCH_ITEMS', {\n    ids: getters.activeIds,\n  }),\n\n  FETCH_ITEMS: ({ commit, state }, { ids }) => {\n    // on the client, the store itself serves as a cache.\n    // only fetch items that we do not already have, or has expired (3 minutes)\n    const now = Date.now();\n    ids = ids.filter((id) => {\n      const item = state.items[id];\n      if (!item) {\n        return true;\n      }\n      if (now - item.__lastUpdated > 1000 * 60 * 3) {\n        return true;\n      }\n      return false;\n    });\n    if (ids.length) {\n      return fetchItems(ids).then(items => commit('SET_ITEMS', { items }));\n    }\n    return Promise.resolve();\n  },\n\n  FETCH_USER: ({ commit, state }, { id }) => (state.users[id]\n      ? Promise.resolve(state.users[id])\n      : fetchUser(id).then(user => commit('SET_USER', { id, user }))),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/actions.js","import Vue from 'vue';\n\nexport default {\n  SET_USER_INFO: (state, { type }) => { // 个人信息\n    state.activeType = type;\n  },\n\n  SET_WORK_INFO: (state, { type, ids }) => { // 作品详情\n    state.lists[type] = ids;\n  },\n\n  SET_MUSIXISER_INFO: (state, { items }) => { // 作者信息\n    items.forEach((item) => {\n      if (item) {\n        Vue.set(state.items, item.id, item);\n      }\n    });\n  },\n  SET_BOUNCE_PROJECT: (state, { record }) => { // 储存录制信息\n    state.recordProject = record;\n  },\n  SET_ID_PROJECT: (state, { record, info }) => { // 储存录制信息\n    state.recordProject = record; // this is the music itself\n    state.recordProjectInfo = info; // this includes all the relative info\n  },\n  SET_FINAL_WORK: (state, { type }) => { // 储存成品信息\n    state.activeType = type;\n  },\n  SET_USER: (state, { id, user }) => {\n    Vue.set(state.users, id, user || false); /* false means user not found */\n  },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/mutations.js","export default {\n  // ids of the items that should be currently displayed based on\n  // current list type and current pagination\n  activeIds (state) {\n    const { activeType, itemsPerPage, lists } = state\n    const page = Number(state.route.params.page) || 1\n    if (activeType) {\n      const start = (page - 1) * itemsPerPage\n      const end = page * itemsPerPage\n      return lists[activeType].slice(start, end)\n    } else {\n      return []\n    }\n  },\n\n  // items that should be currently displayed.\n  // this Array may not be fully fetched.\n  activeItems (state, getters) {\n    return getters.activeIds.map(id => state.items[id]).filter(_ => _)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/getters.js","import Vue from 'vue';\nimport Vuex from 'vuex';\nimport actions from './actions';\nimport mutations from './mutations';\nimport getters from './getters';\n\nVue.use(Vuex);\n\nexport function createStore() {\n  return new Vuex.Store({\n    state: {\n      activeType: null,\n      itemsPerPage: 20,\n      items: {/* [id: number]: Item */},\n      users: {/* [id: string]: User */},\n      lists: {\n        top: [/* number */],\n        new: [],\n        show: [],\n        ask: [],\n        job: [],\n      },\n      recordParts: [],\n      recordProject: [],\n    },\n    actions,\n    mutations,\n    getters,\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/index.js","<template>\n<div id=\"app\">\n  <router-view/>\n</div>\n</template>\n\n<script>\nexport default {\n  name: 'app',\n};\n</script>\n\n<style>\n#app {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height:100%;\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-091aadf1\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","<template>\n  <div class=\"hello\">\n    <h1>{{ msg }}</h1>\n    <div class=\"input-section\">\n      <div class=\"sector\">\n        <h3>姓名: </h3>\n        <input type=\"text\" v-model=\"name\">\n      </div>\n      <div class=\"sector\">\n        <h3>公司: </h3>\n        <input type=\"text\" v-model=\"company\">\n      </div>\n      <div class=\"sector\">\n        <h3>职位: </h3>\n        <input type=\"text\" v-model=\"title\">\n      </div>\n      <div class=\"sector\">\n        <h3>电话: </h3>\n        <input type=\"num\" v-model=\"tel\">\n      </div>\n      <div class=\"sector\">\n        <h3>背景颜色: </h3>\n          <div class=\"\">  </div>\n          <div class=\"\">  </div>\n          <div class=\"\">  </div>\n          <div class=\"\">  </div>\n      </div>\n\n    </div>\n    <div class=\"b-card\">\n      <div class=\"name\">\n        {{name}}\n      </div>\n      <div class=\"company\">\n        {{company}}\n      </div>\n      <div class=\"title\">\n        {{title}}\n      </div>\n      <div class=\"tel\">\n        {{tel}}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'HelloWorld',\n  data() {\n    return {\n      msg: '名片制作',\n      name:'',\n      company:'',\n      title:'',\n      tel:'',\n    };\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style lang=\"scss\" scoped>\n* {margin:0;padding:0}\n.hello {\n  position: absolute;\n  width:100%;\n  height:100%;\n  .input-section {\n    width:10rem;\n    background-color:gray;\n    position:absolute;\n    display:flex;\n    flex-direction:column;\n    align-items:center;\n    justify-content:center;\n    h3 {font-size:.47rem;}\n    .sector {\n      display:flex;\n      h3 {padding-right:.4rem;}\n    }\n  }\n  .b-card {\n\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/HelloWorld.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"hello\"},[_c('h1',[_vm._v(_vm._s(_vm.msg))]),_vm._v(\" \"),_c('div',{staticClass:\"input-section\"},[_c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"姓名: \")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.name),expression:\"name\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.name=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"公司: \")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.company),expression:\"company\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.company)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.company=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"职位: \")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.title),expression:\"title\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.title)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.title=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"电话: \")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.tel),expression:\"tel\"}],attrs:{\"type\":\"num\"},domProps:{\"value\":(_vm.tel)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.tel=$event.target.value}}})]),_vm._v(\" \"),_vm._m(0,false,false)]),_vm._v(\" \"),_c('div',{staticClass:\"b-card\"},[_c('div',{staticClass:\"name\"},[_vm._v(\"\\n      \"+_vm._s(_vm.name)+\"\\n    \")]),_vm._v(\" \"),_c('div',{staticClass:\"company\"},[_vm._v(\"\\n      \"+_vm._s(_vm.company)+\"\\n    \")]),_vm._v(\" \"),_c('div',{staticClass:\"title\"},[_vm._v(\"\\n      \"+_vm._s(_vm.title)+\"\\n    \")]),_vm._v(\" \"),_c('div',{staticClass:\"tel\"},[_vm._v(\"\\n      \"+_vm._s(_vm.tel)+\"\\n    \")])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"sector\"},[_c('h3',[_vm._v(\"背景颜色: \")]),_vm._v(\" \"),_c('div',{}),_vm._v(\" \"),_c('div',{}),_vm._v(\" \"),_c('div',{}),_vm._v(\" \"),_c('div',{})])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-52bc8902\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/HelloWorld.vue\n// module id = null\n// module chunks = ","<script>\nwindow.Tone = require('tone')\nimport * as Util from '../_common/js/util'\nimport * as Api from '../_common/js/api'\nimport * as Cookies from \"js-cookie\"\nimport * as Magic from '../_common/js/magic'\n\nvar piano = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nvar mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nvar plucky = new Tone.PluckSynth().toMaster()\n// var part = new Tone.Part(function(time, value){\n// \t//the value is an object which contains both the note and the velocity\n// piano.triggerAttackRelease(value.note, \"8n\", time)\n// }, [{\"time\" : 1.9, \"note\" : \"C3\"},\n// \t   {\"time\" : 2, \"note\" : \"C4\"},\n//      {\"time\" : 3, \"note\" : \"C3\"},\n//      \t   {\"time\" : 4, \"note\" : \"C4\"}\n// ]).start(0)\n// Tone.Transport.start()\n\nwindow.recorder = [] //Tone.Part => schedule notes\n\nwindow.tonepart = [] // store all the music parts. (ummm,that's why it's named part...)\nlet bouncepart = []\nvar timeline = 0\nexport default {\n  data() {\n    return {\n      activeNote: {},\n      timerToStartRecord: 0,\n      recording: false,\n      replaying: false,\n    }\n  },\n  methods: {\n    load() {},\n    startRecord() {\n      this.timerToStartRecord = 3\n      let timer = setInterval(() => {\n        this.timerToStartRecord -= 1\n        if (this.timerToStartRecord == 0) {\n          clearInterval(timer)\n        }\n      }, 1000)\n    },\n    touchStartHandler: function(e) {\n      console.log('down', e.target.id)\n      piano.triggerAttack(e.target.id)\n      this.$set(this.activeNote, e.target.id, 1)\n      if (this.recording) {\n        recorder.push({\n          'note': e.target.id,\n          'time': +((performance.now() - timeline) / 1000).toFixed(4)\n        })\n      }\n    },\n    touchEndHandler: function(e) {\n      // console.log('up',e.target.id)\n      piano.triggerRelease(e.target.id)\n      // plucky.triggerRelease(e.target.id)\n      this.$set(this.activeNote, e.target.id, 0)\n    },\n    toggleRecord(e) {\n      this.recording = !this.recording\n      if (this.recording) {\n        //start recording\n        recorder = []\n        if (!this.replaying) {\n          this.timerToStartRecord = 3\n          let timer = setInterval(() => {\n            this.timerToStartRecord -= 1\n            if (this.timerToStartRecord == 0) {\n              clearInterval(timer)\n              timeline = performance.now()\n            }\n          }, 1000)\n\n          // timeline = performance.now()\n          // 1. e.timestamp behave not consistent\n          // 2. if currently playing, follow that timeline\n        }\n\n        try {\n          // tonepart.dispose()//此处必须dispose，否则会一直往part里面加\n        } catch (e) {\n          console.warn('tone cannot be disposed')\n        }\n      } else {\n        //stop recording\n        console.log('kikikiki')\n        if (recorder.length) {\n          tonepart[tonepart.length] = new Tone.Part(function(time, value) { //不能老这new啊，要每次一个数组，每次改动最后一个\n            piano.triggerAttackRelease(value.note, \"8n\", time)\n          }, recorder).start(0)\n        }\n      }\n    },\n    toggleReplay() {\n      console.log(1)\n      this.replaying = !this.replaying\n      if (this.replaying) {\n        console.log('kokokoko')\n        timeline = performance.now();\n        Tone.Transport.start(\"+0.01\") // in case < context.currentTime\n      } else {\n        Tone.Transport.stop(0) // TODO：必须stop才能start。。。有没有自动stop啊..\n      }\n    },\n    undoRecord() {\n      //TODO:可以改造为选择哪个进行删除\n      // tonepart[tonepart.length-1].dispose() //dispose是一个part被dispose\n      //TODO:若tonepart里只有一个，应让用户确认是否继续操作\n      // TODO: 如果tonepart里没东西，undo按钮应该grayout\n\n      tonepart.pop().dispose() //最后一个被dispose，同时要从数组中删掉\n      // Tone.Transport.clear(tonepart);\n    },\n    bounceProject() {\n      console.log(tonepart)\n      bouncepart = []\n      if (tonepart.length) {\n        tonepart.forEach(item => {\n          item._events.forEach(noteInfo => {\n            bouncepart.push(noteInfo.value)\n          })\n        })\n        while (tonepart.length) {\n          tonepart.pop().dispose() //最后一个被dispose，同时要从数组中删掉\n        }\n        tonepart[0] = new Tone.Part(function(time, value) { //不能老这new啊，要每次一个数组，每次改动最后一个\n          piano.triggerAttackRelease(value.note, \"8n\", time)\n        }, bouncepart).start(0)\n\n        bouncepart.sort((a, b) => (0 + a.time - b.time))\n        console.log(bouncepart)\n        Magic.generateJSCadCode(bouncepart)\n      } else {\n        alert('tm什么都没录')\n      }\n    },\n  },\n  created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    const inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase())\n\n    //test magic.js\n    // const work = [{note: \"E4\", time: 0.14585000000000037},\n    // {note: \"G4\", time: 1.0295},\n    // {note: \"G4\", time: 1.3985},\n    // {note: \"E4\", time: 2.6605300000000005},\n    // {note: \"D4\", time: 3.4207450000000006},\n    // {note: \"C4\", time: 4.196245000000001},\n    // {note: \"G4\", time: 2.671395000000004},\n    // {note: \"A4\", time: 3.35932},\n    // {note: \"B4\", time: 4.183044999999998}]\n    //\n    // Magic.generateJSCadCode(work)\n\n\n    if (!inWechat) return\n    if (Util.getUrlParam('code') || Cookies.get('serviceToken')) {\n      //TODO:ajax call to get info\n      Api.getUserInfo(Util.getUrlParam('code'))\n        .then((res) => {\n          if (res.data.errcode >= 20000) {\n            // 网页内cookie失效，需要重新验证\n            Cookies.remove('serviceToken')\n            location.replace(\n              'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n            )\n          }\n          alert(`welcome${res.data.data.realname}`)\n          console.log('get user info success', res.data.data)\n        })\n        .catch((err) => {\n          Cookies.remove('serviceToken')\n          location.replace(\n            'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n          )\n        })\n    } else { //又没有微信给的auth code又没有token存在cookie，只得验证\n      location.replace(\n        'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n      )\n    }\n  },\n  mounted() {\n    // this.startRecord();\n  },\n  updated() {}\n};\n</script>\n\n<template>\n<div id=\"app\">\n  <div :class=\"['mask', timerToStartRecord>1?'fadein':'fadeout', timerToStartRecord==0?'hide':'']\">\n    <p id=\"timer\" class=\"rotate\">{{timerToStartRecord}}</p>\n  </div>\n  <div class=\"container\">\n    <!-- all the kays -->\n    <div class=\"keys\" @touchstart.stop.prevent=\"touchStartHandler\" @touchend.stop.event=\"touchEndHandler\">\n      <!-- using sharp sign => '#' as object key cause syntax error... -->\n      <!-- <div :class=\"['white', 'a', activeNote.A3?'active-note':'']\" id=\"A3\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb3?'active-note':'']\" id=\"Bb3\"></div>\n      <div :class=\"['white', 'b', activeNote.B3?'active-note':'']\" id=\"B3\"></div> -->\n      <div :class=\"['white', 'c', activeNote.C4?'active-note':'']\" id=\"C4\"></div>\n      <div :class=\"['black', 'd-minor', activeNote.Db4?'active-note':'']\" id=\"Db4\"></div>\n      <div :class=\"['white', 'd', activeNote.D4?'active-note':'']\" id=\"D4\"></div>\n      <div :class=\"['black', 'e-minor', activeNote.Eb4?'active-note':'']\" id=\"Eb4\"></div>\n      <div :class=\"['white', 'e', activeNote.E4?'active-note':'']\" id=\"E4\"></div>\n      <div :class=\"['white', 'f', activeNote.F4?'active-note':'']\" id=\"F4\"></div>\n      <div :class=\"['black', 'f-sharp', activeNote.Gb4?'active-note':'']\" id=\"Gb4\"></div>\n      <div :class=\"['white', 'g', activeNote.G4?'active-note':'']\" id=\"G4\"></div>\n      <div :class=\"['black', 'a-minor', activeNote.Ab4?'active-note':'']\" id=\"Ab4\"></div>\n      <div :class=\"['white', 'a', activeNote.A4?'active-note':'']\" id=\"A4\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb4?'active-note':'']\" id=\"Bb4\"></div>\n      <div :class=\"['white', 'b', activeNote.B4?'active-note':'']\" id=\"B4\"></div>\n      <div :class=\"['white', 'c', activeNote.C5?'active-note':'']\" id=\"C5\"></div>\n      <div :class=\"['black', 'd-minor', activeNote.Db5?'active-note':'']\" id=\"Db5\"></div>\n      <div :class=\"['white', 'd', activeNote.D5?'active-note':'']\" id=\"D5\"></div>\n      <div :class=\"['black', 'e-minor', activeNote.Eb5?'active-note':'']\" id=\"Eb5\"></div>\n      <div :class=\"['white', 'e', activeNote.E5?'active-note':'']\" id=\"E5\"></div>\n      <div :class=\"['white', 'f', activeNote.F5?'active-note':'']\" id=\"F5\"></div>\n      <div :class=\"['black', 'f-sharp', activeNote.Gb5?'active-note':'']\" id=\"Gb5\"></div>\n      <div :class=\"['white', 'g', activeNote.G5?'active-note':'']\" id=\"G5\"></div>\n      <div :class=\"['black', 'a-minor', activeNote.Ab5?'active-note':'']\" id=\"Ab5\"></div>\n      <div :class=\"['white', 'a', activeNote.A5?'active-note':'']\" id=\"A5\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb5?'active-note':'']\" id=\"Bb5\"></div>\n      <div :class=\"['white', 'b', activeNote.B5?'active-note':'']\" id=\"B5\"></div>\n      <div :class=\"['white', 'c', activeNote.C6?'active-note':'']\" id=\"C6\"></div>\n    </div>\n    <!-- the controller panal -->\n    <div class=\"controller\">\n      <div class=\"funcBtn record\" :class=\"recording?'active':''\" @click=\"toggleRecord\">\n        <div class=\"recordHint\"></div>\n      </div>\n      <div class=\"funcBtn play\" :class=\"replaying?'active':''\" @click=\"toggleReplay\">\n        <div :class=\"['rotate',replaying?'playHint':'stopHint']\"></div>\n      </div>\n      <div class=\"funcBtn undo\" @click=\"undoRecord\">\n        <div class=\"undoHint rotate\"></div>\n      </div>\n      <div class=\"funcBtn bounce\" @click=\"bounceProject\">\n        <div class=\"bounceHint rotate\"></div>\n      </div>\n    </div>\n  </div>\n</div>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../_common/style/_functions.scss';\n@import '../_common/style/_variables.scss';\n@import '../_common/style/_mixins.scss';\n\nh2 {\n    font-size: 20px;\n    color: #2c3e50;\n}\n\n* {\n    user-select: none;\n    margin: 0;\n    padding: 0;\n}\n\n.container {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n}\n\n.keys {\n    /* position: absolute;  make whole keys appear */\n    /* height: 100%; */\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    justify-content: space-between;\n    float: left;\n    /* padding-right:getRem(347); */\n    box-sizing: border-box;\n}\n\n.controller {\n    background: linear-gradient(90deg, #434343 0%, #212121 100%);\n    width: getRem(350);\n    right: 0;\n    height: 100%;\n    position: fixed;\n    .funcBtn {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: getRem(100);\n        height: getRem(220);\n        border-radius: getRem(10);\n        box-sizing: border-box;\n        &.record {\n            background-color: #b70411;\n            .recordHint {\n                width: getRem(50);\n                height: getRem(50);\n                background-color: white;\n                border-radius: 50%;\n            }\n            &.active {\n                background-color: red;\n                border: 1px solid white;\n            }\n        }\n        &.play {\n            background-color: #098244;\n            .playHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/play.svg') center center;\n                background-size: cover;\n            }\n            .stopHint {\n                width: getRem(45);\n                height: getRem(45);\n                background-color: white;\n                border-radius: 10%;\n            }\n            &.active {\n                background-color: #0aca0a;\n                border: 1px solid white;\n            }\n        }\n        &.undo {\n            background-color: #a4af00;\n            .undoHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/undo.svg') center center;\n                background-size: cover;\n            }\n            &:active {\n                background-color: #e3f300;\n                // border: 1px solid white;\n            }\n        }\n        &.bounce {\n            background-color: black;\n            .bounceHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/bounce.svg') center center;\n                background-size: cover;\n            }\n            &.active {\n                background-color: green;\n                border: 1px solid white;\n            }\n        }\n    }\n}\n\n.progressBar {\n    position: fixed;\n    width: getRem(750);\n}\n\n/* piano keyboard layout css  */\n\n.white {\n    width: getRem(400);\n    height: getRem(100);\n    z-index: 1;\n    border-left: 1px solid #bbb;\n    border-bottom: 1px solid #bbb;\n    border-radius: 0 0 5px 5px;\n    box-shadow: -1px 0 0 rgba(255, 255, 255, 0.8) inset, 0 0 5px #ccc inset, 0 0 3px rgba(0, 0, 0, 0.2);\n    background: linear-gradient(top, #eee 0%, #fff 100%);\n    &.active-note {\n        box-shadow: 2px 0 3px rgba(0, 0, 0, 0.1) inset, -5px 5px 20px rgba(0, 0, 0, 0.2) inset, 0 0 3px rgba(0, 0, 0, 0.2);\n        background: linear-gradient(top, #fff 0%, #e9e9e9 100%);\n    }\n}\n\n.black {\n    position: relative;\n    width: getRem(200);\n    height: getRem(50);\n    margin-top: getRem(-25);\n    top: getRem(25);\n    z-index: 2;\n    border: 1px solid #000;\n    border-radius: 0 0 3px 3px;\n    box-shadow: -1px -1px 2px rgba(255, 255, 255, 0.2) inset, 0 -5px 2px 3px rgba(0, 0, 0, 0.6) inset, 0 2px 4px rgba(0, 0, 0, 0.5);\n    background: linear-gradient(45deg, #222 0%, #555 100%);\n    &.active-note {\n        box-shadow: -1px -1px 2px rgba(255, 255, 255, 0.2) inset, 0 -2px 2px 3px rgba(0, 0, 0, 0.6) inset, 0 1px 2px rgba(0, 0, 0, 0.5);\n        background: linear-gradient(left, #444 0%, #222 100%);\n    }\n}\n\n.a,\n.c,\n.d,\n.f,\n.g {\n    margin-bottom: getRem(-25);\n}\n\n/* mask layout */\n\n.mask {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 100;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.mask #timer {\n    color: white;\n    font-size: xx-large;\n    font-style: italic;\n}\n\n.fadein {\n    animation: fadein 1s;\n    animation-fill-mode: forwards;\n}\n\n.fadeout {\n    animation: fadeout 1s;\n    animation-fill-mode: forwards;\n}\n@keyframes fadein {\n    from {\n        opacity: 0;\n    }\n\n    to {\n        opacity: 1;\n    }\n}\n@keyframes fadeout {\n    from {\n        opacity: 1;\n    }\n\n    to {\n        opacity: 0;\n    }\n}\n\n.hide {\n    display: none;\n}\n\n.rotate {\n    transform: rotate(90deg);\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/MBMaker.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{class:['mask', _vm.timerToStartRecord>1?'fadein':'fadeout', _vm.timerToStartRecord==0?'hide':'']},[_c('p',{staticClass:\"rotate\",attrs:{\"id\":\"timer\"}},[_vm._v(_vm._s(_vm.timerToStartRecord))])]),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"keys\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.touchStartHandler($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.touchEndHandler($event)}}},[_c('div',{class:['white', 'c', _vm.activeNote.C4?'active-note':''],attrs:{\"id\":\"C4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db4?'active-note':''],attrs:{\"id\":\"Db4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D4?'active-note':''],attrs:{\"id\":\"D4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb4?'active-note':''],attrs:{\"id\":\"Eb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E4?'active-note':''],attrs:{\"id\":\"E4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F4?'active-note':''],attrs:{\"id\":\"F4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb4?'active-note':''],attrs:{\"id\":\"Gb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G4?'active-note':''],attrs:{\"id\":\"G4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab4?'active-note':''],attrs:{\"id\":\"Ab4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A4?'active-note':''],attrs:{\"id\":\"A4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb4?'active-note':''],attrs:{\"id\":\"Bb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B4?'active-note':''],attrs:{\"id\":\"B4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C5?'active-note':''],attrs:{\"id\":\"C5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db5?'active-note':''],attrs:{\"id\":\"Db5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D5?'active-note':''],attrs:{\"id\":\"D5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb5?'active-note':''],attrs:{\"id\":\"Eb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E5?'active-note':''],attrs:{\"id\":\"E5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F5?'active-note':''],attrs:{\"id\":\"F5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb5?'active-note':''],attrs:{\"id\":\"Gb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G5?'active-note':''],attrs:{\"id\":\"G5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab5?'active-note':''],attrs:{\"id\":\"Ab5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A5?'active-note':''],attrs:{\"id\":\"A5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb5?'active-note':''],attrs:{\"id\":\"Bb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B5?'active-note':''],attrs:{\"id\":\"B5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C6?'active-note':''],attrs:{\"id\":\"C6\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"controller\"},[_c('div',{staticClass:\"funcBtn record\",class:_vm.recording?'active':'',on:{\"click\":_vm.toggleRecord}},[_c('div',{staticClass:\"recordHint\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn play\",class:_vm.replaying?'active':'',on:{\"click\":_vm.toggleReplay}},[_c('div',{class:['rotate',_vm.replaying?'playHint':'stopHint']})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn undo\",on:{\"click\":_vm.undoRecord}},[_c('div',{staticClass:\"undoHint rotate\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn bounce\",on:{\"click\":_vm.bounceProject}},[_c('div',{staticClass:\"bounceHint rotate\"})])])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-94d961f8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MBMaker.vue\n// module id = null\n// module chunks = ","<script>\nwindow.Tone = require('tone')\nimport * as Util from '../_common/js/util'\nimport * as Api from '../_common/js/api'\nimport * as Cookies from \"js-cookie\"\nimport * as Magic from '../_common/js/magic'\n\nvar piano = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nvar mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nlet bouncepart = []\nvar timeline = 0\nexport default {\n  data() {\n    return {\n      userInfo: {},\n      timerToStartRecord: 0,\n      recording: false,\n      replaying: false,\n    }\n  },\n  methods: {\n    load() {},\n  },\n  created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    const inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase())\n\n    //test magic.js\n    // const work = [{note: \"E4\", time: 0.14585000000000037},\n    // {note: \"G4\", time: 1.0295},\n    // {note: \"G4\", time: 1.3985},\n    // {note: \"E4\", time: 2.6605300000000005},\n    // {note: \"D4\", time: 3.4207450000000006},\n    // {note: \"C4\", time: 4.196245000000001},\n    // {note: \"G4\", time: 2.671395000000004},\n    // {note: \"A4\", time: 3.35932},\n    // {note: \"B4\", time: 4.183044999999998}]\n    //\n    // Magic.generateJSCadCode(work)\n\n\n    if (!inWechat) return\n    wx.onMenuShareTimeline({\n      title:'test share',\n      link:'//m.baidu.com',\n      imgUrl:'',\n      success() {\n        alert('成功分享')\n      },\n      cancel() {\n        alert('取消分享')\n      }\n    })\n  },\n  mounted() {\n    // this.startRecord();\n  },\n  updated() {}\n};\n</script>\n\n<template>\n<div id=\"app\">\n  <div :class=\"['mask', timerToStartRecord>1?'fadein':'fadeout', timerToStartRecord==0?'hide':'']\">\n    <p id=\"timer\" class=\"rotate\">{{timerToStartRecord}}</p>\n  </div>\n  <div class=\"container\">\n    <!-- all the kays -->\n    <div class=\"keys\" @touchstart.stop.prevent=\"touchStartHandler\" @touchend.stop.event=\"touchEndHandler\">\n      <!-- using sharp sign => '#' as object key cause syntax error... -->\n      <!-- <div :class=\"['white', 'a', activeNote.A3?'active-note':'']\" id=\"A3\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb3?'active-note':'']\" id=\"Bb3\"></div>\n      <div :class=\"['white', 'b', activeNote.B3?'active-note':'']\" id=\"B3\"></div> -->\n      <div :class=\"['white', 'c', activeNote.C4?'active-note':'']\" id=\"C4\"></div>\n      <div :class=\"['black', 'd-minor', activeNote.Db4?'active-note':'']\" id=\"Db4\"></div>\n      <div :class=\"['white', 'd', activeNote.D4?'active-note':'']\" id=\"D4\"></div>\n      <div :class=\"['black', 'e-minor', activeNote.Eb4?'active-note':'']\" id=\"Eb4\"></div>\n      <div :class=\"['white', 'e', activeNote.E4?'active-note':'']\" id=\"E4\"></div>\n      <div :class=\"['white', 'f', activeNote.F4?'active-note':'']\" id=\"F4\"></div>\n      <div :class=\"['black', 'f-sharp', activeNote.Gb4?'active-note':'']\" id=\"Gb4\"></div>\n      <div :class=\"['white', 'g', activeNote.G4?'active-note':'']\" id=\"G4\"></div>\n      <div :class=\"['black', 'a-minor', activeNote.Ab4?'active-note':'']\" id=\"Ab4\"></div>\n      <div :class=\"['white', 'a', activeNote.A4?'active-note':'']\" id=\"A4\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb4?'active-note':'']\" id=\"Bb4\"></div>\n      <div :class=\"['white', 'b', activeNote.B4?'active-note':'']\" id=\"B4\"></div>\n      <div :class=\"['white', 'c', activeNote.C5?'active-note':'']\" id=\"C5\"></div>\n      <div :class=\"['black', 'd-minor', activeNote.Db5?'active-note':'']\" id=\"Db5\"></div>\n      <div :class=\"['white', 'd', activeNote.D5?'active-note':'']\" id=\"D5\"></div>\n      <div :class=\"['black', 'e-minor', activeNote.Eb5?'active-note':'']\" id=\"Eb5\"></div>\n      <div :class=\"['white', 'e', activeNote.E5?'active-note':'']\" id=\"E5\"></div>\n      <div :class=\"['white', 'f', activeNote.F5?'active-note':'']\" id=\"F5\"></div>\n      <div :class=\"['black', 'f-sharp', activeNote.Gb5?'active-note':'']\" id=\"Gb5\"></div>\n      <div :class=\"['white', 'g', activeNote.G5?'active-note':'']\" id=\"G5\"></div>\n      <div :class=\"['black', 'a-minor', activeNote.Ab5?'active-note':'']\" id=\"Ab5\"></div>\n      <div :class=\"['white', 'a', activeNote.A5?'active-note':'']\" id=\"A5\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb5?'active-note':'']\" id=\"Bb5\"></div>\n      <div :class=\"['white', 'b', activeNote.B5?'active-note':'']\" id=\"B5\"></div>\n      <div :class=\"['white', 'c', activeNote.C6?'active-note':'']\" id=\"C6\"></div>\n    </div>\n    <!-- the controller panal -->\n    <div class=\"controller\">\n      <div class=\"funcBtn record\" :class=\"recording?'active':''\" @click=\"toggleRecord\">\n        <div class=\"recordHint\"></div>\n      </div>\n      <div class=\"funcBtn play\" :class=\"replaying?'active':''\" @click=\"toggleReplay\">\n        <div :class=\"['rotate',replaying?'playHint':'stopHint']\"></div>\n      </div>\n      <div class=\"funcBtn undo\" @click=\"undoRecord\">\n        <div class=\"undoHint rotate\"></div>\n      </div>\n      <div class=\"funcBtn bounce\" @click=\"bounceProject\">\n        <div class=\"bounceHint rotate\"></div>\n      </div>\n    </div>\n  </div>\n</div>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../_common/style/_functions.scss';\n@import '../_common/style/_variables.scss';\n@import '../_common/style/_mixins.scss';\n\nh2 {\n    font-size: 20px;\n    color: #2c3e50;\n}\n\n* {\n    user-select: none;\n    margin: 0;\n    padding: 0;\n}\n\n.container {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n}\n\n.keys {\n    /* position: absolute;  make whole keys appear */\n    /* height: 100%; */\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    justify-content: space-between;\n    float: left;\n    /* padding-right:getRem(347); */\n    box-sizing: border-box;\n}\n\n.controller {\n    background: linear-gradient(90deg, #434343 0%, #212121 100%);\n    width: getRem(350);\n    right: 0;\n    height: 100%;\n    position: fixed;\n    .funcBtn {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: getRem(100);\n        height: getRem(220);\n        border-radius: getRem(10);\n        box-sizing: border-box;\n        &.record {\n            background-color: #b70411;\n            .recordHint {\n                width: getRem(50);\n                height: getRem(50);\n                background-color: white;\n                border-radius: 50%;\n            }\n            &.active {\n                background-color: red;\n                border: 1px solid white;\n            }\n        }\n        &.play {\n            background-color: #098244;\n            .playHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/play.svg') center center;\n                background-size: cover;\n            }\n            .stopHint {\n                width: getRem(45);\n                height: getRem(45);\n                background-color: white;\n                border-radius: 10%;\n            }\n            &.active {\n                background-color: #0aca0a;\n                border: 1px solid white;\n            }\n        }\n        &.undo {\n            background-color: #a4af00;\n            .undoHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/undo.svg') center center;\n                background-size: cover;\n            }\n            &:active {\n                background-color: #e3f300;\n                // border: 1px solid white;\n            }\n        }\n        &.bounce {\n            background-color: black;\n            .bounceHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/bounce.svg') center center;\n                background-size: cover;\n            }\n            &.active {\n                background-color: green;\n                border: 1px solid white;\n            }\n        }\n    }\n}\n\n.progressBar {\n    position: fixed;\n    width: getRem(750);\n}\n\n/* piano keyboard layout css  */\n\n.white {\n    width: getRem(400);\n    height: getRem(100);\n    z-index: 1;\n    border-left: 1px solid #bbb;\n    border-bottom: 1px solid #bbb;\n    border-radius: 0 0 5px 5px;\n    box-shadow: -1px 0 0 rgba(255, 255, 255, 0.8) inset, 0 0 5px #ccc inset, 0 0 3px rgba(0, 0, 0, 0.2);\n    background: linear-gradient(top, #eee 0%, #fff 100%);\n    &.active-note {\n        box-shadow: 2px 0 3px rgba(0, 0, 0, 0.1) inset, -5px 5px 20px rgba(0, 0, 0, 0.2) inset, 0 0 3px rgba(0, 0, 0, 0.2);\n        background: linear-gradient(top, #fff 0%, #e9e9e9 100%);\n    }\n}\n\n.black {\n    position: relative;\n    width: getRem(200);\n    height: getRem(50);\n    margin-top: getRem(-25);\n    top: getRem(25);\n    z-index: 2;\n    border: 1px solid #000;\n    border-radius: 0 0 3px 3px;\n    box-shadow: -1px -1px 2px rgba(255, 255, 255, 0.2) inset, 0 -5px 2px 3px rgba(0, 0, 0, 0.6) inset, 0 2px 4px rgba(0, 0, 0, 0.5);\n    background: linear-gradient(45deg, #222 0%, #555 100%);\n    &.active-note {\n        box-shadow: -1px -1px 2px rgba(255, 255, 255, 0.2) inset, 0 -2px 2px 3px rgba(0, 0, 0, 0.6) inset, 0 1px 2px rgba(0, 0, 0, 0.5);\n        background: linear-gradient(left, #444 0%, #222 100%);\n    }\n}\n\n.a,\n.c,\n.d,\n.f,\n.g {\n    margin-bottom: getRem(-25);\n}\n\n/* mask layout */\n\n.mask {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 100;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.mask #timer {\n    color: white;\n    font-size: xx-large;\n    font-style: italic;\n}\n\n.fadein {\n    animation: fadein 1s;\n    animation-fill-mode: forwards;\n}\n\n.fadeout {\n    animation: fadeout 1s;\n    animation-fill-mode: forwards;\n}\n@keyframes fadein {\n    from {\n        opacity: 0;\n    }\n\n    to {\n        opacity: 1;\n    }\n}\n@keyframes fadeout {\n    from {\n        opacity: 1;\n    }\n\n    to {\n        opacity: 0;\n    }\n}\n\n.hide {\n    display: none;\n}\n\n.rotate {\n    transform: rotate(90deg);\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/MBItem.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{class:['mask', _vm.timerToStartRecord>1?'fadein':'fadeout', _vm.timerToStartRecord==0?'hide':'']},[_c('p',{staticClass:\"rotate\",attrs:{\"id\":\"timer\"}},[_vm._v(_vm._s(_vm.timerToStartRecord))])]),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"keys\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.touchStartHandler($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.touchEndHandler($event)}}},[_c('div',{class:['white', 'c', _vm.activeNote.C4?'active-note':''],attrs:{\"id\":\"C4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db4?'active-note':''],attrs:{\"id\":\"Db4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D4?'active-note':''],attrs:{\"id\":\"D4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb4?'active-note':''],attrs:{\"id\":\"Eb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E4?'active-note':''],attrs:{\"id\":\"E4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F4?'active-note':''],attrs:{\"id\":\"F4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb4?'active-note':''],attrs:{\"id\":\"Gb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G4?'active-note':''],attrs:{\"id\":\"G4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab4?'active-note':''],attrs:{\"id\":\"Ab4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A4?'active-note':''],attrs:{\"id\":\"A4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb4?'active-note':''],attrs:{\"id\":\"Bb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B4?'active-note':''],attrs:{\"id\":\"B4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C5?'active-note':''],attrs:{\"id\":\"C5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db5?'active-note':''],attrs:{\"id\":\"Db5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D5?'active-note':''],attrs:{\"id\":\"D5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb5?'active-note':''],attrs:{\"id\":\"Eb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E5?'active-note':''],attrs:{\"id\":\"E5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F5?'active-note':''],attrs:{\"id\":\"F5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb5?'active-note':''],attrs:{\"id\":\"Gb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G5?'active-note':''],attrs:{\"id\":\"G5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab5?'active-note':''],attrs:{\"id\":\"Ab5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A5?'active-note':''],attrs:{\"id\":\"A5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb5?'active-note':''],attrs:{\"id\":\"Bb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B5?'active-note':''],attrs:{\"id\":\"B5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C6?'active-note':''],attrs:{\"id\":\"C6\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"controller\"},[_c('div',{staticClass:\"funcBtn record\",class:_vm.recording?'active':'',on:{\"click\":_vm.toggleRecord}},[_c('div',{staticClass:\"recordHint\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn play\",class:_vm.replaying?'active':'',on:{\"click\":_vm.toggleReplay}},[_c('div',{class:['rotate',_vm.replaying?'playHint':'stopHint']})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn undo\",on:{\"click\":_vm.undoRecord}},[_c('div',{staticClass:\"undoHint rotate\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn bounce\",on:{\"click\":_vm.bounceProject}},[_c('div',{staticClass:\"bounceHint rotate\"})])])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-15915e84\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MBItem.vue\n// module id = null\n// module chunks = ","<script>\nwindow.Tone = require('tone')\nimport * as Util from '../_common/js/util'\nimport * as Api from '../_common/js/api'\nimport * as Cookies from \"js-cookie\"\nimport * as Magic from '../_common/js/magic'\n\nvar piano = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nvar mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nvar plucky = new Tone.PluckSynth().toMaster()\n// var part = new Tone.Part(function(time, value){\n// \t//the value is an object which contains both the note and the velocity\n// piano.triggerAttackRelease(value.note, \"8n\", time)\n// }, [{\"time\" : 1.9, \"note\" : \"C3\"},\n// \t   {\"time\" : 2, \"note\" : \"C4\"},\n//      {\"time\" : 3, \"note\" : \"C3\"},\n//      \t   {\"time\" : 4, \"note\" : \"C4\"}\n// ]).start(0)\n// Tone.Transport.start()\n\nwindow.recorder = [] //Tone.Part => schedule notes\n\nwindow.tonepart = [] // store all the music parts. (ummm,that's why it's named part...)\nlet bouncepart = []\nvar timeline = 0\nexport default {\n  data() {\n    return {\n      activeNote: {},\n      timerToStartRecord: 0,\n      recording: false,\n      replaying: false,\n    }\n  },\n  methods: {\n    load() {},\n    startRecord() {\n      this.timerToStartRecord = 3\n      let timer = setInterval(() => {\n        this.timerToStartRecord -= 1\n        if (this.timerToStartRecord == 0) {\n          clearInterval(timer)\n        }\n      }, 1000)\n    },\n    touchStartHandler: function(e) {\n      console.log('down', e.target.id)\n      piano.triggerAttack(e.target.id)\n      this.$set(this.activeNote, e.target.id, 1)\n      if (this.recording) {\n        recorder.push({\n          'note': e.target.id,\n          'time': +((performance.now() - timeline) / 1000).toFixed(4)\n        })\n      }\n    },\n    touchEndHandler: function(e) {\n      // console.log('up',e.target.id)\n      piano.triggerRelease(e.target.id)\n      // plucky.triggerRelease(e.target.id)\n      this.$set(this.activeNote, e.target.id, 0)\n    },\n    toggleRecord(e) {\n      this.recording = !this.recording\n      if (this.recording) {\n        //start recording\n        recorder = []\n        if (!this.replaying) {\n          this.timerToStartRecord = 3\n          let timer = setInterval(() => {\n            this.timerToStartRecord -= 1\n            if (this.timerToStartRecord == 0) {\n              clearInterval(timer)\n              timeline = performance.now()\n            }\n          }, 1000)\n\n          // timeline = performance.now()\n          // 1. e.timestamp behave not consistent\n          // 2. if currently playing, follow that timeline\n        }\n\n        try {\n          // tonepart.dispose()//此处必须dispose，否则会一直往part里面加\n        } catch (e) {\n          console.warn('tone cannot be disposed')\n        }\n      } else {\n        //stop recording\n        console.log('kikikiki')\n        if (recorder.length) {\n          tonepart[tonepart.length] = new Tone.Part(function(time, value) { //不能老这new啊，要每次一个数组，每次改动最后一个\n            piano.triggerAttackRelease(value.note, \"8n\", time)\n          }, recorder).start(0)\n        }\n      }\n    },\n    toggleReplay() {\n      console.log(1)\n      this.replaying = !this.replaying\n      if (this.replaying) {\n        console.log('kokokoko')\n        timeline = performance.now();\n        Tone.Transport.start(\"+0.01\") // in case < context.currentTime\n      } else {\n        Tone.Transport.stop(0) // TODO：必须stop才能start。。。有没有自动stop啊..\n      }\n    },\n    undoRecord() {\n      //TODO:可以改造为选择哪个进行删除\n      // tonepart[tonepart.length-1].dispose() //dispose是一个part被dispose\n      //TODO:若tonepart里只有一个，应让用户确认是否继续操作\n      // TODO: 如果tonepart里没东西，undo按钮应该grayout\n\n      tonepart.pop().dispose() //最后一个被dispose，同时要从数组中删掉\n      // Tone.Transport.clear(tonepart);\n    },\n    bounceProject() {\n      console.log(tonepart)\n      bouncepart = []\n      if (tonepart.length) {\n        tonepart.forEach(item => {\n          item._events.forEach(noteInfo => {\n            bouncepart.push(noteInfo.value)\n          })\n        })\n        while (tonepart.length) {\n          tonepart.pop().dispose() //最后一个被dispose，同时要从数组中删掉\n        }\n        tonepart[0] = new Tone.Part(function(time, value) { //不能老这new啊，要每次一个数组，每次改动最后一个\n          piano.triggerAttackRelease(value.note, \"8n\", time)\n        }, bouncepart).start(0)\n\n        bouncepart.sort((a, b) => (0 + a.time - b.time))\n        console.log(bouncepart)\n        Magic.generateJSCadCode(bouncepart)\n      } else {\n        alert('tm什么都没录')\n      }\n    },\n  },\n  created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    const inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase())\n\n    //test magic.js\n    // const work = [{note: \"E4\", time: 0.14585000000000037},\n    // {note: \"G4\", time: 1.0295},\n    // {note: \"G4\", time: 1.3985},\n    // {note: \"E4\", time: 2.6605300000000005},\n    // {note: \"D4\", time: 3.4207450000000006},\n    // {note: \"C4\", time: 4.196245000000001},\n    // {note: \"G4\", time: 2.671395000000004},\n    // {note: \"A4\", time: 3.35932},\n    // {note: \"B4\", time: 4.183044999999998}]\n    //\n    // Magic.generateJSCadCode(work)\n\n\n    if (!inWechat) return\n    if (Util.getUrlParam('code') || Cookies.get('serviceToken')) {\n      //TODO:ajax call to get info\n      Api.getUserInfo(Util.getUrlParam('code'))\n        .then((res) => {\n          if (res.data.errcode >= 20000) {\n            // 网页内cookie失效，需要重新验证\n            Cookies.remove('serviceToken')\n            location.replace(\n              'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n            )\n          }\n          alert(`welcome${res.data.data.realname}`)\n          console.log('get user info success', res.data.data)\n        })\n        .catch((err) => {\n          Cookies.remove('serviceToken')\n          location.replace(\n            'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n          )\n        })\n    } else { //又没有微信给的auth code又没有token存在cookie，只得验证\n      location.replace(\n        'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n      )\n    }\n  },\n  mounted() {\n    // this.startRecord();\n  },\n  updated() {}\n};\n</script>\n\n<template>\n<div id=\"app\">\n  <div :class=\"['mask', timerToStartRecord>1?'fadein':'fadeout', timerToStartRecord==0?'hide':'']\">\n    <p id=\"timer\" class=\"rotate\">{{timerToStartRecord}}</p>\n  </div>\n  <div class=\"container\">\n    <!-- all the kays -->\n    <div class=\"keys\" @touchstart.stop.prevent=\"touchStartHandler\" @touchend.stop.event=\"touchEndHandler\">\n      <!-- using sharp sign => '#' as object key cause syntax error... -->\n      <!-- <div :class=\"['white', 'a', activeNote.A3?'active-note':'']\" id=\"A3\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb3?'active-note':'']\" id=\"Bb3\"></div>\n      <div :class=\"['white', 'b', activeNote.B3?'active-note':'']\" id=\"B3\"></div> -->\n      <div :class=\"['white', 'c', activeNote.C4?'active-note':'']\" id=\"C4\"></div>\n      <div :class=\"['black', 'd-minor', activeNote.Db4?'active-note':'']\" id=\"Db4\"></div>\n      <div :class=\"['white', 'd', activeNote.D4?'active-note':'']\" id=\"D4\"></div>\n      <div :class=\"['black', 'e-minor', activeNote.Eb4?'active-note':'']\" id=\"Eb4\"></div>\n      <div :class=\"['white', 'e', activeNote.E4?'active-note':'']\" id=\"E4\"></div>\n      <div :class=\"['white', 'f', activeNote.F4?'active-note':'']\" id=\"F4\"></div>\n      <div :class=\"['black', 'f-sharp', activeNote.Gb4?'active-note':'']\" id=\"Gb4\"></div>\n      <div :class=\"['white', 'g', activeNote.G4?'active-note':'']\" id=\"G4\"></div>\n      <div :class=\"['black', 'a-minor', activeNote.Ab4?'active-note':'']\" id=\"Ab4\"></div>\n      <div :class=\"['white', 'a', activeNote.A4?'active-note':'']\" id=\"A4\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb4?'active-note':'']\" id=\"Bb4\"></div>\n      <div :class=\"['white', 'b', activeNote.B4?'active-note':'']\" id=\"B4\"></div>\n      <div :class=\"['white', 'c', activeNote.C5?'active-note':'']\" id=\"C5\"></div>\n      <div :class=\"['black', 'd-minor', activeNote.Db5?'active-note':'']\" id=\"Db5\"></div>\n      <div :class=\"['white', 'd', activeNote.D5?'active-note':'']\" id=\"D5\"></div>\n      <div :class=\"['black', 'e-minor', activeNote.Eb5?'active-note':'']\" id=\"Eb5\"></div>\n      <div :class=\"['white', 'e', activeNote.E5?'active-note':'']\" id=\"E5\"></div>\n      <div :class=\"['white', 'f', activeNote.F5?'active-note':'']\" id=\"F5\"></div>\n      <div :class=\"['black', 'f-sharp', activeNote.Gb5?'active-note':'']\" id=\"Gb5\"></div>\n      <div :class=\"['white', 'g', activeNote.G5?'active-note':'']\" id=\"G5\"></div>\n      <div :class=\"['black', 'a-minor', activeNote.Ab5?'active-note':'']\" id=\"Ab5\"></div>\n      <div :class=\"['white', 'a', activeNote.A5?'active-note':'']\" id=\"A5\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb5?'active-note':'']\" id=\"Bb5\"></div>\n      <div :class=\"['white', 'b', activeNote.B5?'active-note':'']\" id=\"B5\"></div>\n      <div :class=\"['white', 'c', activeNote.C6?'active-note':'']\" id=\"C6\"></div>\n    </div>\n    <!-- the controller panal -->\n    <div class=\"controller\">\n      <div class=\"funcBtn record\" :class=\"recording?'active':''\" @click=\"toggleRecord\">\n        <div class=\"recordHint\"></div>\n      </div>\n      <div class=\"funcBtn play\" :class=\"replaying?'active':''\" @click=\"toggleReplay\">\n        <div :class=\"['rotate',replaying?'playHint':'stopHint']\"></div>\n      </div>\n      <div class=\"funcBtn undo\" @click=\"undoRecord\">\n        <div class=\"undoHint rotate\"></div>\n      </div>\n      <div class=\"funcBtn bounce\" @click=\"bounceProject\">\n        <div class=\"bounceHint rotate\"></div>\n      </div>\n    </div>\n  </div>\n</div>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../_common/style/_functions.scss';\n@import '../_common/style/_variables.scss';\n@import '../_common/style/_mixins.scss';\n\nh2 {\n    font-size: 20px;\n    color: #2c3e50;\n}\n\n* {\n    user-select: none;\n    margin: 0;\n    padding: 0;\n}\n\n.container {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n}\n\n.keys {\n    /* position: absolute;  make whole keys appear */\n    /* height: 100%; */\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    justify-content: space-between;\n    float: left;\n    /* padding-right:getRem(347); */\n    box-sizing: border-box;\n}\n\n.controller {\n    background: linear-gradient(90deg, #434343 0%, #212121 100%);\n    width: getRem(350);\n    right: 0;\n    height: 100%;\n    position: fixed;\n    .funcBtn {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: getRem(100);\n        height: getRem(220);\n        border-radius: getRem(10);\n        box-sizing: border-box;\n        &.record {\n            background-color: #b70411;\n            .recordHint {\n                width: getRem(50);\n                height: getRem(50);\n                background-color: white;\n                border-radius: 50%;\n            }\n            &.active {\n                background-color: red;\n                border: 1px solid white;\n            }\n        }\n        &.play {\n            background-color: #098244;\n            .playHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/play.svg') center center;\n                background-size: cover;\n            }\n            .stopHint {\n                width: getRem(45);\n                height: getRem(45);\n                background-color: white;\n                border-radius: 10%;\n            }\n            &.active {\n                background-color: #0aca0a;\n                border: 1px solid white;\n            }\n        }\n        &.undo {\n            background-color: #a4af00;\n            .undoHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/undo.svg') center center;\n                background-size: cover;\n            }\n            &:active {\n                background-color: #e3f300;\n                // border: 1px solid white;\n            }\n        }\n        &.bounce {\n            background-color: black;\n            .bounceHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/bounce.svg') center center;\n                background-size: cover;\n            }\n            &.active {\n                background-color: green;\n                border: 1px solid white;\n            }\n        }\n    }\n}\n\n.progressBar {\n    position: fixed;\n    width: getRem(750);\n}\n\n/* piano keyboard layout css  */\n\n.white {\n    width: getRem(400);\n    height: getRem(100);\n    z-index: 1;\n    border-left: 1px solid #bbb;\n    border-bottom: 1px solid #bbb;\n    border-radius: 0 0 5px 5px;\n    box-shadow: -1px 0 0 rgba(255, 255, 255, 0.8) inset, 0 0 5px #ccc inset, 0 0 3px rgba(0, 0, 0, 0.2);\n    background: linear-gradient(top, #eee 0%, #fff 100%);\n    &.active-note {\n        box-shadow: 2px 0 3px rgba(0, 0, 0, 0.1) inset, -5px 5px 20px rgba(0, 0, 0, 0.2) inset, 0 0 3px rgba(0, 0, 0, 0.2);\n        background: linear-gradient(top, #fff 0%, #e9e9e9 100%);\n    }\n}\n\n.black {\n    position: relative;\n    width: getRem(200);\n    height: getRem(50);\n    margin-top: getRem(-25);\n    top: getRem(25);\n    z-index: 2;\n    border: 1px solid #000;\n    border-radius: 0 0 3px 3px;\n    box-shadow: -1px -1px 2px rgba(255, 255, 255, 0.2) inset, 0 -5px 2px 3px rgba(0, 0, 0, 0.6) inset, 0 2px 4px rgba(0, 0, 0, 0.5);\n    background: linear-gradient(45deg, #222 0%, #555 100%);\n    &.active-note {\n        box-shadow: -1px -1px 2px rgba(255, 255, 255, 0.2) inset, 0 -2px 2px 3px rgba(0, 0, 0, 0.6) inset, 0 1px 2px rgba(0, 0, 0, 0.5);\n        background: linear-gradient(left, #444 0%, #222 100%);\n    }\n}\n\n.a,\n.c,\n.d,\n.f,\n.g {\n    margin-bottom: getRem(-25);\n}\n\n/* mask layout */\n\n.mask {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 100;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.mask #timer {\n    color: white;\n    font-size: xx-large;\n    font-style: italic;\n}\n\n.fadein {\n    animation: fadein 1s;\n    animation-fill-mode: forwards;\n}\n\n.fadeout {\n    animation: fadeout 1s;\n    animation-fill-mode: forwards;\n}\n@keyframes fadein {\n    from {\n        opacity: 0;\n    }\n\n    to {\n        opacity: 1;\n    }\n}\n@keyframes fadeout {\n    from {\n        opacity: 1;\n    }\n\n    to {\n        opacity: 0;\n    }\n}\n\n.hide {\n    display: none;\n}\n\n.rotate {\n    transform: rotate(90deg);\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/MBAuthor.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{class:['mask', _vm.timerToStartRecord>1?'fadein':'fadeout', _vm.timerToStartRecord==0?'hide':'']},[_c('p',{staticClass:\"rotate\",attrs:{\"id\":\"timer\"}},[_vm._v(_vm._s(_vm.timerToStartRecord))])]),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"keys\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.touchStartHandler($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.touchEndHandler($event)}}},[_c('div',{class:['white', 'c', _vm.activeNote.C4?'active-note':''],attrs:{\"id\":\"C4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db4?'active-note':''],attrs:{\"id\":\"Db4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D4?'active-note':''],attrs:{\"id\":\"D4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb4?'active-note':''],attrs:{\"id\":\"Eb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E4?'active-note':''],attrs:{\"id\":\"E4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F4?'active-note':''],attrs:{\"id\":\"F4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb4?'active-note':''],attrs:{\"id\":\"Gb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G4?'active-note':''],attrs:{\"id\":\"G4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab4?'active-note':''],attrs:{\"id\":\"Ab4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A4?'active-note':''],attrs:{\"id\":\"A4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb4?'active-note':''],attrs:{\"id\":\"Bb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B4?'active-note':''],attrs:{\"id\":\"B4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C5?'active-note':''],attrs:{\"id\":\"C5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db5?'active-note':''],attrs:{\"id\":\"Db5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D5?'active-note':''],attrs:{\"id\":\"D5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb5?'active-note':''],attrs:{\"id\":\"Eb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E5?'active-note':''],attrs:{\"id\":\"E5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F5?'active-note':''],attrs:{\"id\":\"F5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb5?'active-note':''],attrs:{\"id\":\"Gb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G5?'active-note':''],attrs:{\"id\":\"G5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab5?'active-note':''],attrs:{\"id\":\"Ab5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A5?'active-note':''],attrs:{\"id\":\"A5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb5?'active-note':''],attrs:{\"id\":\"Bb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B5?'active-note':''],attrs:{\"id\":\"B5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C6?'active-note':''],attrs:{\"id\":\"C6\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"controller\"},[_c('div',{staticClass:\"funcBtn record\",class:_vm.recording?'active':'',on:{\"click\":_vm.toggleRecord}},[_c('div',{staticClass:\"recordHint\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn play\",class:_vm.replaying?'active':'',on:{\"click\":_vm.toggleReplay}},[_c('div',{class:['rotate',_vm.replaying?'playHint':'stopHint']})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn undo\",on:{\"click\":_vm.undoRecord}},[_c('div',{staticClass:\"undoHint rotate\"})]),_vm._v(\" \"),_c('div',{staticClass:\"funcBtn bounce\",on:{\"click\":_vm.bounceProject}},[_c('div',{staticClass:\"bounceHint rotate\"})])])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-94d961f8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MBAuthor.vue\n// module id = null\n// module chunks = ","<script>\nwindow.Tone = require('tone')\nimport * as Util from '../_common/js/util'\nimport * as Api from '../_common/js/api'\nimport * as Cookies from \"js-cookie\"\nimport * as Magic from '../_common/js/magic'\nimport 'swiper/dist/css/swiper.css'\nimport vueSlider from 'vue-slider-component'\nimport {\n  swiper,\n  swiperSlide\n} from 'vue-awesome-swiper'\nconst touchIdKeyMap = {} //touch move can have several threads, each thread only activate one note at most\n// e.g. {0:a4,1:b5}\n\nconst MINI_KEY_LENGTH = 200 // px\nlet extendBtnsTimeout\n\nvar piano = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nvar mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nvar plucky = new Tone.PluckSynth().toMaster()\n\nconst SCREEN_WIDTH = document.documentElement.getBoundingClientRect().width\nconst SCREEN_HEIGHT = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n\nwindow.tonepart = [] // store all the music parts. (ummm,that's why it's named part...)\nlet bouncepart = []\n\nlet recordStartTime = 0\n\nlet isLinger = true //非播放状态中未开始录音\nvar replayInterval = undefined //控制progressbar的setinterval\nlet playOffset = 0 //播放状态的拉条bar初始时间记录\nlet lingerOffset = 0 //未播放状态的拉条bar初始时间记录\nconst PROGRESS_INTERVAL_TIME = 0.1 //0.1秒挪一下\nexport default {\n  components: {\n    swiper,\n    swiperSlide,\n    vueSlider,\n  },\n  data() {\n    return {\n      activeNote: {},\n      recordPart: [], //current record part\n      recordParts: [], //each new record goes in here.\n      playing: false,\n      generalControllerShow: false,\n      activeSwiperIndex: 3,\n      lastActiveSwiperIndex: 3 - 1,\n      vuetimeline: 0,\n      showExtendBtns: 0,\n      timelineConfig: {\n        value: 0,\n        width: 8,\n        height: '90%',\n        padding: '0',\n        dotSize: 20,\n        eventType: 'auto',\n        min: 0,\n        max: 200,\n        interval: 1,\n        disabled: false,\n        show: true,\n        tooltip: 'always',\n        // tooltip: 'hidden',\n        piecewise: false,\n        reverse: true,\n        style: {\n          display: 'inline-block',\n        },\n        class: 'star-slider',\n        direction: 'vertical',\n        speed: PROGRESS_INTERVAL_TIME,\n        bgStyle: {\n          backgroundColor: 'rgb(110,113,158)',\n          boxShadow: 'inset 0.5px 0.5px 3px 1px rgba(0,0,0,.36)'\n        },\n        tooltipStyle: {\n          backgroundColor: 'rgb(69, 106, 255)',\n          borderColor: 'rgb(69, 106, 255)',\n          // transform: 'rotate(90deg)',\n        },\n        formatter(value) {\n          if (value) {\n            return `${(value/10).toFixed(1)}s/20s`\n          } else {\n            return `0.0s/20s`\n          }\n        },\n        processStyle: {\n          backgroundColor: 'rgb(69,106,255)'\n        }\n      },\n    }\n  },\n  watch: {\n    playing: function(val) {\n      console.log('playing status', val)\n      if (val) {\n        //start progress bar\n        replayInterval = setInterval(() => {\n\n          this.vuetimeline += 1\n          if (this.vuetimeline >= 200) {\n            this.toggleReplay()\n            this.vuetimeline = 0\n\n          }\n        }, PROGRESS_INTERVAL_TIME * 1000)\n\n      } else {\n        //stop progress bar\n        clearInterval(replayInterval)\n      }\n    },\n  },\n  computed: {\n    swiper() {\n      return this.$refs.pianoRoll.swiper\n    },\n    activePartIndex() {\n      return this.PARTNUM - this.activeSwiperIndex - 1\n    },\n    lastActivePartIndex() {\n      return this.PARTNUM - this.lastActiveSwiperIndex - 1\n    }\n  },\n  methods: {\n    load() {},\n    toggleReplay() {\n      console.log(1)\n      this.playing = !this.playing\n      if (this.playing) {\n        if (this.vuetimeline >= 200) {\n          this.vuetimeline = 0\n        }\n        // this.confirmRecordPart(!isLinger)\n        playOffset = performance.now() - this.vuetimeline * 100\n        console.log('播放开始')\n        this.confirmRecordPart(0)\n        console.log('kokokoko')\n        recordStartTime = performance.now();\n        console.log(`activeOffsetTime${this.vuetimeline*100}`)\n        Tone.Transport.start(\"+0.01\", this.vuetimeline * 100 / 1000) // TODO:有问题in case < context.currentTime\n      } else {\n        console.log('播放停了')\n        Tone.Transport.stop(0) // TODO：必须stop才能start。。。有没有自动stop啊..\n        // recordStartTime = performance.now()\n      }\n    },\n    handleNoteStart(noteId) {\n      let noteTime = 0\n      // console.log('down', e.target.id)\n      piano.triggerAttack(noteId)\n      // console.log('midi no. :', Tone.Frequency(noteId).toMidi())\n      this.$set(this.activeNote, noteId, 1)\n      if (!this.playing) {\n        if (isLinger) {\n          recordStartTime = performance.now()\n          lingerOffset = this.vuetimeline * 100\n          isLinger = false\n        }\n        noteTime = performance.now() - recordStartTime + lingerOffset\n      } else {\n        noteTime = performance.now() - playOffset\n        // noteTime = this.vuetimeline * 100\n        // console.log('1', this.vuetimeline * 100)\n        // console.log('2', performance.now() - recordStartTime + this.vuetimeline*100)\n      }\n      if (noteTime < 20000) {\n        this.vuetimeline = 10 * noteTime / 1000\n        this.recordPart.push({\n          'note': noteId,\n          'time': +(noteTime / 1000).toFixed(4)\n        })\n      } else {\n        this.vuetimeline = 20 * 10 // 颗粒度是0.1s => 200份\n        console.log('cannot record more than 20 seconds')\n      }\n    },\n    handleNoteEnd(noteId) {\n      piano.triggerRelease(noteId)\n      this.$set(this.activeNote, noteId, 0)\n    },\n    touchNoteStartHandler(e) {\n      console.log(e)\n      //先存起来，防止在该键位touchmove重复\n      touchIdKeyMap[e.changedTouches[0].identifier] = e.target.id // TODO: 猜测 touchstart只会有一个changetouches///\n      this.handleNoteStart(e.target.id)\n    },\n    touchNoteEndHandler(e) {\n      this.handleNoteEnd(e.target.id)\n      this.handleNoteEnd(touchIdKeyMap[e.changedTouches[0].identifier])// TODO: 猜测 touchend只会有一个changetouches,记录的正好是该停的\n    },\n    confirmRecordPart(shouldClearTime) {\n      if (this.recordPart.length) {\n        console.log('processing track: ', this.lastActivePartIndex)\n        if (this.recordParts[this.lastActivePartIndex] && this.recordParts[this.lastActivePartIndex].length) {\n          //已在该track录过,merge both\n          this.recordPart = this.recordPart.concat(this.recordParts[this.lastActivePartIndex])\n        }\n        if (tonepart[this.lastActivePartIndex]) {\n          tonepart[this.lastActivePartIndex].dispose() //覆盖之前的需要dispose\n        }\n        tonepart[this.lastActivePartIndex] = new Tone.Part(function(time, value) { //不能老这new啊，要每次一个数组，每次改动最后一个\n          piano.triggerAttackRelease(value.note, \"8n\", time)\n        }, this.recordPart).start(0)\n        this.recordParts[this.lastActivePartIndex] = this.recordPart\n        this.recordPart = []\n      } else {\n        console.log('啥也没录')\n      }\n      this.lastActiveSwiperIndex = this.activeSwiperIndex\n      // reinit time\n      if (shouldClearTime) {\n        this.vuetimeline = 0 // this is kind of separate for progress view\n        recordStartTime = 0\n      }\n      isLinger = true\n    },\n    clearRecordPart(trackNum) {\n      console.log(`cleaning track ${trackNum}`)\n      if (this.activePartIndex === trackNum) {\n        this.recordPart = []\n      }\n      if (this.recordParts[trackNum] && this.recordParts[trackNum].length) {\n        this.$set(this.recordParts, trackNum, [])\n        tonepart[trackNum].dispose() //dispose掉\n        tonepart[trackNum] = undefined //同时要从数组中删掉\n      } else {\n        console.log(`track ${trackNum} has no content`)\n      }\n    },\n    bounceProject() {\n      alert('此步骤确认，需要微信支付')\n      this.confirmRecordPart(0)\n      console.log(this)\n      console.log(tonepart)\n      bouncepart = []\n      if (tonepart.length) {\n        tonepart.forEach(item => {\n          item._events.forEach(noteInfo => {\n            bouncepart.push(noteInfo.value)\n          })\n        })\n        bouncepart.sort((a, b) => (0 + a.time - b.time))\n        //TODO, semi done\n        this.$store.dispatch('BOUNCE_PROJECT', {\n          record: bouncepart,\n          info:{\n            title: 'default',\n            content: 'default',\n            cover: 'default'\n          },\n        }).then(() => {\n          console.log('successfully bounced')\n          alert('作品已为您存储')\n          // this.$router.push('/music-box-viewer')\n        })\n        while (tonepart.length) {\n          tonepart.pop().dispose() //最后一个被dispose，同时要从数组中删掉\n        }\n        tonepart[0] = new Tone.Part(function(time, value) {\n          piano.triggerAttackRelease(value.note, \"8n\", time)\n        }, bouncepart).start(0)\n        Magic.RealMagic(bouncepart)\n        // Magic.generateJSCadCode(bouncepart)\n      } else {\n        alert('tm什么都没录')\n      }\n    },\n    mapNoteTimeToColor(t) {\n      return Magic.mapNoteTimeToColor(t)\n    },\n    mapNoteMidiToLength(m) {\n      return Magic.mapNoteMidiToLength(m)\n    },\n    adjustTimeline(e) {\n      if (this.playing) {\n        console.log('ccccccccc')\n        this.toggleReplay() //现在播放中拉条，直接停，涉及到ref读不到最新值貌似，无法直接继续播放 this is TODO\n      } else {\n        isLinger = true //你拉条了肯定是\n      }\n    },\n    onMiniKeyboardScroll(e) {\n      console.log(e.touches[0].clientY)\n    },\n    onMiniKeyboardStart(e) {\n      console.log(e)\n    },\n    keng(e){\n\t\t\t// console.log(e)\n\t\t\t// console.log(document.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY).style.backgroundColor=\"yellow\")\n\t\t\tconsole.log(e) //e.touches is array like object\n\t\t\tfor (let i = 0; i<=e.changedTouches.length-1;i++) {\n\t\t\t\tconst a = document.elementFromPoint(e.changedTouches[i].clientX,e.changedTouches[i].clientY)\n\t\t\t\tif (a.classList.contains('white')||a.classList.contains('black')){\n\t\t\t\t\tif (touchIdKeyMap[e.changedTouches[i].identifier]&&touchIdKeyMap[e.changedTouches[i].identifier]!=a.getAttribute('id')) { //这个touch已经触发，且和当前不一致\n            console.log(touchIdKeyMap)\n            this.handleNoteStart(a.getAttribute('id'))\n            this.handleNoteEnd(touchIdKeyMap[e.changedTouches[i].identifier])\n            touchIdKeyMap[e.changedTouches[i].identifier] = a.getAttribute('id')\n\t\t\t\t\t} else if (!touchIdKeyMap[e.changedTouches[i].identifier]){\n            console.log(2)\n\t\t\t\t\t\tthis.handleNoteStart(a.getAttribute('id'))\n\t\t\t\t\t\ttouchIdKeyMap[e.changedTouches[i].identifier] = a.getAttribute('id')\n\t\t\t\t\t} else {\n            console.log(3)\n            //新旧相同什么都不做\n          }\n\t\t\t\t} else {\n          console.log('外边')\n\t\t\t\t\tif (touchIdKeyMap[e.changedTouches[i].identifier]) {\n            this.handleNoteEnd(touchIdKeyMap[e.changedTouches[i].identifier])\n          }\n\t\t\t\t\ttouchIdKeyMap[e.changedTouches[i].identifier] = undefined\n\t\t\t\t}\n\t\t\t}\n\t\t},\n    btnStart(e) {\n      console.log(e)\n      extendBtnsTimeout = setTimeout(()=>{\n        //show extend buttons\n        this.showExtendBtns = true;\n      },500)\n\n    },\n    btnEnd(e) {\n      // console.log(e)\n      clearTimeout(extendBtnsTimeout)\n      const a = document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY)\n      console.log(a)\n      if (a && a.classList.contains('bounceBtn')){\n        //导出\n        this.bounceProject()\n      } else if (a && (a.classList.contains('playBtn')||a.classList.contains('pauseBtn'))) {\n        //播放\n        this.toggleReplay()\n      }\n      this.showExtendBtns = false;\n      //hide extend buttons\n    }\n  },\n  created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    const self = this\n    // this is very important\n    var docElem = document.documentElement;\n    window.rem = docElem.getBoundingClientRect().width / 10;\n    docElem.style.fontSize = window.rem + 'px';\n    this.PARTNUM = 3\n    this.pianoRollSwiperOption = {\n      initialSlide: this.PARTNUM,\n      // centeredSlides: true,\n      slidesPerView: 3,\n      on: {\n        // slideChange(e){\n        //   console.log('1',e)\n        // },\n        // slideNextTransitionStart(e) {\n        //   console.log('2',e)\n        // },\n        transitionEnd: function(e) {\n          console.log('3', this.activeIndex) // THIS!!! within swiper...\n          self.activeSwiperIndex = this.activeIndex\n          self.confirmRecordPart(!isLinger)\n        }\n      }\n    }\n    const inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase())\n    if (!inWechat) return\n    if (Util.getUrlParam('code') || Cookies.get('serviceToken')) {\n      //TODO:ajax call to get info\n      Api.getUserInfo(Util.getUrlParam('code'))\n        .then((res) => {\n          if (res.data.errcode >= 20000) {\n            // 网页内cookie失效，需要重新验证\n            Cookies.remove('serviceToken')\n            location.replace(\n              // will publish to node project m-musixise, under '/music-box' path\n              'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect'\n            )\n          }\n          alert(`welcome${res.data.data.realname}`)\n          console.log('get user info success', res.data.data)\n        })\n        .catch((err) => {\n          Cookies.remove('serviceToken')\n          location.replace(\n            'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect'\n          )\n        })\n    } else { //又没有微信给的auth code又没有token存在cookie，只得验证\n      location.replace(\n        'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect'\n      )\n    }\n  },\n  mounted() {\n    // this.startRecord();\n    // document.querySelector('#D5').addEventListener( \"pointerenter\", ()=>{\n    //   console.log('jinru')\n    // })\n\n  },\n  updated() {\n\n  }\n};\n</script>\n\n<template>\n<div id=\"container\">\n  <!-- <v-touch @pan=\"onPan\"> -->\n  <div class=\"keys\" @touchmove=\"keng\" @touchstart.stop.prevent=\"touchNoteStartHandler\" @touchend.stop.event=\"touchNoteEndHandler\">\n    <!-- using sharp sign => '#' as object key cause syntax error... -->\n    <!-- <div :class=\"['white', 'a', activeNote.A3?'active-note':'']\" id=\"A3\"></div>\n      <div :class=\"['black', 'b-minor', activeNote.Bb3?'active-note':'']\" id=\"Bb3\"></div>\n      <div :class=\"['white', 'b', activeNote.B3?'active-note':'']\" id=\"B3\"></div> -->\n    <div :class=\"['white', 'c', activeNote.C4?'active-note':'']\" id=\"C4\"></div>\n    <div :class=\"['black', 'd-minor', activeNote.Db4?'active-note':'']\" id=\"Db4\"></div>\n    <div :class=\"['white', 'd', activeNote.D4?'active-note':'']\" id=\"D4\"></div>\n    <div :class=\"['black', 'e-minor', activeNote.Eb4?'active-note':'']\" id=\"Eb4\"></div>\n    <div :class=\"['white', 'e', activeNote.E4?'active-note':'']\" id=\"E4\"></div>\n    <div :class=\"['white', 'f', activeNote.F4?'active-note':'']\" id=\"F4\"></div>\n    <div :class=\"['black', 'f-sharp', activeNote.Gb4?'active-note':'']\" id=\"Gb4\"></div>\n    <div :class=\"['white', 'g', activeNote.G4?'active-note':'']\" id=\"G4\"></div>\n    <div :class=\"['black', 'a-minor', activeNote.Ab4?'active-note':'']\" id=\"Ab4\"></div>\n    <div :class=\"['white', 'a', activeNote.A4?'active-note':'']\" id=\"A4\"></div>\n    <div :class=\"['black', 'b-minor', activeNote.Bb4?'active-note':'']\" id=\"Bb4\"></div>\n    <div :class=\"['white', 'b', activeNote.B4?'active-note':'']\" id=\"B4\"></div>\n    <div :class=\"['white', 'c', activeNote.C5?'active-note':'']\" id=\"C5\"></div>\n    <div :class=\"['black', 'd-minor', activeNote.Db5?'active-note':'']\" id=\"Db5\"></div>\n    <div :class=\"['white', 'd', activeNote.D5?'active-note':'']\" id=\"D5\"></div>\n    <div :class=\"['black', 'e-minor', activeNote.Eb5?'active-note':'']\" id=\"Eb5\"></div>\n    <div :class=\"['white', 'e', activeNote.E5?'active-note':'']\" id=\"E5\"></div>\n    <div :class=\"['white', 'f', activeNote.F5?'active-note':'']\" id=\"F5\"></div>\n    <div :class=\"['black', 'f-sharp', activeNote.Gb5?'active-note':'']\" id=\"Gb5\"></div>\n    <div :class=\"['white', 'g', activeNote.G5?'active-note':'']\" id=\"G5\"></div>\n    <div :class=\"['black', 'a-minor', activeNote.Ab5?'active-note':'']\" id=\"Ab5\"></div>\n    <div :class=\"['white', 'a', activeNote.A5?'active-note':'']\" id=\"A5\"></div>\n    <div :class=\"['black', 'b-minor', activeNote.Bb5?'active-note':'']\" id=\"Bb5\"></div>\n    <div :class=\"['white', 'b', activeNote.B5?'active-note':'']\" id=\"B5\"></div>\n    <div :class=\"['white', 'c', activeNote.C6?'active-note':'']\" id=\"C6\"></div>\n    <div :class=\"['black', 'd-minor', activeNote.Db6?'active-note':'']\" id=\"Db6\"></div>\n    <div :class=\"['white', 'd', activeNote.D6?'active-note':'']\" id=\"D6\"></div>\n    <div :class=\"['black', 'e-minor', activeNote.Eb6?'active-note':'']\" id=\"Eb6\"></div>\n    <div :class=\"['white', 'e', activeNote.E6?'active-note':'']\" id=\"E6\"></div>\n    <div :class=\"['white', 'f', activeNote.F6?'active-note':'']\" id=\"F6\"></div>\n  </div>\n  <!-- <div class=\"scroll-container\">\n    <div class=\"mini-keyboard\" @touchmove=\"onMiniKeyboardScroll\">\n    </div>\n  </div> -->\n  <div class=\"semi-piano-roll\" @touchmove.stop.prevent>\n    <swiper :options=\"pianoRollSwiperOption\" ref=\"pianoRoll\">\n      <!-- slides -->\n      <swiper-slide v-for=\"n in PARTNUM\">\n        <div class=\"current-piano-roll\">\n          <svg :style=\"{height:'90%',padding:timelineConfig.dotSize/2+'px 0'}\">\n\n            <defs>\n              <!-- <filter id=\"glowing\" x=\"0\" y=\"0\" width=\"200%\" height=\"200%\">\n                <feOffset result=\"offOut\" in=\"SourceGraphic\" dx=\"0\" dy=\"0\" />\n                <feGaussianBlur result=\"blurOut\" in=\"offOut\" stdDeviation=\"2\" />\n                <feBlend in=\"SourceGraphic\" in2=\"blurOut\" mode=\"normal\" />\n              </filter> -->\n              <filter id=\"glowing\">\n                  <feGaussianBlur stdDeviation=\"1\" result=\"coloredBlur\"/>\n                  <feMerge>\n                      <feMergeNode in=\"coloredBlur\"/>\n                      <feMergeNode in=\"SourceGraphic\"/>\n                  </feMerge>\n              </filter>\n              <!-- <filter id=\"glowing\">\n                <feGaussianBlur id=\"blur\" in=\"SourceAlpha\" stdDeviation=\"1.5\"/>\n                <feColorMatrix id=\"recolor\"  type=\"matrix\" values=\"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0\" result=\"white-glow\"/>\n                <feMerge>\n                  <feMergeNode in=\"white-glow\"/>\n                  <feMergeNode in=\"SourceGraphic\"/>\n                </feMerge>\n              </filter> -->\n            </defs>\n            <rect v-if=\"activePartIndex===(PARTNUM-n)\" v-for=\"(item,index) in recordPart\"\n              :x=\"2\"\n              :y=\"100*item.time/20 + '%'\"\n              :width=\"mapNoteMidiToLength(item.note)\"\n              height=\"3\"\n              rx=\"2\"\n              ry=\"2\"\n              :fill=\"mapNoteTimeToColor(item.time)\"\n              filter=\"url(#glowing)\" />\n            <rect v-for=\"(item,index) in recordParts[PARTNUM-n]\"\n              :x=\"2\"\n              :y=\"100*item.time/20 + '%'\"\n              :width=\"mapNoteMidiToLength(item.note)\"\n              height=\"3\"\n              rx=\"2\"\n              ry=\"2\"\n              :fill=\"activePartIndex===(PARTNUM-n)?mapNoteTimeToColor(item.time):'rgb(120,120,120)'\"\n              :filter=\"activePartIndex===(PARTNUM-n)?'url(#glowing)':''\" />\n          </svg>\n          <div class=\"temp\" @click=\"clearRecordPart(PARTNUM-n)\"></div>\n        </div>\n      </swiper-slide>\n      <!-- need the bottom two empty slides to fill whole swiper -->\n      <swiper-slide></swiper-slide>\n      <swiper-slide></swiper-slide>\n    </swiper>\n  </div>\n\n  <div class=\"g-controller\">\n    <!-- <div class=\"timeline\">\n      <div class=\"progress\">\n\n      </div>\n      <div class=\"indicator\">\n\n      </div>\n    </div> -->\n    <vue-slider v-model=\"vuetimeline\" v-bind=\"timelineConfig\" @callback=\"adjustTimeline\" @drag-end=\"\"></vue-slider>\n    <div class=\"btnContainer\" @touchstart.stop.prevent=\"btnStart\" @touchend.stop.event=\"btnEnd\">\n      <div :class=\"[playing?'pauseBtn':'playBtn', 'rotate']\" @click=\"toggleReplay\">\n\n      </div>\n      <div :class=\"[showExtendBtns?'extendBtnsShow':'extendBtnsHide','extendBtns']\">\n        <div class='bounceBtn rotate'>\n\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- </v-touch> -->\n</div>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../_common/style/_functions.scss';\n@import '../_common/style/_variables.scss';\n@import '../_common/style/_mixins.scss';\n@import '../_common/style/_reboot.scss';\n.g-controller {\n    position: fixed;\n    width: getRem(42);\n    height: 100%;\n    padding-top: getRem(44);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    right: 0.5rem;\n    .timeline {\n        height: 90%;\n        width: getRem(16);\n        background-color: rgb(110,113,158);\n        .progress {\n            height: 5%;\n            background-color: rgb(69,106,255);\n        }\n        .indicator {\n            position: relative;\n            width: getRem(42);\n            height: getRem(42);\n            border-radius: getRem(21);\n            border: 4px;\n            border-color: yellow;\n            background-color: #fff;\n            right: getRem(13);\n        }\n    }\n    .btnContainer {\n      position: relative;\n      width: getRem(84);\n      height: getRem(84);\n      margin-top: 0.3rem;\n      .playBtn {\n        position: absolute;\n        width:100%;\n        height:100%;\n        border-radius: getRem(42);\n        background: url('../assets/play.svg') center center no-repeat;\n        background-size: getRem(32);\n        background-color: rgb(69,106,255);\n      }\n      .pauseBtn {\n        position:absolute;\n        width:100%;\n        height:100%;\n        border-radius: getRem(42);\n        background: url('../assets/pause.svg') center center no-repeat;\n        background-size: getRem(32);\n        background-color: rgb(69,106,255);\n      }\n      .bounceBtn {\n        position:absolute;\n        width: getRem(84);\n        height: getRem(84);\n        border-radius: getRem(42);\n        background: url('../assets/check.svg') center center no-repeat;\n        background-size: getRem(32);\n      }\n      .extendBtns {\n        // this element is within rotate, everything is opposite\n        position: absolute;\n        height:getRem(84);\n        border-radius: getRem(42);\n\n        right: 0;\n        z-index:-1;\n        transition: width 2s;\n        background: linear-gradient(to right, rgb(255,61,61),rgb(0,189,255),rgb(69,106,255) 80%);\n      }\n      .extendBtnsShow {\n        width:getRem(300);\n      }\n      .extendBtnsHide {\n        width:getRem(84);\n      }\n    }\n}\n.scroll-container {\n    display:flex;\n    justify-content:center;\n    align-items: center;\n    position: fixed;\n    background-color: yellow;\n    width: getRem(138);\n    height: 100%;\n    left: getRem(328);\n    .mini-keyboard {\n      width:getRem(80);\n      height:200px;\n      background-color:pink;\n    }\n}\n.temp {\n    width: 0.7rem;\n    height: 0.7rem;\n    border-radius: 0.35rem;\n    margin: 0.5rem 0 0;\n    background: url('../assets/delete.svg') center center no-repeat;\n    background-size: getRem(32);\n    background-color: #8e7aef;\n}\n\n#container {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    background-color:seagreen;\n}\nh2 {\n    font-size: 20px;\n    color: #2c3e50;\n}\n\n* {\n    user-select: none;\n    margin: 0;\n    padding: 0;\n}\n\n.container {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n}\n\n.keys {\n    // position: absolute;  //make whole keys appear\n    height: 100%;\n    position: fixed;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    justify-content: space-between;\n    float: left;\n    /* padding-right:getRem(347); */\n    box-sizing: border-box;\n}\n.scroll-container {}\n.semi-piano-roll {\n    top: 0;\n    width: getRem(334);\n    position: fixed;\n    right: 0;\n    height: 100%;\n    background-color: rgb(19,19,21);\n    .swiper-container {\n        height: 100%;\n    }\n    .current-piano-roll {\n        display: flex;\n        flex-direction: column;\n        height: 100%;\n        padding-top: getRem(44);\n        padding-left: getRem(18);\n        svg {\n            bottom: getRem(92);\n            height: 100%;\n            width: 100%;\n        }\n    }\n}\n\n.general-controller {\n    display: flex;\n    width: 2.5rem;\n    position: fixed;\n    right: 0;\n    height: 100%;\n    background: linear-gradient(90deg, rgba(40,40,40,.5) 0%, rgba(40,40,40,.8) 100%);\n    .funcBtn {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: getRem(100);\n        height: getRem(220);\n        border-radius: getRem(10);\n        box-sizing: border-box;\n        &.record {\n            background-color: #b70411;\n            .recordHint {\n                width: getRem(50);\n                height: getRem(50);\n                background-color: white;\n                border-radius: 50%;\n            }\n            &.active {\n                background-color: red;\n                border: 1px solid white;\n            }\n        }\n        &.play {\n            background-color: #098244;\n            .playHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/play.svg') center center;\n                background-size: cover;\n            }\n            .stopHint {\n                width: getRem(45);\n                height: getRem(45);\n                background-color: white;\n                border-radius: 10%;\n            }\n            &.active {\n                background-color: #0aca0a;\n                border: 1px solid white;\n            }\n        }\n        &.undo {\n            background-color: #a4af00;\n            .undoHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/undo.svg') center center;\n                background-size: cover;\n            }\n            &:active {\n                background-color: #e3f300;\n                // border: 1px solid white;\n            }\n        }\n        &.bounce {\n            background-color: black;\n            .bounceHint {\n                width: getRem(50);\n                height: getRem(50);\n                background: url('../assets/bounce.svg') center center;\n                background-size: cover;\n            }\n            &.active {\n                background-color: green;\n                border: 1px solid white;\n            }\n        }\n    }\n}\n.general-controller-enter-active,\n.general-controller-leave-active {\n    transition: all 0.5s ease;\n}\n.general-controller-enter,\n.general-controller-leave-to {\n    transform: translateX(3.5rem);\n}\n\n.progressBar {\n    position: fixed;\n    width: getRem(750);\n}\n\n/* piano keyboard layout css  */\n\n.white {\n    width: getRem(358);\n    height: getRem(92);\n    z-index: 1;\n    border-left: 1px solid #bbb;\n    border-bottom: 1px solid #bbb;\n    border-radius: 0 0 5px 5px;\n    box-shadow: -1px 0 0 rgba(80, 80, 80, 0.8) inset, 0 0 5px #ccc inset, 0 0 3px rgba(0, 0, 0, 0.2);\n    background: linear-gradient(to left, #666 0%, #eee 30%, #fff 100%);\n    &.active-note {\n        box-shadow: 2px 0 3px rgba(0, 0, 0, 0.1) inset, -5px 5px 20px rgba(0, 0, 0, 0.2) inset, 0 0 3px rgba(0, 0, 0, 0.2);\n        background: linear-gradient(to left, #555 0%, #ddd 40%, #eee 100%);\n    }\n}\n\n.black {\n    position: relative;\n    width: getRem(200);\n    height: getRem(54);\n    margin-top: getRem(-27);\n    top: getRem(27);\n    z-index: 2;\n    border: 1px solid #000;\n    border-radius: 0 0 3px 3px;\n    box-shadow: -1px -1px 2px rgba(255, 255, 255, 0.2) inset, 0 -5px 2px 3px rgba(0, 0, 0, 0.6) inset, 0 2px 4px rgba(0, 0, 0, 0.5);\n    background: linear-gradient(45deg, #222 0%, #555 100%);\n    &.active-note {\n        box-shadow: -1px -1px 2px rgba(255, 255, 255, 0.2) inset, 0 -2px 2px 3px rgba(0, 0, 0, 0.6) inset, 0 1px 2px rgba(0, 0, 0, 0.5);\n        background: linear-gradient(to right, #444 0%, #222 100%);\n    }\n}\n\n.a,\n.c,\n.d,\n.f,\n.g {\n    margin-bottom: getRem(-25);\n}\n\n/* mask layout */\n\n.mask {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 100;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.mask #timer {\n    color: white;\n    font-size: xx-large;\n    font-style: italic;\n}\n\n.fadein {\n    animation: fadein 1s;\n    animation-fill-mode: forwards;\n}\n\n.fadeout {\n    animation: fadeout 1s;\n    animation-fill-mode: forwards;\n}\n@keyframes fadein {\n    from {\n        opacity: 0;\n    }\n\n    to {\n        opacity: 1;\n    }\n}\n@keyframes fadeout {\n    from {\n        opacity: 1;\n    }\n\n    to {\n        opacity: 0;\n    }\n}\n\n.hide {\n    display: none;\n}\n\n.rotate {\n    transform: rotate(90deg);\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/NMBMaker.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"container\"}},[_c('div',{staticClass:\"keys\",on:{\"touchmove\":_vm.keng,\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.touchNoteStartHandler($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.touchNoteEndHandler($event)}}},[_c('div',{class:['white', 'c', _vm.activeNote.C4?'active-note':''],attrs:{\"id\":\"C4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db4?'active-note':''],attrs:{\"id\":\"Db4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D4?'active-note':''],attrs:{\"id\":\"D4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb4?'active-note':''],attrs:{\"id\":\"Eb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E4?'active-note':''],attrs:{\"id\":\"E4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F4?'active-note':''],attrs:{\"id\":\"F4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb4?'active-note':''],attrs:{\"id\":\"Gb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G4?'active-note':''],attrs:{\"id\":\"G4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab4?'active-note':''],attrs:{\"id\":\"Ab4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A4?'active-note':''],attrs:{\"id\":\"A4\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb4?'active-note':''],attrs:{\"id\":\"Bb4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B4?'active-note':''],attrs:{\"id\":\"B4\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C5?'active-note':''],attrs:{\"id\":\"C5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db5?'active-note':''],attrs:{\"id\":\"Db5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D5?'active-note':''],attrs:{\"id\":\"D5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb5?'active-note':''],attrs:{\"id\":\"Eb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E5?'active-note':''],attrs:{\"id\":\"E5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F5?'active-note':''],attrs:{\"id\":\"F5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'f-sharp', _vm.activeNote.Gb5?'active-note':''],attrs:{\"id\":\"Gb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'g', _vm.activeNote.G5?'active-note':''],attrs:{\"id\":\"G5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'a-minor', _vm.activeNote.Ab5?'active-note':''],attrs:{\"id\":\"Ab5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'a', _vm.activeNote.A5?'active-note':''],attrs:{\"id\":\"A5\"}}),_vm._v(\" \"),_c('div',{class:['black', 'b-minor', _vm.activeNote.Bb5?'active-note':''],attrs:{\"id\":\"Bb5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'b', _vm.activeNote.B5?'active-note':''],attrs:{\"id\":\"B5\"}}),_vm._v(\" \"),_c('div',{class:['white', 'c', _vm.activeNote.C6?'active-note':''],attrs:{\"id\":\"C6\"}}),_vm._v(\" \"),_c('div',{class:['black', 'd-minor', _vm.activeNote.Db6?'active-note':''],attrs:{\"id\":\"Db6\"}}),_vm._v(\" \"),_c('div',{class:['white', 'd', _vm.activeNote.D6?'active-note':''],attrs:{\"id\":\"D6\"}}),_vm._v(\" \"),_c('div',{class:['black', 'e-minor', _vm.activeNote.Eb6?'active-note':''],attrs:{\"id\":\"Eb6\"}}),_vm._v(\" \"),_c('div',{class:['white', 'e', _vm.activeNote.E6?'active-note':''],attrs:{\"id\":\"E6\"}}),_vm._v(\" \"),_c('div',{class:['white', 'f', _vm.activeNote.F6?'active-note':''],attrs:{\"id\":\"F6\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"semi-piano-roll\",on:{\"touchmove\":function($event){$event.stopPropagation();$event.preventDefault();}}},[_c('swiper',{ref:\"pianoRoll\",attrs:{\"options\":_vm.pianoRollSwiperOption}},[_vm._l((_vm.PARTNUM),function(n){return _c('swiper-slide',[_c('div',{staticClass:\"current-piano-roll\"},[_c('svg',{style:({height:'90%',padding:_vm.timelineConfig.dotSize/2+'px 0'})},[_c('defs',[_c('filter',{attrs:{\"id\":\"glowing\"}},[_c('feGaussianBlur',{attrs:{\"stdDeviation\":\"1\",\"result\":\"coloredBlur\"}}),_vm._v(\" \"),_c('feMerge',[_c('feMergeNode',{attrs:{\"in\":\"coloredBlur\"}}),_vm._v(\" \"),_c('feMergeNode',{attrs:{\"in\":\"SourceGraphic\"}})],1)],1)]),_vm._v(\" \"),_vm._l((_vm.recordPart),function(item,index){return (_vm.activePartIndex===(_vm.PARTNUM-n))?_c('rect',{attrs:{\"x\":2,\"y\":100*item.time/20 + '%',\"width\":_vm.mapNoteMidiToLength(item.note),\"height\":\"3\",\"rx\":\"2\",\"ry\":\"2\",\"fill\":_vm.mapNoteTimeToColor(item.time),\"filter\":\"url(#glowing)\"}}):_vm._e()}),_vm._v(\" \"),_vm._l((_vm.recordParts[_vm.PARTNUM-n]),function(item,index){return _c('rect',{attrs:{\"x\":2,\"y\":100*item.time/20 + '%',\"width\":_vm.mapNoteMidiToLength(item.note),\"height\":\"3\",\"rx\":\"2\",\"ry\":\"2\",\"fill\":_vm.activePartIndex===(_vm.PARTNUM-n)?_vm.mapNoteTimeToColor(item.time):'rgb(120,120,120)',\"filter\":_vm.activePartIndex===(_vm.PARTNUM-n)?'url(#glowing)':''}})})],2),_vm._v(\" \"),_c('div',{staticClass:\"temp\",on:{\"click\":function($event){_vm.clearRecordPart(_vm.PARTNUM-n)}}})])])}),_vm._v(\" \"),_c('swiper-slide'),_vm._v(\" \"),_c('swiper-slide')],2)],1),_vm._v(\" \"),_c('div',{staticClass:\"g-controller\"},[_c('vue-slider',_vm._b({on:{\"callback\":_vm.adjustTimeline,\"drag-end\":function($event){}},model:{value:(_vm.vuetimeline),callback:function ($$v) {_vm.vuetimeline=$$v},expression:\"vuetimeline\"}},'vue-slider',_vm.timelineConfig,false)),_vm._v(\" \"),_c('div',{staticClass:\"btnContainer\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();_vm.btnStart($event)},\"touchend\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"event\",undefined,$event.key)){ return null; }$event.stopPropagation();_vm.btnEnd($event)}}},[_c('div',{class:[_vm.playing?'pauseBtn':'playBtn', 'rotate'],on:{\"click\":_vm.toggleReplay}}),_vm._v(\" \"),_c('div',{class:[_vm.showExtendBtns?'extendBtnsShow':'extendBtnsHide','extendBtns']},[_c('div',{staticClass:\"bounceBtn rotate\"})])])],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1a98cf2c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/NMBMaker.vue\n// module id = null\n// module chunks = ","<script>\nwindow.Tone = require('tone')\nimport * as Util from '../_common/js/util'\nimport * as Api from '../_common/js/api'\nimport * as Cookies from \"js-cookie\"\nlet musicPart = undefined\n\nconst mbox = new Tone.Sampler({\n  'C4': 'C4.[mp3|ogg]',\n  'D#4': 'Ds4.[mp3|ogg]',\n  'F#4': 'Fs4.[mp3|ogg]',\n  'A4': 'A4.[mp3|ogg]',\n  'C5': 'C5.[mp3|ogg]',\n  'D#5': 'Ds5.[mp3|ogg]',\n  'F#5': 'Fs5.[mp3|ogg]',\n  'A5': 'A5.[mp3|ogg]',\n  'C6': 'C6.[mp3|ogg]',\n}, {\n  'release': 1,\n  'baseUrl': 'static/audio/'\n}).toMaster()\n\nexport default {\n  components: {\n\n  },\n  data() {\n    return {\n      playing: false,\n    }\n  },\n  computed: {\n    project() {\n      return this.$store.state.recordProject\n    },\n  },\n  methods: {\n    load() {},\n    prepareMusic() {\n      try {\n        musicPart.dispose()\n      } catch (e) {\n        //\n      }\n      musicPart = new Tone.Part(function(time, value) {\n        mbox.triggerAttackRelease(value.note, \"8n\", time)\n      }, this.project).start(0)\n    },\n    loadMusicById() {\n      console.log('hehe', this.$store.state)\n      const {id} = this.$store.state.route.query\n      // const id = 29\n      if (!id||!this.project) {\n        console.log('搞飞机，没内容')\n        return\n      }\n      if(id){ //从id取作品\n        console.log('mmm',id)\n        this.$store.dispatch('FETCH_MBOX',{id}).then(() => {\n          this.prepareMusic()\n        })\n      } else if (this.project) { //store里边的作品，刚录的\n        this.prepareMusic()\n      }\n    },\n    togglePlay() {\n      this.playing = !this.playing\n      if (this.playing) {\n        // Tone.Transport.start(\"+0.01\", this.vuetimeline * 100 / 1000)\n        Tone.Transport.start(\"+0.01\", 0)\n      } else {\n        Tone.Transport.stop(0) // TODO：必须stop才能start。。。有没有自动stop啊..\n      }\n    },\n  },\n  created() {\n    //check cookie to get serviceToken first\n    // if stoken not exist, go auth\n    const self = this\n    const inWechat = /micromessenger/.test(navigator.userAgent.toLowerCase())\n    self.loadMusicById()\n    if (!inWechat) return\n    if (Util.getUrlParam('code') || Cookies.get('serviceToken')) {\n      //TODO:ajax call to get info\n      Api.getUserInfo(Util.getUrlParam('code'))\n        .then((res) => {\n          if (res.data.errcode >= 20000) {\n            // 网页内cookie失效，需要重新验证\n            Cookies.remove('serviceToken')\n            location.replace(\n              'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n            )\n          }\n          alert(`welcome${res.data.data.realname}`)\n          console.log('get user info success', res.data.data)\n        })\n        .catch((err) => {\n          Cookies.remove('serviceToken')\n          location.replace(\n            'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n          )\n        })\n    } else { //又没有微信给的auth code又没有token存在cookie，只得验证\n      location.replace(\n        'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect'\n      )\n    }\n  },\n  mounted() {\n    // this.startRecord();\n  },\n  updated() {}\n};\n</script>\n\n<template>\n<div id=\"container\">\n  <div class=\"mb\">\n    <div :class=\"[playing?'pauseBtn':'playBtn', 'rotate']\" @click=\"togglePlay\"></div>\n  </div>\n  <div class=\"operate\">\n    <div class=\"share\">\n\n    </div>\n    <div class=\"purchase\">\n\n    </div>\n  </div>\n</div>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../_common/style/_functions.scss';\n@import '../_common/style/_variables.scss';\n@import '../_common/style/_mixins.scss';\n@import '../_common/style/_reboot.scss';\n.container {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/MBViewer.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"container\"}},[_c('div',{staticClass:\"mb\"},[_c('div',{class:[_vm.playing?'pauseBtn':'playBtn', 'rotate'],on:{\"click\":_vm.togglePlay}})]),_vm._v(\" \"),_vm._m(0,false,false)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"operate\"},[_c('div',{staticClass:\"share\"}),_vm._v(\" \"),_c('div',{staticClass:\"purchase\"})])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-9843fa82\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MBViewer.vue\n// module id = null\n// module chunks = ","import Vue from 'vue';\nimport Router from 'vue-router';\nimport HelloWorld from '@/components/HelloWorld';\nimport MBMaker from '@/components/MBMaker';\nimport MBItem from '@/components/MBItem';\nimport MBAuthor from '@/components/MBAuthor';\nimport NMBMaker from '@/components/NMBMaker';\nimport MBViewer from '@/components/MBViewer';\n\nVue.use(Router);\n\nexport default new Router({\n  mode: 'history', // avoid hash in url\n  routes: [\n    {\n      path: '/',\n      name: 'HelloWorld',\n      component: HelloWorld,\n    },\n    {\n      path: '/music-box-maker',\n      name: 'MBMaker',\n      component: MBMaker,\n    },\n    {\n      path: '/new-music-box-maker',\n      name: 'NMBMaker',\n      component: NMBMaker,\n    },\n    {\n      path: '/music-box-viewer',\n      name: 'MBViewer',\n      component: MBViewer,\n    },\n    {\n      path: '/music-box-item',\n      name: 'MBItem',\n      component: MBItem,\n    },\n    {\n      path: '/music-box-author',\n      name: 'MBAuthor',\n      component: MBAuthor,\n    },\n  ],\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue';\nimport { sync } from 'vuex-router-sync';\nimport VueTouch from 'vue-touch';\nimport { createStore } from './store';\nimport App from './App';\nimport router from './router';\n\nVue.use(VueTouch, { name: 'v-touch' });\nVue.config.productionTip = false;\nconst store = createStore();\nsync(store, router);\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  router,\n  store,\n  template: '<App/>',\n  components: { App },\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}