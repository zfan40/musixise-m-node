webpackJsonp([1],{"8GxT":function(t,e){},NHnr:function(t,e,i){"use strict";function o(t){var e=O.get("serviceToken");return e?(L.access_token=e,$.get("//api.musixise.com/api/v1/user/getInfo","",D)):!(e||!t)&&new R.a(function(e,i){$.post("//api.musixise.com/api/v1/user/oauth/wechat/callback?code="+t,"",D).then(function(t){20001===t.data.errcode&&i(20001);var e=t.data.data.id_token;return L.access_token=e,O.set("serviceToken",e,{expires:7}),$.get("//api.musixise.com/api/v1/user/getInfo",W()(L),D)},function(){i()}).then(function(t){e(t)}).catch(function(t){i(t)})})}function n(t,e){var i=this;return new R.a(function(o,n){var a={headers:{"Content-Type":"multipart/form-data",processData:!1}},r=new Blob([W()(t)]),s=new FileReader;s.onload=function(){var t=q()(M.a.mark(function t(r){var s,c,d,l;return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=new FormData,s.append("fname","test.txt"),s.append("data",r.target.result),t.next=5,$.post("//api.musixise.com/api/v1/uploadAudio",s,a);case 5:return c=t.sent,d="http://oiqvdjk3s.bkt.clouddn.com/"+c.data.data,l=B()({},L,e,{url:d}),console.log(d),t.abrupt("return",$.post("//api.musixise.com/api/v1/work/create",W()(l),D).then(function(t){o(t.data.data.id)}).catch(function(t){n(t)}));case 10:case"end":return t.stop()}},t,i)}));return function(e){return t.apply(this,arguments)}}(),s.readAsDataURL(r)})}function a(t){return $.get("//api.musixise.com/api/v1/work/detail/"+t,W()(L),D)}function r(t){return $.get("//api.musixise.com/api/v1/user/detail/"+t,W()(L),D)}function s(t){return $.get("//api.musixise.com/api/v1/work/getListByUid/"+t,W()(L),D)}function c(t){var e=t.workId,i=t.status;return $.post("//api.musixise.com/api/v1/favorite/addWork",W()(B()({workId:e,status:i},L)),D).then(function(t){console.log(t)}).catch(function(t){console.log(t)})}function d(t){var e=t.workId,i=t.title;return $.put("//api.musixise.com/api/v1/work/updateWork/"+e,W()(B()({workId:e,title:i},L)),D).then(function(t){console.log(t)}).catch(function(t){console.log(t)})}function l(){return $.post("//api.musixise.com/api/v1/home",W()(L),D)}function u(t){i("hoXB")}function p(t){var e=new RegExp("[?|&]"+t+"=([^&]+)"),i=location.search.match(e);return i&&i[1]}function v(t){i("O/d9")}function f(t){console.log("== Enter RealMagic =="),console.log(W()(t));var e={};t.forEach(function(t){var i=parseInt(2*bt.Frequency(t.note).toFrequency(),10);e[i]||(e[i]=[]),e[i].push(t.time)});var i=_t()(e),o=gt()(e),n=[],a=[];if(i.length>18)return console.log("音种类超过18个，这个做不了"),!1;if(o.forEach(function(t){var e=[];t.forEach(function(i,o){var n=[],a=!1,r=!1;if(0===o)e.push(1);else{for(var s=o;s>=1&&!a;){if(s-=1,i-t[s]>=kt&&-1===n.indexOf(e[s])){e.push(e[s]),r=!0;break}if(-1===n.indexOf(e[s])&&(n.push(e[s]),[].concat(ht()(new vt.a(e))).length===[].concat(ht()(new vt.a(n))).length)){a=!0;break}}(0===s&&!r||a)&&e.push(Math.max.apply(Math,e)+1)}}),a.push(e)}),console.log(i),console.log(o),console.log("hehe",a),a.forEach(function(t,e){for(var o=0;o<=Math.max.apply(Math,ht()(t))-1;)n.push(i[e]),o+=1}),n.length<18)for(var r=n[n.length-1];n.length<18;)n.push(r);else if(n.length>18)return console.log("所需音片儿超过18个"),!1;return!0}function h(t){var e=[151,255,241],i=[98,166,223],o=[154,124,255],n=[0,0,0];return t<0||t>20||t<=10&&(n=[e[0]+t*(i[0]-e[0])/10,e[1]+t*(i[1]-e[1])/10,e[2]+t*(i[2]-e[2])/10]),n=[i[0]+t*(o[0]-i[0])/10,i[1]+t*(o[1]-i[1])/10,i[2]+t*(o[2]-i[2])/10],"rgb("+Math.floor(n[0])+","+Math.floor(n[1])+","+Math.floor(n[2])+")"}function m(t){return""+((bt.Frequency(t).toMidi()-50)/70*60+.2)}function g(t){if(t&&t.length&&t.forEach(function(t){try{t.dispose()}catch(t){}}),xt)try{xt.dispose()}catch(t){}}function w(t){if(console.log("current state",bt.Transport.state),"stopped"===bt.Transport.state){if(Tt||(yt.triggerAttack("E6",0,0),Tt=!0),xt)try{xt.dispose()}catch(t){}xt=new bt.Part(function(t,e){yt.triggerAttackRelease(e.note,"8n",t)},t).start(0,0),xt.loop=!0,xt.loopEnd=17,bt.Transport.start("+0.01",0)}else bt.Transport.stop(0)}function _(t){i("kT+u")}function b(t){i("8GxT")}function k(t){i("rCB7")}function x(t){i("iNGF")}function T(t){i("X6QL")}function y(t){i("RLy1")}Object.defineProperty(e,"__esModule",{value:!0});var I=i("7+uW"),C=i("9JMe"),S=i("I0MY"),A=i.n(S),E=i("NYxO"),N=i("//Fk"),R=i.n(N),P=i("Xxa5"),M=i.n(P),U=i("Dd8w"),B=i.n(U),j=i("exGp"),q=i.n(j),F=i("mvHQ"),W=i.n(F),O=i("lbHh"),$=i("mtWM"),D={headers:{Accept:"application/json","Content-Type":"application/json"}},L={access_token:""},X={BOUNCE_PROJECT:function(t,e){t.commit,t.state;return n(e.record,e.info)},FETCH_MBOX:function(t,e){var i=t.commit,o=(t.state,e.id);return new R.a(function(t,e){a(o).then(function(e){console.log("xxi",e.data.data.url);var o=new XMLHttpRequest;o.open("GET",e.data.data.url,!0),o.send(null),o.onreadystatechange=function(){if(4===o.readyState&&200===o.status){-1!==o.getResponseHeader("Content-Type").indexOf("text")&&(i("SET_ID_PROJECT",{record:JSON.parse(o.responseText),info:e.data.data}),t())}}})})},FETCH_MUSIXISER:function(t,e){var i=t.commit,o=(t.state,e.id);return new R.a(function(t,e){r(o).then(function(e){console.log("musixiser info: ",e.data.data),i("SET_MUSIXISER",{musixiserInfo:e.data.data}),t()})})},FETCH_WORKS_FROM_MUSIXISER:function(t,e){var i=t.commit,o=(t.state,e.id);return new R.a(function(t,e){s(o).then(function(e){console.log("works list: ",e.data.data),i("PUSH_MUSIXISER_WORKS",{musixiserWorksObj:e.data.data}),t()})})}},H={SET_USER_INFO:function(t,e){var i=e.type;t.activeType=i},SET_WORK_INFO:function(t,e){var i=e.type,o=e.ids;t.lists[i]=o},SET_MUSIXISER_INFO:function(t,e){e.items.forEach(function(e){e&&I.a.set(t.items,e.id,e)})},SET_BOUNCE_PROJECT:function(t,e){var i=e.record;t.recordProject=i},SET_ID_PROJECT:function(t,e){var i=e.record,o=e.info;t.recordProject=i,t.recordProjectInfo=o},SET_MUSIXISER:function(t,e){var i=e.musixiserInfo;t.musixiserInfo=i},PUSH_MUSIXISER_WORKS:function(t,e){var i=e.musixiserWorksObj;t.musixiserWorksObj.content=t.musixiserWorksObj.content.concat(i.content),t.musixiserWorksObj.page=i.page}},z={activeIds:function(t){var e=t.activeType,i=t.itemsPerPage,o=t.lists,n=Number(t.route.params.page)||1;if(e){var a=(n-1)*i,r=n*i;return o[e].slice(a,r)}return[]},activeItems:function(t,e){return e.activeIds.map(function(e){return t.items[e]}).filter(function(t){return t})}};I.a.use(E.a);var G={name:"app",data:function(){return{transitionName:"fade"}},beforeRouteUpdate:function(t,e,i){}},V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("transition",{attrs:{name:t.transitionName}},[i("router-view")],1)],1)},K=[],J={render:V,staticRenderFns:K},Y=J,Q=i("VU/8"),Z=u,tt=Q(G,Y,!1,Z,"data-v-7d7a33f4",null),et=tt.exports,it=i("/ocq"),ot={name:"hello",data:function(){return{msg:"Welcome to Your Vue.js App"}},methods:{redirectTo:function(t){this.$router.push(t)}},created:function(){var t=document.documentElement;window.rem=t.getBoundingClientRect().width/10,t.style.fontSize=window.rem+"px",/micromessenger/.test(navigator.userAgent.toLowerCase())&&(p("code")||O.get("serviceToken")?o(p("code")).then(function(t){t.data.errcode>=2e4&&(O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box&connect_redirect=1#wechat_redirect"))}},nt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app"},[i("div",{staticClass:"m-logo"}),t._v(" "),i("div",{staticClass:"redirect-button",attrs:{id:"mb-maker"},on:{touchstart:function(e){t.redirectTo("/new-music-box-maker")}}},[t._v("\n      去编曲\n  ")])])},at=[],rt={render:nt,staticRenderFns:at},st=rt,ct=i("VU/8"),dt=v,lt=ct(ot,st,!1,dt,"data-v-3b801b49",null),ut=lt.exports,pt=i("lHA8"),vt=i.n(pt),ft=i("Gu7T"),ht=i.n(ft),mt=i("gRE1"),gt=i.n(mt),wt=i("fZjL"),_t=i.n(wt),bt=i("ZnLv");bt.Transport.cancel();var kt=1,xt=void 0,Tt=!1,yt=new bt.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"/static/audio/"}).toMaster(),It=i("mtWM"),Ct=i.n(It),St=i("fxnj"),At=i.n(St),Et={headers:{Accept:"application/json","Content-Type":"application/json"}},Nt=function(){return new R.a(function(t,e){Ct.a.post("//api.musixise.com/api/v1/wechat/getTicket?url="+encodeURIComponent(window.location.href.split("#")[0]),"",Et).then(function(e){At.a.config({debug:!1,appId:e.data.data.appId,timestamp:e.data.data.timestamp,nonceStr:e.data.data.nonceStr,signature:e.data.data.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"]}),At.a.ready(function(){t(At.a)})},function(){e("配置wx.config失败")})})},Rt=function(t){var e=t.title,i=t.desc,o=t.fullPath,n=t.imgUrl,a=o;At.a.onMenuShareTimeline({title:e,link:a,imgUrl:n,success:function(){},cancel:function(){}}),At.a.onMenuShareAppMessage({title:e,desc:i,link:a,imgUrl:n,success:function(){},cancel:function(){}})},Pt=(i("v2ns"),i("GDE4")),Mt=i.n(Pt),Ut=i("7QTg"),Bt=i("ZnLv"),jt={},qt=void 0,Ft=new Bt.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"/static/audio/"}).toMaster(),Wt=((new Bt.PluckSynth).toMaster(),document.documentElement.getBoundingClientRect().width,Math.max(document.documentElement.clientHeight,window.innerHeight||0),[]),Ot=[],$t=0,Dt=!0,Lt=void 0,Xt=0,Ht=0,zt={components:{swiper:Ut.swiper,swiperSlide:Ut.swiperSlide,vueSlider:Mt.a},data:function(){return{activeNote:{},recordPart:[],recordParts:[],playing:!1,generalControllerShow:!1,activeSwiperIndex:3,lastActiveSwiperIndex:2,vuetimeline:0,showExtendBtns:0,timelineConfig:{value:0,width:8,height:"90%",padding:"0",dotSize:20,eventType:"auto",min:0,max:200,interval:1,disabled:!1,show:!0,tooltip:"always",piecewise:!1,reverse:!0,style:{display:"inline-block"},class:"star-slider",direction:"vertical",speed:.1,bgStyle:{backgroundColor:"rgb(110,113,158)",boxShadow:"inset 0.5px 0.5px 3px 1px rgba(0,0,0,.36)"},tooltipStyle:{backgroundColor:"rgb(69, 106, 255)",borderColor:"rgb(69, 106, 255)"},formatter:function(t){return t?(t/10).toFixed(1)+"s/20s":"0.0s/20s"},processStyle:{backgroundColor:"rgb(69,106,255)"}}}},watch:{playing:function(t){var e=this;console.log("playing status",t),t?Lt=setInterval(function(){e.vuetimeline+=1,e.vuetimeline>=200&&(e.toggleReplay(),e.vuetimeline=0)},100):clearInterval(Lt)}},computed:{swiper:function(){return this.$refs.pianoRoll.swiper},activePartIndex:function(){return this.PARTNUM-this.activeSwiperIndex-1},lastActivePartIndex:function(){return this.PARTNUM-this.lastActiveSwiperIndex-1}},methods:{load:function(){},toggleReplay:function(){console.log(1),this.playing=!this.playing,this.playing?(this.vuetimeline>=200&&(this.vuetimeline=0),Xt=performance.now()-100*this.vuetimeline,console.log("播放开始"),this.confirmRecordPart(0),console.log("kokokoko"),$t=performance.now(),console.log("activeOffsetTime"+100*this.vuetimeline),Bt.Transport.start("+0.01",100*this.vuetimeline/1e3)):(console.log("播放停了"),Bt.Transport.stop(0))},handleNoteStart:function(t){var e=0;Ft.triggerAttack(t),this.$set(this.activeNote,t,1),this.playing?e=performance.now()-Xt:(Dt&&($t=performance.now(),Ht=100*this.vuetimeline,Dt=!1),e=performance.now()-$t+Ht),e<2e4?(this.vuetimeline=10*e/1e3,this.recordPart.push({note:t,time:+(e/1e3).toFixed(4)})):(this.vuetimeline=200,console.log("cannot record more than 20 seconds"))},handleNoteEnd:function(t){Ft.triggerRelease(t),this.$set(this.activeNote,t,0)},touchNoteStartHandler:function(t){console.log(t),jt[t.changedTouches[0].identifier]=t.target.id,this.handleNoteStart(t.target.id)},touchNoteEndHandler:function(t){this.handleNoteEnd(t.target.id),this.handleNoteEnd(jt[t.changedTouches[0].identifier])},confirmRecordPart:function(t){if(this.recordPart.length){if(console.log("processing track: ",this.lastActivePartIndex),this.recordParts[this.lastActivePartIndex]&&this.recordParts[this.lastActivePartIndex].length&&(this.recordPart=this.recordPart.concat(this.recordParts[this.lastActivePartIndex])),Wt[this.lastActivePartIndex])try{Wt[this.lastActivePartIndex].dispose()}catch(t){}Wt[this.lastActivePartIndex]=new Bt.Part(function(t,e){Ft.triggerAttackRelease(e.note,"8n",t)},this.recordPart).start(0),this.recordParts[this.lastActivePartIndex]=this.recordPart,this.recordPart=[],this.checkBouncibility()?alert("cool"):alert("not cool")}else console.log("啥也没录");this.lastActiveSwiperIndex=this.activeSwiperIndex,t&&(this.vuetimeline=0,$t=0),Dt=!0},clearRecordPart:function(t){if(console.log("cleaning track "+t),this.activePartIndex===t&&(this.recordPart=[]),this.recordParts[t]&&this.recordParts[t].length){if(this.$set(this.recordParts,t,[]),Wt[t]){try{Wt[t].dispose()}catch(t){}Wt[t]=void 0}}else console.log("track "+t+" has no content")},checkBouncibility:function(){return this.confirmRecordPart(0),Ot=[],!Wt.length||(Wt.forEach(function(t){t&&t._events.length&&t._events[0].value&&t._events.forEach(function(t){Ot.push(t.value)})}),Ot.sort(function(t,e){return 0+t.time-e.time}),f(Ot))},bounceProject:function(){var t=this;this.confirmRecordPart(0),console.log(this),console.log(Wt),Ot=[],Wt.length?(Wt.forEach(function(t){t&&t._events.length&&t._events[0].value&&t._events.forEach(function(t){Ot.push(t.value)})}),Ot.sort(function(t,e){return 0+t.time-e.time}),this.$store.dispatch("BOUNCE_PROJECT",{record:Ot,info:{title:"default",content:"default",cover:"default"}}).then(function(e){console.log("successfully bounced"),alert("作品已为您存储"),t.$router.push({path:"/new-music-box-viewer",query:{id:e}})}).catch(function(t){alert("failed to upload")})):alert("什么都没录呢")},mapNoteTimeToColor:function(t){return h(t)},mapNoteMidiToLength:function(t){return m(t)},adjustTimeline:function(t){this.playing?(console.log("ccccccccc"),this.toggleReplay()):Dt=!0},onMiniKeyboardScroll:function(t){console.log(t.touches[0].clientY)},onMiniKeyboardStart:function(t){console.log(t)},keng:function(t){console.log(t);for(var e=0;e<=t.changedTouches.length-1;e++){var i=document.elementFromPoint(t.changedTouches[e].clientX,t.changedTouches[e].clientY);i.classList.contains("white")||i.classList.contains("black")?jt[t.changedTouches[e].identifier]&&jt[t.changedTouches[e].identifier]!=i.getAttribute("id")?(console.log(jt),this.handleNoteStart(i.getAttribute("id")),this.handleNoteEnd(jt[t.changedTouches[e].identifier]),jt[t.changedTouches[e].identifier]=i.getAttribute("id")):jt[t.changedTouches[e].identifier]?console.log(3):(console.log(2),this.handleNoteStart(i.getAttribute("id")),jt[t.changedTouches[e].identifier]=i.getAttribute("id")):(console.log("外边"),jt[t.changedTouches[e].identifier]&&this.handleNoteEnd(jt[t.changedTouches[e].identifier]),jt[t.changedTouches[e].identifier]=void 0)}},btnStart:function(t){var e=this;console.log(t),qt=setTimeout(function(){e.showExtendBtns=!0},500)},btnEnd:function(t){clearTimeout(qt);var e=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY);console.log(e),e&&e.classList.contains("bounceBtn")?this.bounceProject():e&&(e.classList.contains("playBtn")||e.classList.contains("pauseBtn"))&&this.toggleReplay(),this.showExtendBtns=!1}},created:function(){var t=this;Bt.Transport.cancel(),Wt=[],Ot=[];var e=document.documentElement;window.rem=e.getBoundingClientRect().width/10,e.style.fontSize=window.rem+"px",this.PARTNUM=3,this.pianoRollSwiperOption={initialSlide:this.PARTNUM,slidesPerView:3,on:{transitionEnd:function(e){console.log("3",this.activeIndex),t.activeSwiperIndex=this.activeIndex,t.confirmRecordPart(!Dt)}}},/micromessenger/.test(navigator.userAgent.toLowerCase())&&(Nt().then(function(){Rt({title:"MUSIXISE",desc:"寻找你自己的八音盒",fullPath:""+location.origin+location.pathname+"#/new-music-box-maker",imgUrl:"http://oaeyej2ty.bkt.clouddn.com/Ocrg2srw_icon33@2x.png"})}),p("code")||O.get("serviceToken")?o(p("code")).then(function(t){t.data.errcode>=2e4&&(O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(location.origin+location.pathname+"#/new-music-box-maker")+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")),console.log("get user info success",t.data.data)}).catch(function(t){O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(location.origin+location.pathname+"#/new-music-box-maker")+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(location.origin+location.pathname+"#/new-music-box-maker")+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect"))},beforeRouteLeave:function(t,e,i){g(Wt),i()},mounted:function(){},updated:function(){}},Gt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}},[i("div",{staticClass:"keys",on:{touchmove:t.keng,touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.touchNoteStartHandler(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.touchNoteEndHandler(e)}}},[i("div",{class:["white","c",t.activeNote.C4?"active-note":""],attrs:{id:"C4"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db4?"active-note":""],attrs:{id:"Db4"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D4?"active-note":""],attrs:{id:"D4"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb4?"active-note":""],attrs:{id:"Eb4"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E4?"active-note":""],attrs:{id:"E4"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F4?"active-note":""],attrs:{id:"F4"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb4?"active-note":""],attrs:{id:"Gb4"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G4?"active-note":""],attrs:{id:"G4"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab4?"active-note":""],attrs:{id:"Ab4"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A4?"active-note":""],attrs:{id:"A4"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb4?"active-note":""],attrs:{id:"Bb4"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B4?"active-note":""],attrs:{id:"B4"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C5?"active-note":""],attrs:{id:"C5"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db5?"active-note":""],attrs:{id:"Db5"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D5?"active-note":""],attrs:{id:"D5"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb5?"active-note":""],attrs:{id:"Eb5"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E5?"active-note":""],attrs:{id:"E5"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F5?"active-note":""],attrs:{id:"F5"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb5?"active-note":""],attrs:{id:"Gb5"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G5?"active-note":""],attrs:{id:"G5"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab5?"active-note":""],attrs:{id:"Ab5"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A5?"active-note":""],attrs:{id:"A5"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb5?"active-note":""],attrs:{id:"Bb5"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B5?"active-note":""],attrs:{id:"B5"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C6?"active-note":""],attrs:{id:"C6"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db6?"active-note":""],attrs:{id:"Db6"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D6?"active-note":""],attrs:{id:"D6"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb6?"active-note":""],attrs:{id:"Eb6"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E6?"active-note":""],attrs:{id:"E6"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F6?"active-note":""],attrs:{id:"F6"}})]),t._v(" "),i("div",{staticClass:"keyshadow"}),t._v(" "),i("div",{staticClass:"scroll-container"}),t._v(" "),i("div",{staticClass:"semi-piano-roll",on:{touchmove:function(t){t.stopPropagation(),t.preventDefault()}}},[i("swiper",{ref:"pianoRoll",attrs:{options:t.pianoRollSwiperOption}},[t._l(t.PARTNUM,function(e){return i("swiper-slide",[i("div",{staticClass:"current-piano-roll"},[i("svg",{style:{height:"90%",padding:t.timelineConfig.dotSize/2+"px 0"}},[i("defs",[i("filter",{attrs:{id:"glowing",height:"400%",width:"130%",x:"-10%",y:"-130%"}},[i("feMorphology",{attrs:{operator:"dilate",radius:"1",in:"SourceAlpha",result:"thicken"}}),t._v(" "),i("feGaussianBlur",{attrs:{in:"thicken",stdDeviation:"2",result:"blurred"}}),t._v(" "),i("feFlood",{attrs:{"flood-color":"rgb(200,200,255)",result:"glowColor"}}),t._v(" "),i("feComposite",{attrs:{in:"glowColor",in2:"blurred",operator:"in",result:"softGlow_colored"}}),t._v(" "),i("feMerge",[i("feMergeNode",{attrs:{in:"softGlow_colored"}}),t._v(" "),i("feMergeNode",{attrs:{in:"SourceGraphic"}})],1)],1)]),t._v(" "),t._l(t.recordPart,function(o,n){return t.activePartIndex===t.PARTNUM-e?i("rect",{attrs:{x:2,y:100*o.time/20+"%",width:t.mapNoteMidiToLength(o.note),height:"3",rx:"2",ry:"2",fill:t.mapNoteTimeToColor(o.time),filter:"url(#glowing)"}}):t._e()}),t._v(" "),t._l(t.recordParts[t.PARTNUM-e],function(o,n){return i("rect",{attrs:{x:2,y:100*o.time/20+"%",width:t.mapNoteMidiToLength(o.note),height:"3",rx:"2",ry:"2",fill:t.activePartIndex===t.PARTNUM-e?t.mapNoteTimeToColor(o.time):"rgb(120,120,120)",filter:t.activePartIndex===t.PARTNUM-e?"url(#glowing)":""}})})],2),t._v(" "),i("div",{staticClass:"temp",on:{click:function(i){t.clearRecordPart(t.PARTNUM-e)}}})])])}),t._v(" "),i("swiper-slide"),t._v(" "),i("swiper-slide")],2)],1),t._v(" "),i("div",{staticClass:"g-controller"},[i("vue-slider",t._b({on:{callback:t.adjustTimeline,"drag-end":function(t){}},model:{value:t.vuetimeline,callback:function(e){t.vuetimeline=e},expression:"vuetimeline"}},"vue-slider",t.timelineConfig,!1)),t._v(" "),i("div",{staticClass:"btnContainer",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.btnStart(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.btnEnd(e)}}},[i("div",{class:[t.playing?"pauseBtn":"playBtn","rotate"],on:{click:t.toggleReplay}}),t._v(" "),i("div",{class:[t.showExtendBtns?"extendBtnsShow":"extendBtnsHide","extendBtns"]},[i("div",{staticClass:"bounceBtn rotate"})])])],1)])},Vt=[],Kt={render:Gt,staticRenderFns:Vt},Jt=Kt,Yt=i("VU/8"),Qt=_,Zt=Yt(zt,Jt,!1,Qt,"data-v-68c5dba7",null),te=Zt.exports,ee={props:{initCount:Number,initActive:Boolean,iconImg:String,onClickCall:{type:Function,default:function(){return function(){console.log("tap tap in count Button")}}}},computed:{style:function(){}},data:function(){return{currentActiveCount:0,currentActive:!1}},watch:{},created:function(){this.currentActive=this.initActive,this.currentActiveCount=this.currentActive?this.initCount:this.initCount+1},mounted:function(){},updated:function(){},methods:{updateButton:function(){this.currentActive=!this.currentActive,this.onClickCall()}}},ie=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"btnContainer",on:{click:t.updateButton}},[i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentActive,expression:"currentActive"}],staticClass:"active-btn-background"})]),t._v(" "),i("transition",{attrs:{name:"slideDown"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentActive,expression:"currentActive"}],staticClass:"btn active"},[i("div",{}),t._v(" "),i("p",[t._v(t._s(t.currentActiveCount))])])]),t._v(" "),i("transition",{attrs:{name:"slideUp"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.currentActive,expression:"!currentActive"}],staticClass:"btn inactive"},[i("div",{}),t._v(" "),i("p",[t._v(t._s(t.currentActiveCount-1))])])])],1)},oe=[],ne={render:ie,staticRenderFns:oe},ae=ne,re=i("VU/8"),se=b,ce=re(ee,ae,!1,se,"data-v-fd02150e",null),de=ce.exports,le={components:{countButton:de},data:function(){return{loading:!0,workIntroAppear:!1,controlPanalAppear:!1,titleUpdateAppear:!1,playing:!1,userId:0,favStatus:!1,newWorkTitle:"",finalNewWorkTitle:""}},computed:{project:function(){return this.$store.state.recordProject},projectInfo:function(){return this.$store.state.recordProjectInfo}},methods:{load:function(){},loadMusicById:function(){var t=this;console.log("hehe",this.$store.state);var e=this.$store.state.route.query.id;e?(console.log("mmm",e),this.$store.dispatch("FETCH_MBOX",{id:e}).then(function(){console.log("workPart",t.project),console.log("work info",t.projectInfo),t.favStatus=t.projectInfo.favStatus})):this.$store.dispatch("FETCH_MBOX",{id:50}).then(function(){console.log("workPart",t.project),console.log("work info",t.projectInfo),t.favStatus=t.projectInfo.favStatus})},togglePlay:function(){w(this.project),this.playing=!this.playing},toggleFav:function(){c({workId:this.$store.state.route.query.id,status:this.favStatus})},updateWorkTitle:function(){var t=this;d({workId:this.$store.state.route.query.id,title:this.newWorkTitle}),this.finalNewWorkTitle=this.newWorkTitle,setTimeout(function(){t.titleUpdateAppear=!1},300)},redirectToMaker:function(){this.$router.push({path:"/new-music-box-maker"})},purchaseItem:function(){console.log("you are about to purchase "+this.projectInfo.id)}},beforeRouteLeave:function(t,e,i){g(),i()},created:function(){var t=this,e=document.documentElement;if(window.rem=e.getBoundingClientRect().width/10,e.style.fontSize=window.rem+"px",!/micromessenger/.test(navigator.userAgent.toLowerCase()))return void t.loadMusicById();var i=""+location.origin+location.pathname+"#/new-music-box-viewer?id="+t.$store.state.route.query.id;Nt().then(function(){Rt({title:"MUSIXISE",desc:"分享一个八音盒",fullPath:i,imgUrl:"http://oaeyej2ty.bkt.clouddn.com/Ocrg2srw_icon33@2x.png"})}),p("code")||O.get("serviceToken")?o(p("code")).then(function(e){e.data.errcode>=2e4&&(O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(i)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")),t.userId=e.data.data.userId,t.loadMusicById(),console.log("get user info success",e.data.data)}).catch(function(t){O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(i)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(i)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")},mounted:function(){var t=this;setTimeout(function(){t.loading=!1},2e3),setTimeout(function(){t.workIntroAppear=!0},4500),setTimeout(function(){t.controlPanalAppear=!0},5500)},updated:function(){}},ue=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["container",t.loading?"loading":""]},[i("div",{attrs:{id:"ground"}}),t._v(" "),t._m(0,!1,!1),t._v(" "),i("div",{attrs:{id:"mb"},on:{click:t.togglePlay}},[i("div",{class:["mb-part",t.playing?"playing":""],attrs:{id:"mb-lid"}}),t._v(" "),i("div",{staticClass:"mb-part",attrs:{id:"mb-body"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.playing,expression:"!playing"}],attrs:{id:"play-btn"}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],attrs:{id:"pause-btn"}})])]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],attrs:{id:"music-aurora"}})]),t._v(" "),i("div",{attrs:{id:"low-leaf1"}}),t._v(" "),i("div",{attrs:{id:"low-leaf2"}}),t._v(" "),i("div",{attrs:{id:"low-leaf3"}}),t._v(" "),i("div",{attrs:{id:"low-leaf4"}}),t._v(" "),i("div",{attrs:{id:"mid-leaf1"}}),t._v(" "),i("div",{attrs:{id:"mid-leaf2"}}),t._v(" "),i("div",{attrs:{id:"mid-leaf3"}}),t._v(" "),i("div",{attrs:{id:"mid-leaf4"}}),t._v(" "),i("div",{attrs:{id:"top-leaf1"}}),t._v(" "),i("div",{attrs:{id:"top-leaf2"}}),t._v(" "),i("div",{attrs:{id:"top-leaf3"}}),t._v(" "),i("div",{attrs:{id:"top-leaf4"}}),t._v(" "),i("div",{attrs:{id:"top-leaf5"}}),t._v(" "),i("div",{attrs:{id:"top-leaf6"}}),t._v(" "),i("transition",{attrs:{name:"bounce"}},[t.workIntroAppear?i("div",{attrs:{id:"work-intro"}},[i("div",{staticClass:"title"},[t._v(t._s(t.finalNewWorkTitle||t.projectInfo.title))]),t._v(" "),i("div",{staticClass:"subtitle"},[i("span",[t._v("by")]),t._v(" "),i("span",[i("img",{attrs:{src:t.projectInfo.owner.smallAvatar,alt:""}})]),i("span",[t._v(t._s(t.projectInfo.owner.nickName))])]),t._v(" "),t.userId===t.projectInfo.userId?i("div",{attrs:{id:"edit-work"},on:{click:function(e){t.titleUpdateAppear=!0}}}):t._e()]):t._e()]),t._v(" "),i("transition",{attrs:{name:"bounce"}},[t.controlPanalAppear?i("div",{attrs:{id:"control-panal"}},[i("count-button",{attrs:{initCount:t.projectInfo.collectNum?t.projectInfo.collectNum:0,initActive:!!t.projectInfo.favStatus,iconImg:"",onClickCall:t.toggleFav}}),t._v(" "),i("div",{staticClass:"purchaseBtn",on:{click:t.purchaseItem}},[t._v("购买")]),t._v(" "),i("div",{staticClass:"makeBtn",on:{click:t.redirectToMaker}},[t._v("编曲")])],1):t._e()]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.titleUpdateAppear,expression:"titleUpdateAppear"}],attrs:{id:"title-update-mask"}},[i("div",{staticClass:"mb-dialog"},[i("div",{staticClass:"title"},[t._v("\n          作品名称\n        ")]),t._v(" "),i("div",{staticClass:"input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newWorkTitle,expression:"newWorkTitle"}],attrs:{type:"text",placeholder:"作品新名称"},domProps:{value:t.newWorkTitle},on:{input:function(e){e.target.composing||(t.newWorkTitle=e.target.value)}}}),t._v(" "),i("div",{staticClass:"splitter"})]),t._v(" "),i("div",{staticClass:"btns"},[i("span",{staticClass:"btn cancel",on:{click:function(e){t.titleUpdateAppear=!1}}},[t._v("取消")]),t._v(" "),i("span",{staticClass:"btn confirm",on:{click:t.updateWorkTitle}},[t._v("确认")])])])])])],1)},pe=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"spirit"}},[i("div",{staticClass:"spirit-part",attrs:{id:"spirit-body"}}),t._v(" "),i("div",{staticClass:"spirit-part",attrs:{id:"spirit-front-leaf"}}),t._v(" "),i("div",{staticClass:"spirit-part",attrs:{id:"spirit-back-leaf"}}),t._v(" "),i("div",{staticClass:"spirit-part",attrs:{id:"spirit-back1"}}),t._v(" "),i("div",{staticClass:"spirit-part",attrs:{id:"spirit-back2"}})])}],ve={render:ue,staticRenderFns:pe},fe=ve,he=i("VU/8"),me=k,ge=he(le,fe,!1,me,"data-v-213b0cf2",null),we=ge.exports,_e=i("bqTm"),be=i.n(_e),ke={directives:{infiniteScroll:be.a},components:{countButton:de},data:function(){return{loading:!0,workIntroAppear:!1,controlPanalAppear:!1,titleUpdateAppear:!1,playing:!1,userId:0,isMe:!1,favStatus:!1,newWorkTitle:"",finalNewWorkTitle:"",busy:!1}},computed:{musixiserInfo:function(){return this.$store.state.musixiserInfo},musixiserWorksObj:function(){return this.$store.state.musixiserWorksObj}},methods:{load:function(){},loadMusixiserById:function(){console.log("my id: ",this.userId);var t=this.userId;this.$store.dispatch("FETCH_MUSIXISER",{id:t}),this.$store.dispatch("FETCH_WORKS_FROM_MUSIXISER",{id:t})},loadMore:function(){var t=this.userId;this.busy=!0,console.log("1"),this.$store.dispatch("FETCH_WORKS_FROM_MUSIXISER",{id:t})},togglePlay:function(){w(this.project),this.playing=!this.playing},toggleFav:function(){c({workId:this.$store.state.route.query.id,status:this.favStatus})},updateWorkTitle:function(){var t=this;d({workId:this.$store.state.route.query.id,title:this.newWorkTitle}),this.finalNewWorkTitle=this.newWorkTitle,setTimeout(function(){t.titleUpdateAppear=!1},300)},redirectToMaker:function(){this.$router.push({path:"/new-music-box-maker"})},purchaseItem:function(){console.log("you are about to purchase "+this.projectInfo.id)}},beforeRouteLeave:function(t,e,i){g(),i()},created:function(){var t=this,e=this,i=document.documentElement;if(window.rem=i.getBoundingClientRect().width/10,i.style.fontSize=window.rem+"px",!/micromessenger/.test(navigator.userAgent.toLowerCase()))return this.userId=this.$store.state.route.query.id||149,void e.loadMusixiserById();var n=""+location.origin+location.pathname+"#/new-music-box-viewer?id="+e.$store.state.route.query.id;Nt().then(function(){Rt({title:"MUSIXISE",desc:"我的地盘你就dê听我的",fullPath:n,imgUrl:"http://oaeyej2ty.bkt.clouddn.com/Ocrg2srw_icon33@2x.png"})}),p("code")||O.get("serviceToken")?o(p("code")).then(function(i){i.data.errcode>=2e4&&(O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")),e.userId=t.$store.state.route.query.id||i.data.data.userId,e.isMe=e.userId===i.data.data.userId,e.loadMusixiserById(),console.log("get user info success",i.data.data)}).catch(function(t){O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")},mounted:function(){var t=this;setTimeout(function(){t.loading=!1},2e3),setTimeout(function(){t.workIntroAppear=!0},4500),setTimeout(function(){t.controlPanalAppear=!0},5500)},updated:function(){}},xe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[i("div",{},[t._v("\n    "+t._s(t.musixiserInfo.realname)+"\n  ")]),t._v(" "),i("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"10"}},[i("ul",{attrs:{id:"example-1"}},t._l(t.musixiserWorksObj.content,function(e){return i("li",[t._v("\n        "+t._s(e.title)+"\n      ")])}))])])},Te=[],ye={render:xe,staticRenderFns:Te},Ie=ye,Ce=i("VU/8"),Se=x,Ae=Ce(ke,Ie,!1,Se,"data-v-3202b64d",null),Ee=Ae.exports,Ne={directives:{infiniteScroll:be.a},components:{countButton:de},data:function(){return{loading:!0,workIntroAppear:!1,controlPanalAppear:!1,titleUpdateAppear:!1,playing:!1,userId:0,isMe:!1,favStatus:!1,newWorkTitle:"",finalNewWorkTitle:"",busy:!1}},computed:{musixiserInfo:function(){return this.$store.state.musixiserInfo},musixiserWorksObj:function(){return this.$store.state.musixiserWorksObj}},methods:{load:function(){},loadMusixiserById:function(){console.log("my id: ",this.userId);var t=this.userId;this.$store.dispatch("FETCH_MUSIXISER",{id:t}),this.$store.dispatch("FETCH_WORKS_FROM_MUSIXISER",{id:t})},loadMore:function(){var t=this.userId;this.busy=!0,console.log("1"),this.$store.dispatch("FETCH_WORKS_FROM_MUSIXISER",{id:t})},togglePlay:function(){w(this.project),this.playing=!this.playing},toggleFav:function(){c({workId:this.$store.state.route.query.id,status:this.favStatus})},updateWorkTitle:function(){var t=this;d({workId:this.$store.state.route.query.id,title:this.newWorkTitle}),this.finalNewWorkTitle=this.newWorkTitle,setTimeout(function(){t.titleUpdateAppear=!1},300)},redirectToMaker:function(){this.$router.push({path:"/new-music-box-maker"})},purchaseItem:function(){console.log("you are about to purchase "+this.projectInfo.id)}},beforeRouteLeave:function(t,e,i){g(),i()},created:function(){var t=this,e=this,i=document.documentElement;if(window.rem=i.getBoundingClientRect().width/10,i.style.fontSize=window.rem+"px",!/micromessenger/.test(navigator.userAgent.toLowerCase()))return this.userId=this.$store.state.route.query.id||149,void e.loadMusixiserById();var n=""+location.origin+location.pathname+"#/new-music-box-viewer?id="+e.$store.state.route.query.id;Nt().then(function(){Rt({title:"MUSIXISE",desc:"我的地盘你就dê听我的",fullPath:n,imgUrl:"http://oaeyej2ty.bkt.clouddn.com/Ocrg2srw_icon33@2x.png"})}),p("code")||O.get("serviceToken")?o(p("code")).then(function(i){i.data.errcode>=2e4&&(O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")),e.userId=t.$store.state.route.query.id||i.data.data.userId,e.isMe=t.$store.state.route.query.id===i.data.data.userId,e.loadMusixiserById(),console.log("get user info success",i.data.data)}).catch(function(t){O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")},mounted:function(){var t=this;setTimeout(function(){t.loading=!1},2e3),setTimeout(function(){t.workIntroAppear=!0},4500),setTimeout(function(){t.controlPanalAppear=!0},5500)},updated:function(){}},Re=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[i("div",{},[t._v("\n    "+t._s(t.musixiserInfo.realname)+"\n  ")]),t._v(" "),i("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"10"}},[i("ul",{attrs:{id:"example-1"}},t._l(t.musixiserWorksObj.content,function(e){return i("li",[t._v("\n        "+t._s(e.title)+"\n      ")])}))])])},Pe=[],Me={render:Re,staticRenderFns:Pe},Ue=Me,Be=i("VU/8"),je=T,qe=Be(Ne,Ue,!1,je,"data-v-c70980ea",null),Fe=qe.exports,We={components:{countButton:de},data:function(){return{searching:!1,loading:!1,recommendations:{}}},computed:{},methods:{load:function(){l().then(function(t){console.log("index:",t)})},search:function(){}},beforeRouteLeave:function(t,e,i){g(),i()},created:function(){var t=this,e=document.documentElement;if(window.rem=e.getBoundingClientRect().width/10,e.style.fontSize=window.rem+"px",!/micromessenger/.test(navigator.userAgent.toLowerCase()))return void t.loadMusicById();var i=""+location.origin+location.pathname+"#/new-music-box-viewer?id="+t.$store.state.route.query.id;Nt().then(function(){Rt({title:"MUSIXISE",desc:"分享一个八音盒",fullPath:i,imgUrl:"http://oaeyej2ty.bkt.clouddn.com/Ocrg2srw_icon33@2x.png"})}),p("code")||O.get("serviceToken")?o(p("code")).then(function(e){e.data.errcode>=2e4&&(O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(i)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")),t.userId=e.data.data.userId,t.loadMusicById(),console.log("get user info success",e.data.data)}).catch(function(t){O.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(i)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri="+encodeURIComponent(i)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")},mounted:function(){var t=this;setTimeout(function(){t.loading=!1},2e3),setTimeout(function(){t.workIntroAppear=!0},4500),setTimeout(function(){t.controlPanalAppear=!0},5500)},updated:function(){}},Oe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["container",t.loading?"loading":""]},[i("div",{attrs:{id:"ground"}}),t._v(" "),t._m(0,!1,!1),t._v(" "),i("div",{attrs:{id:"mb"},on:{click:t.togglePlay}},[i("div",{class:["mb-part",t.playing?"playing":""],attrs:{id:"mb-lid"}}),t._v(" "),i("div",{staticClass:"mb-part",attrs:{id:"mb-body"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.playing,expression:"!playing"}],attrs:{id:"play-btn"}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],attrs:{id:"pause-btn"}})])]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],attrs:{id:"music-aurora"}})]),t._v(" "),i("div",{attrs:{id:"low-leaf1"}}),t._v(" "),i("div",{attrs:{id:"low-leaf2"}}),t._v(" "),i("div",{attrs:{id:"low-leaf3"}}),t._v(" "),i("div",{attrs:{id:"low-leaf4"}}),t._v(" "),i("div",{attrs:{id:"mid-leaf1"}}),t._v(" "),i("div",{attrs:{id:"mid-leaf2"}}),t._v(" "),i("div",{attrs:{id:"mid-leaf3"}}),t._v(" "),i("div",{attrs:{id:"mid-leaf4"}}),t._v(" "),i("div",{attrs:{id:"top-leaf1"}}),t._v(" "),i("div",{attrs:{id:"top-leaf2"}}),t._v(" "),i("div",{attrs:{id:"top-leaf3"}}),t._v(" "),i("div",{attrs:{id:"top-leaf4"}}),t._v(" "),i("div",{attrs:{id:"top-leaf5"}}),t._v(" "),i("div",{attrs:{id:"top-leaf6"}}),t._v(" "),i("transition",{attrs:{name:"bounce"}},[t.workIntroAppear?i("div",{attrs:{id:"work-intro"}},[i("div",{staticClass:"title"},[t._v(t._s(t.finalNewWorkTitle||t.projectInfo.title))]),t._v(" "),i("div",{staticClass:"subtitle"},[i("span",[t._v("by")]),t._v(" "),i("span",[i("img",{attrs:{src:t.projectInfo.owner.smallAvatar,alt:""}})]),i("span",[t._v(t._s(t.projectInfo.owner.nickName))])]),t._v(" "),t.userId===t.projectInfo.userId?i("div",{attrs:{id:"edit-work"},on:{click:function(e){t.titleUpdateAppear=!0}}}):t._e()]):t._e()]),t._v(" "),i("transition",{attrs:{name:"bounce"}},[t.controlPanalAppear?i("div",{attrs:{id:"control-panal"}},[i("count-button",{attrs:{initCount:t.projectInfo.collectNum?t.projectInfo.collectNum:0,initActive:!!t.projectInfo.favStatus,iconImg:"",onClickCall:t.toggleFav}}),t._v(" "),i("div",{staticClass:"purchaseBtn",on:{click:t.purchaseItem}},[t._v("购买")]),t._v(" "),i("div",{staticClass:"makeBtn",on:{click:t.redirectToMaker}},[t._v("编曲")])],1):t._e()]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.titleUpdateAppear,expression:"titleUpdateAppear"}],attrs:{id:"title-update-mask"}},[i("div",{staticClass:"mb-dialog"},[i("div",{staticClass:"title"},[t._v("\n          作品名称\n        ")]),t._v(" "),i("div",{staticClass:"input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newWorkTitle,expression:"newWorkTitle"}],attrs:{type:"text",placeholder:"作品新名称"},domProps:{value:t.newWorkTitle},on:{input:function(e){e.target.composing||(t.newWorkTitle=e.target.value)}}}),t._v(" "),i("div",{staticClass:"splitter"})]),t._v(" "),i("div",{staticClass:"btns"},[i("span",{staticClass:"btn cancel",on:{click:function(e){t.titleUpdateAppear=!1}}},[t._v("取消")]),t._v(" "),i("span",{staticClass:"btn confirm",on:{click:t.updateWorkTitle}},[t._v("确认")])])])])])],1)},$e=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"spirit"}},[i("div",{staticClass:"spirit-part",attrs:{id:"spirit-body"}}),t._v(" "),i("div",{staticClass:"spirit-part",attrs:{id:"spirit-front-leaf"}}),t._v(" "),i("div",{staticClass:"spirit-part",attrs:{id:"spirit-back-leaf"}}),t._v(" "),i("div",{staticClass:"spirit-part",attrs:{id:"spirit-back1"}}),t._v(" "),i("div",{staticClass:"spirit-part",attrs:{id:"spirit-back2"}})])}],De={render:Oe,staticRenderFns:$e},Le=De,Xe=i("VU/8"),He=y,ze=Xe(We,Le,!1,He,"data-v-268f8d33",null),Ge=ze.exports;I.a.use(it.a);var Ve=new it.a({routes:[{path:"/",name:"HelloWorld",component:ut},{path:"/new-music-box-maker",name:"NMBMaker",component:te},{path:"/new-music-box-viewer",name:"NMBViewer",component:we},{path:"/musixiser",name:"MusixiserDetail",component:Ee},{path:"/myfav",name:"MyFav",component:Fe},{path:"/recommend",name:"Recommend",component:Ge}]});I.a.use(A.a,{name:"v-touch"}),I.a.config.productionTip=!1;var Ke=function(){return new E.a.Store({state:{activeType:null,itemsPerPage:20,items:{},users:{},lists:{top:[],new:[],show:[],ask:[],job:[]},myInfo:{},recordParts:[],recordProject:[],musixiserInfo:{},musixiserWorksObj:{content:[]}},actions:X,mutations:H,getters:z})}();Object(C.sync)(Ke,Ve),new I.a({el:"#app",router:Ve,store:Ke,template:"<App/>",components:{App:et}})},"O/d9":function(t,e){},RLy1:function(t,e){},X6QL:function(t,e){},hoXB:function(t,e){},iNGF:function(t,e){},"kT+u":function(t,e){},rCB7:function(t,e){},v2ns:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f05dcfaa925b5a040c08.js.map