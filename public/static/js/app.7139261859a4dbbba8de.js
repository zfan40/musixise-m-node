webpackJsonp([1],{BoD0:function(t,e){},CA19:function(t,e){},GWyx:function(t,e){},IEmI:function(t,e){},NHnr:function(t,e,i){"use strict";function o(t){return I?(B.headers.Authorization="Bearer "+I,F.post("//api.musixise.com/api/user/getInfo","",B)):!(I||!t)&&new k.a(function(e,i){F.post("//api.musixise.com/api/user/oauth/wechat/callback?code="+t,"",B).then(function(t){20001===t.data.errcode&&i(20001);var e=t.data.data.id_token;return B.headers.Authorization="Bearer "+e,D.set("serviceToken",e,{expires:7}),F.post("//api.musixise.com/api/user/getInfo","",B)},function(){i()}).then(function(t){e(t)}).catch(function(t){i(t)})})}function a(t,e){var i=this;return new k.a(function(o,a){var n={headers:{"Content-Type":"multipart/form-data",processData:!1}},c=new Blob([P()(t)]),r=new FileReader;r.onload=function(){var t=R()(x.a.mark(function t(c){var r,s,d,l;return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=new FormData,r.append("fname","test.txt"),r.append("data",c.target.result),t.next=5,F.post("//api.musixise.com/api/uploadAudio",r,n);case 5:return s=t.sent,d="http://oiqvdjk3s.bkt.clouddn.com/"+s,l=A()({},e,{url:d}),console.log(d),t.abrupt("return",F.post("//api.musixise.com/api/work/create",P()(l),B).then(function(t){o(t)}).catch(function(t){a(t)}));case 10:case"end":return t.stop()}},t,i)}));return function(e){return t.apply(this,arguments)}}(),r.readAsDataURL(c)})}function n(t){return F.post("//api.musixise.com/api/work/detail/"+t,"",B)}function c(t){i("ViPM")}function r(t){i("e1+N")}function s(t){var e=new RegExp("[?|&]"+t+"=([^&]+)"),i=location.search.match(e);return i&&i[1]}function d(t){console.log("== Enter RealMagic =="),console.log(P()(t));var e={};t.forEach(function(t){var i=parseInt(2*ut.Frequency(t.note).toFrequency(),10);e[i]||(e[i]=[]),e[i].push(t.time)});var i=vt()(e),o=dt()(e),a=[],n=[];if(i.length>18)return console.log("音种类超过18个，这个做不了"),!1;if(o.forEach(function(t,e){var i=[];t.forEach(function(e,o){var a=[],n=!1,c=!1;if(0===o)i.push(1);else{for(var r=o;r>=1&&!n;){if(r-=1,e-t[r]>=pt&&-1===a.indexOf(i[r])){i.push(i[r]),c=!0;break}if(-1===a.indexOf(i[r])&&(a.push(i[r]),[].concat(rt()(new nt.a(i))).length===[].concat(rt()(new nt.a(a))).length)){n=!0;break}}(0===r&&!c||n)&&i.push(Math.max.apply(Math,i)+1)}}),n.push(i)}),console.log(i),console.log(o),console.log("hehe",n),n.forEach(function(t,e){for(var o=0;o<=Math.max.apply(Math,rt()(t))-1;)a.push(i[e]),o+=1}),a.length<18)for(var c=a[a.length-1];a.length<18;)a.push(c);else if(a.length>18)return console.log("所需音片儿超过18个"),!1;console.log(a);var r=n.reduce(function(t,e){return t.concat(e.map(function(e){return e+Math.max.apply(Math,rt()(t))}))}),s=o.reduce(function(t,e){return t.concat(e)});s=s.map(function(t){return 15*t/20});var d=r.map(function(t,e){return"generatePin("+s[e]+","+t+")"});console.log("\n    //底下低音,上面高音\n  const DOT_WIDTH = 0.6\n  const RATIO = 0.98\n  const OFFSET = 2.2 //1.95 is center\n  const OUTER_RADIUS = 6.6\n  const INNER_RADIUS = 5.9\n  function generatePin(noteSec, noteNo) {\n    return rotate(90, [1, 0, 4 * noteSec * RATIO / 15], cylinder({\n      h: 1,\n      r: DOT_WIDTH / 2,\n      center: true\n    })).translate([sin(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -cos(360 * noteSec * RATIO / 15) * OUTER_RADIUS, -9.95 + OFFSET + 0.4 + (noteNo - 1) * .9])\n  }\n\n  function main() {\n    let cylinderBody = difference(cylinder({h: 19.9,r: OUTER_RADIUS,center: true}),cylinder({h: 19.9,r: INNER_RADIUS,center: true}))\n    let holes = union("+d+")\n    return union(cylinderBody,holes).translate([0, 0, 0]).scale(1);\n  }")}function l(t){var e=[151,255,241],i=[98,166,223],o=[154,124,255],a=[0,0,0];return t<0||t>20||t<=10&&(a=[e[0]+t*(i[0]-e[0])/10,e[1]+t*(i[1]-e[1])/10,e[2]+t*(i[2]-e[2])/10]),a=[i[0]+t*(o[0]-i[0])/10,i[1]+t*(o[1]-i[1])/10,i[2]+t*(o[2]-i[2])/10],"rgb("+Math.floor(a[0])+","+Math.floor(a[1])+","+Math.floor(a[2])+")"}function v(t){return""+((ut.Frequency(t).toMidi()-50)/70*60+.2)}function u(t){i("GWyx")}function p(t){i("CA19")}function m(t){i("IEmI")}function h(t){i("BoD0")}function g(t){i("ibai")}Object.defineProperty(e,"__esModule",{value:!0});var f=i("7+uW"),_=i("9JMe"),b=i("I0MY"),w=i.n(b),T=i("NYxO"),C=i("//Fk"),k=i.n(C),N=i("Xxa5"),x=i.n(N),y=i("Dd8w"),A=i.n(y),E=i("exGp"),R=i.n(E),S=i("mvHQ"),P=i.n(S),D=i("lbHh"),F=i("mtWM"),B={headers:{Accept:"application/json","Content-Type":"application/json"}},I=D.get("serviceToken"),M={BOUNCE_PROJECT:function(t,e){t.commit,t.state;return a(e.record,e.info)},FETCH_MBOX:function(t,e){var i=t.commit;t.state;return n(e.id).then(function(t){var e=new XMLHttpRequest;e.open("GET",t.data.data.url,!0),e.send(null),e.onreadystatechange=function(){4===e.readyState&&200===e.status&&1!==e.getResponseHeader("Content-Type").indexOf("text")&&i("SET_ID_PROJECT",{record:JSON.parse(e.responseText),info:t.data.data})}})},FETCH_LIST_DATA:function(t,e){var i=t.commit,o=t.dispatch,a=(t.state,e.type);return i("SET_ACTIVE_TYPE",{type:a}),(void 0)(a).then(function(t){return i("SET_LIST",{type:a,ids:t})}).then(function(){return o("ENSURE_ACTIVE_ITEMS")})},ENSURE_ACTIVE_ITEMS:function(t){return(0,t.dispatch)("FETCH_ITEMS",{ids:t.getters.activeIds})},FETCH_ITEMS:function(t,e){var i=t.commit,o=t.state,a=e.ids,n=Date.now();return a=a.filter(function(t){var e=o.items[t];return!e||n-e.__lastUpdated>18e4}),a.length?(void 0)(a).then(function(t){return i("SET_ITEMS",{items:t})}):k.a.resolve()},FETCH_USER:function(t,e){var i=t.commit,o=t.state,a=e.id;return o.users[a]?k.a.resolve(o.users[a]):(void 0)(a).then(function(t){return i("SET_USER",{id:a,user:t})})}},H={SET_USER_INFO:function(t,e){var i=e.type;t.activeType=i},SET_WORK_INFO:function(t,e){var i=e.type,o=e.ids;t.lists[i]=o},SET_MUSIXISER_INFO:function(t,e){e.items.forEach(function(e){e&&f.a.set(t.items,e.id,e)})},SET_BOUNCE_PROJECT:function(t,e){var i=e.record;t.recordProject=i},SET_ID_PROJECT:function(t,e){var i=e.record,o=e.info;t.recordProject=i,t.recordProjectInfo=o},SET_FINAL_WORK:function(t,e){var i=e.type;t.activeType=i},SET_USER:function(t,e){var i=e.id,o=e.user;f.a.set(t.users,i,o||!1)}},U={activeIds:function(t){var e=t.activeType,i=t.itemsPerPage,o=t.lists,a=Number(t.route.params.page)||1;if(e){var n=(a-1)*i,c=a*i;return o[e].slice(n,c)}return[]},activeItems:function(t,e){return e.activeIds.map(function(e){return t.items[e]}).filter(function(t){return t})}};f.a.use(T.a);var q={name:"app"},G=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},O=[],j={render:G,staticRenderFns:O},L=j,$=i("VU/8"),z=c,V=$(q,L,!1,z,null,null),W=V.exports,J=i("/ocq"),X={name:"HelloWorld",data:function(){return{msg:"名片制作",name:"",company:"",title:"",tel:""}}},Z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"hello"},[i("h1",[t._v(t._s(t.msg))]),t._v(" "),i("div",{staticClass:"input-section"},[i("div",{staticClass:"sector"},[i("h3",[t._v("姓名: ")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"sector"},[i("h3",[t._v("公司: ")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.company,expression:"company"}],attrs:{type:"text"},domProps:{value:t.company},on:{input:function(e){e.target.composing||(t.company=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"sector"},[i("h3",[t._v("职位: ")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"sector"},[i("h3",[t._v("电话: ")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.tel,expression:"tel"}],attrs:{type:"num"},domProps:{value:t.tel},on:{input:function(e){e.target.composing||(t.tel=e.target.value)}}})]),t._v(" "),t._m(0,!1,!1)]),t._v(" "),i("div",{staticClass:"b-card"},[i("div",{staticClass:"name"},[t._v("\n      "+t._s(t.name)+"\n    ")]),t._v(" "),i("div",{staticClass:"company"},[t._v("\n      "+t._s(t.company)+"\n    ")]),t._v(" "),i("div",{staticClass:"title"},[t._v("\n      "+t._s(t.title)+"\n    ")]),t._v(" "),i("div",{staticClass:"tel"},[t._v("\n      "+t._s(t.tel)+"\n    ")])])])},Y=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sector"},[i("h3",[t._v("背景颜色: ")]),t._v(" "),i("div",{}),t._v(" "),i("div",{}),t._v(" "),i("div",{}),t._v(" "),i("div",{})])}],K={render:Z,staticRenderFns:Y},Q=K,tt=i("VU/8"),et=r,it=tt(X,Q,!1,et,"data-v-52bc8902",null),ot=it.exports,at=i("lHA8"),nt=i.n(at),ct=i("Gu7T"),rt=i.n(ct),st=i("gRE1"),dt=i.n(st),lt=i("fZjL"),vt=i.n(lt),ut=i("ZnLv"),pt=1;window.Tone=i("ZnLv");var mt=new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster();new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),(new Tone.PluckSynth).toMaster();window.recorder=[],window.tonepart=[];var ht=[],gt=0,ft={data:function(){return{activeNote:{},timerToStartRecord:0,recording:!1,replaying:!1}},methods:{load:function(){},startRecord:function(){var t=this;this.timerToStartRecord=3;var e=setInterval(function(){t.timerToStartRecord-=1,0==t.timerToStartRecord&&clearInterval(e)},1e3)},touchStartHandler:function(t){console.log("down",t.target.id),mt.triggerAttack(t.target.id),this.$set(this.activeNote,t.target.id,1),this.recording&&recorder.push({note:t.target.id,time:+((performance.now()-gt)/1e3).toFixed(4)})},touchEndHandler:function(t){mt.triggerRelease(t.target.id),this.$set(this.activeNote,t.target.id,0)},toggleRecord:function(t){var e=this;if(this.recording=!this.recording,this.recording){if(recorder=[],!this.replaying){this.timerToStartRecord=3;var i=setInterval(function(){e.timerToStartRecord-=1,0==e.timerToStartRecord&&(clearInterval(i),gt=performance.now())},1e3)}}else console.log("kikikiki"),recorder.length&&(tonepart[tonepart.length]=new Tone.Part(function(t,e){mt.triggerAttackRelease(e.note,"8n",t)},recorder).start(0))},toggleReplay:function(){console.log(1),this.replaying=!this.replaying,this.replaying?(console.log("kokokoko"),gt=performance.now(),Tone.Transport.start("+0.01")):Tone.Transport.stop(0)},undoRecord:function(){tonepart.pop().dispose()},bounceProject:function(){if(console.log(tonepart),ht=[],tonepart.length){for(tonepart.forEach(function(t){t._events.forEach(function(t){ht.push(t.value)})});tonepart.length;)tonepart.pop().dispose();tonepart[0]=new Tone.Part(function(t,e){mt.triggerAttackRelease(e.note,"8n",t)},ht).start(0),ht.sort(function(t,e){return 0+t.time-e.time}),console.log(ht),(void 0)(ht)}else alert("tm什么都没录")}},created:function(){/micromessenger/.test(navigator.userAgent.toLowerCase())&&(s("code")||D.get("serviceToken")?o(s("code")).then(function(t){t.data.errcode>=2e4&&(D.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){D.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect"))},mounted:function(){},updated:function(){}},_t=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{class:["mask",t.timerToStartRecord>1?"fadein":"fadeout",0==t.timerToStartRecord?"hide":""]},[i("p",{staticClass:"rotate",attrs:{id:"timer"}},[t._v(t._s(t.timerToStartRecord))])]),t._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"keys",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.touchStartHandler(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.touchEndHandler(e)}}},[i("div",{class:["white","c",t.activeNote.C4?"active-note":""],attrs:{id:"C4"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db4?"active-note":""],attrs:{id:"Db4"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D4?"active-note":""],attrs:{id:"D4"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb4?"active-note":""],attrs:{id:"Eb4"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E4?"active-note":""],attrs:{id:"E4"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F4?"active-note":""],attrs:{id:"F4"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb4?"active-note":""],attrs:{id:"Gb4"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G4?"active-note":""],attrs:{id:"G4"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab4?"active-note":""],attrs:{id:"Ab4"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A4?"active-note":""],attrs:{id:"A4"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb4?"active-note":""],attrs:{id:"Bb4"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B4?"active-note":""],attrs:{id:"B4"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C5?"active-note":""],attrs:{id:"C5"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db5?"active-note":""],attrs:{id:"Db5"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D5?"active-note":""],attrs:{id:"D5"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb5?"active-note":""],attrs:{id:"Eb5"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E5?"active-note":""],attrs:{id:"E5"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F5?"active-note":""],attrs:{id:"F5"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb5?"active-note":""],attrs:{id:"Gb5"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G5?"active-note":""],attrs:{id:"G5"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab5?"active-note":""],attrs:{id:"Ab5"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A5?"active-note":""],attrs:{id:"A5"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb5?"active-note":""],attrs:{id:"Bb5"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B5?"active-note":""],attrs:{id:"B5"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C6?"active-note":""],attrs:{id:"C6"}})]),t._v(" "),i("div",{staticClass:"controller"},[i("div",{staticClass:"funcBtn record",class:t.recording?"active":"",on:{click:t.toggleRecord}},[i("div",{staticClass:"recordHint"})]),t._v(" "),i("div",{staticClass:"funcBtn play",class:t.replaying?"active":"",on:{click:t.toggleReplay}},[i("div",{class:["rotate",t.replaying?"playHint":"stopHint"]})]),t._v(" "),i("div",{staticClass:"funcBtn undo",on:{click:t.undoRecord}},[i("div",{staticClass:"undoHint rotate"})]),t._v(" "),i("div",{staticClass:"funcBtn bounce",on:{click:t.bounceProject}},[i("div",{staticClass:"bounceHint rotate"})])])])])},bt=[],wt={render:_t,staticRenderFns:bt},Tt=wt,Ct=i("VU/8"),kt=u,Nt=Ct(ft,Tt,!1,kt,"data-v-94d961f8",null),xt=Nt.exports;window.Tone=i("ZnLv");var yt=(new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),{data:function(){return{userInfo:{},timerToStartRecord:0,recording:!1,replaying:!1}},methods:{load:function(){}},created:function(){/micromessenger/.test(navigator.userAgent.toLowerCase())&&wx.onMenuShareTimeline({title:"test share",link:"//m.baidu.com",imgUrl:"",success:function(){alert("成功分享")},cancel:function(){alert("取消分享")}})},mounted:function(){},updated:function(){}}),At=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{class:["mask",t.timerToStartRecord>1?"fadein":"fadeout",0==t.timerToStartRecord?"hide":""]},[i("p",{staticClass:"rotate",attrs:{id:"timer"}},[t._v(t._s(t.timerToStartRecord))])]),t._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"keys",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.touchStartHandler(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.touchEndHandler(e)}}},[i("div",{class:["white","c",t.activeNote.C4?"active-note":""],attrs:{id:"C4"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db4?"active-note":""],attrs:{id:"Db4"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D4?"active-note":""],attrs:{id:"D4"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb4?"active-note":""],attrs:{id:"Eb4"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E4?"active-note":""],attrs:{id:"E4"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F4?"active-note":""],attrs:{id:"F4"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb4?"active-note":""],attrs:{id:"Gb4"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G4?"active-note":""],attrs:{id:"G4"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab4?"active-note":""],attrs:{id:"Ab4"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A4?"active-note":""],attrs:{id:"A4"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb4?"active-note":""],attrs:{id:"Bb4"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B4?"active-note":""],attrs:{id:"B4"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C5?"active-note":""],attrs:{id:"C5"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db5?"active-note":""],attrs:{id:"Db5"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D5?"active-note":""],attrs:{id:"D5"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb5?"active-note":""],attrs:{id:"Eb5"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E5?"active-note":""],attrs:{id:"E5"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F5?"active-note":""],attrs:{id:"F5"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb5?"active-note":""],attrs:{id:"Gb5"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G5?"active-note":""],attrs:{id:"G5"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab5?"active-note":""],attrs:{id:"Ab5"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A5?"active-note":""],attrs:{id:"A5"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb5?"active-note":""],attrs:{id:"Bb5"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B5?"active-note":""],attrs:{id:"B5"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C6?"active-note":""],attrs:{id:"C6"}})]),t._v(" "),i("div",{staticClass:"controller"},[i("div",{staticClass:"funcBtn record",class:t.recording?"active":"",on:{click:t.toggleRecord}},[i("div",{staticClass:"recordHint"})]),t._v(" "),i("div",{staticClass:"funcBtn play",class:t.replaying?"active":"",on:{click:t.toggleReplay}},[i("div",{class:["rotate",t.replaying?"playHint":"stopHint"]})]),t._v(" "),i("div",{staticClass:"funcBtn undo",on:{click:t.undoRecord}},[i("div",{staticClass:"undoHint rotate"})]),t._v(" "),i("div",{staticClass:"funcBtn bounce",on:{click:t.bounceProject}},[i("div",{staticClass:"bounceHint rotate"})])])])])},Et=[],Rt={render:At,staticRenderFns:Et},St=Rt,Pt=i("VU/8"),Dt=p,Ft=Pt(yt,St,!1,Dt,"data-v-15915e84",null),Bt=Ft.exports;window.Tone=i("ZnLv");var It=new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster();new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),(new Tone.PluckSynth).toMaster();window.recorder=[],window.tonepart=[];var Mt=[],Ht=0,Ut={data:function(){return{activeNote:{},timerToStartRecord:0,recording:!1,replaying:!1}},methods:{load:function(){},startRecord:function(){var t=this;this.timerToStartRecord=3;var e=setInterval(function(){t.timerToStartRecord-=1,0==t.timerToStartRecord&&clearInterval(e)},1e3)},touchStartHandler:function(t){console.log("down",t.target.id),It.triggerAttack(t.target.id),this.$set(this.activeNote,t.target.id,1),this.recording&&recorder.push({note:t.target.id,time:+((performance.now()-Ht)/1e3).toFixed(4)})},touchEndHandler:function(t){It.triggerRelease(t.target.id),this.$set(this.activeNote,t.target.id,0)},toggleRecord:function(t){var e=this;if(this.recording=!this.recording,this.recording){if(recorder=[],!this.replaying){this.timerToStartRecord=3;var i=setInterval(function(){e.timerToStartRecord-=1,0==e.timerToStartRecord&&(clearInterval(i),Ht=performance.now())},1e3)}}else console.log("kikikiki"),recorder.length&&(tonepart[tonepart.length]=new Tone.Part(function(t,e){It.triggerAttackRelease(e.note,"8n",t)},recorder).start(0))},toggleReplay:function(){console.log(1),this.replaying=!this.replaying,this.replaying?(console.log("kokokoko"),Ht=performance.now(),Tone.Transport.start("+0.01")):Tone.Transport.stop(0)},undoRecord:function(){tonepart.pop().dispose()},bounceProject:function(){if(console.log(tonepart),Mt=[],tonepart.length){for(tonepart.forEach(function(t){t._events.forEach(function(t){Mt.push(t.value)})});tonepart.length;)tonepart.pop().dispose();tonepart[0]=new Tone.Part(function(t,e){It.triggerAttackRelease(e.note,"8n",t)},Mt).start(0),Mt.sort(function(t,e){return 0+t.time-e.time}),console.log(Mt),(void 0)(Mt)}else alert("tm什么都没录")}},created:function(){/micromessenger/.test(navigator.userAgent.toLowerCase())&&(s("code")||D.get("serviceToken")?o(s("code")).then(function(t){t.data.errcode>=2e4&&(D.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){D.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect"))},mounted:function(){},updated:function(){}},qt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{class:["mask",t.timerToStartRecord>1?"fadein":"fadeout",0==t.timerToStartRecord?"hide":""]},[i("p",{staticClass:"rotate",attrs:{id:"timer"}},[t._v(t._s(t.timerToStartRecord))])]),t._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"keys",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.touchStartHandler(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.touchEndHandler(e)}}},[i("div",{class:["white","c",t.activeNote.C4?"active-note":""],attrs:{id:"C4"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db4?"active-note":""],attrs:{id:"Db4"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D4?"active-note":""],attrs:{id:"D4"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb4?"active-note":""],attrs:{id:"Eb4"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E4?"active-note":""],attrs:{id:"E4"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F4?"active-note":""],attrs:{id:"F4"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb4?"active-note":""],attrs:{id:"Gb4"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G4?"active-note":""],attrs:{id:"G4"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab4?"active-note":""],attrs:{id:"Ab4"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A4?"active-note":""],attrs:{id:"A4"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb4?"active-note":""],attrs:{id:"Bb4"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B4?"active-note":""],attrs:{id:"B4"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C5?"active-note":""],attrs:{id:"C5"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db5?"active-note":""],attrs:{id:"Db5"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D5?"active-note":""],attrs:{id:"D5"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb5?"active-note":""],attrs:{id:"Eb5"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E5?"active-note":""],attrs:{id:"E5"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F5?"active-note":""],attrs:{id:"F5"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb5?"active-note":""],attrs:{id:"Gb5"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G5?"active-note":""],attrs:{id:"G5"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab5?"active-note":""],attrs:{id:"Ab5"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A5?"active-note":""],attrs:{id:"A5"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb5?"active-note":""],attrs:{id:"Bb5"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B5?"active-note":""],attrs:{id:"B5"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C6?"active-note":""],attrs:{id:"C6"}})]),t._v(" "),i("div",{staticClass:"controller"},[i("div",{staticClass:"funcBtn record",class:t.recording?"active":"",on:{click:t.toggleRecord}},[i("div",{staticClass:"recordHint"})]),t._v(" "),i("div",{staticClass:"funcBtn play",class:t.replaying?"active":"",on:{click:t.toggleReplay}},[i("div",{class:["rotate",t.replaying?"playHint":"stopHint"]})]),t._v(" "),i("div",{staticClass:"funcBtn undo",on:{click:t.undoRecord}},[i("div",{staticClass:"undoHint rotate"})]),t._v(" "),i("div",{staticClass:"funcBtn bounce",on:{click:t.bounceProject}},[i("div",{staticClass:"bounceHint rotate"})])])])])},Gt=[],Ot={render:qt,staticRenderFns:Gt},jt=Ot,Lt=i("VU/8"),$t=m,zt=Lt(Ut,jt,!1,$t,"data-v-94d961f8",null),Vt=zt.exports,Wt=(i("v2ns"),i("GDE4")),Jt=i.n(Wt),Xt=i("7QTg");window.Tone=i("ZnLv");var Zt={},Yt=void 0,Kt=new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster();new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),(new Tone.PluckSynth).toMaster(),document.documentElement.getBoundingClientRect().width,Math.max(document.documentElement.clientHeight,window.innerHeight||0);window.tonepart=[];var Qt=[],te=0,ee=!0,ie=void 0,oe=0,ae=0,ne={components:{swiper:Xt.swiper,swiperSlide:Xt.swiperSlide,vueSlider:Jt.a},data:function(){return{activeNote:{},recordPart:[],recordParts:[],playing:!1,generalControllerShow:!1,activeSwiperIndex:3,lastActiveSwiperIndex:2,vuetimeline:0,showExtendBtns:0,timelineConfig:{value:0,width:8,height:"90%",padding:"0",dotSize:20,eventType:"auto",min:0,max:200,interval:1,disabled:!1,show:!0,tooltip:"always",piecewise:!1,reverse:!0,style:{display:"inline-block"},class:"star-slider",direction:"vertical",speed:.1,bgStyle:{backgroundColor:"rgb(110,113,158)",boxShadow:"inset 0.5px 0.5px 3px 1px rgba(0,0,0,.36)"},tooltipStyle:{backgroundColor:"rgb(69, 106, 255)",borderColor:"rgb(69, 106, 255)"},formatter:function(t){return t?(t/10).toFixed(1)+"s/20s":"0.0s/20s"},processStyle:{backgroundColor:"rgb(69,106,255)"}}}},watch:{playing:function(t){var e=this;console.log("playing status",t),t?ie=setInterval(function(){e.vuetimeline+=1,e.vuetimeline>=200&&(e.toggleReplay(),e.vuetimeline=0)},100):clearInterval(ie)}},computed:{swiper:function(){return this.$refs.pianoRoll.swiper},activePartIndex:function(){return this.PARTNUM-this.activeSwiperIndex-1},lastActivePartIndex:function(){return this.PARTNUM-this.lastActiveSwiperIndex-1}},methods:{load:function(){},toggleReplay:function(){console.log(1),this.playing=!this.playing,this.playing?(this.vuetimeline>=200&&(this.vuetimeline=0),oe=performance.now()-100*this.vuetimeline,console.log("播放开始"),this.confirmRecordPart(0),console.log("kokokoko"),te=performance.now(),console.log("activeOffsetTime"+100*this.vuetimeline),Tone.Transport.start("+0.01",100*this.vuetimeline/1e3)):(console.log("播放停了"),Tone.Transport.stop(0))},handleNoteStart:function(t){var e=0;Kt.triggerAttack(t),this.$set(this.activeNote,t,1),this.playing?e=performance.now()-oe:(ee&&(te=performance.now(),ae=100*this.vuetimeline,ee=!1),e=performance.now()-te+ae),e<2e4?(this.vuetimeline=10*e/1e3,this.recordPart.push({note:t,time:+(e/1e3).toFixed(4)})):(this.vuetimeline=200,console.log("cannot record more than 20 seconds"))},handleNoteEnd:function(t){Kt.triggerRelease(t),this.$set(this.activeNote,t,0)},touchNoteStartHandler:function(t){console.log(t),Zt[t.changedTouches[0].identifier]=t.target.id,this.handleNoteStart(t.target.id)},touchNoteEndHandler:function(t){this.handleNoteEnd(t.target.id),this.handleNoteEnd(Zt[t.changedTouches[0].identifier])},confirmRecordPart:function(t){this.recordPart.length?(console.log("processing track: ",this.lastActivePartIndex),this.recordParts[this.lastActivePartIndex]&&this.recordParts[this.lastActivePartIndex].length&&(this.recordPart=this.recordPart.concat(this.recordParts[this.lastActivePartIndex])),tonepart[this.lastActivePartIndex]&&tonepart[this.lastActivePartIndex].dispose(),tonepart[this.lastActivePartIndex]=new Tone.Part(function(t,e){Kt.triggerAttackRelease(e.note,"8n",t)},this.recordPart).start(0),this.recordParts[this.lastActivePartIndex]=this.recordPart,this.recordPart=[]):console.log("啥也没录"),this.lastActiveSwiperIndex=this.activeSwiperIndex,t&&(this.vuetimeline=0,te=0),ee=!0},clearRecordPart:function(t){console.log("cleaning track "+t),this.activePartIndex===t&&(this.recordPart=[]),this.recordParts[t]&&this.recordParts[t].length?(this.$set(this.recordParts,t,[]),tonepart[t].dispose(),tonepart[t]=void 0):console.log("track "+t+" has no content")},bounceProject:function(){if(alert("此步骤确认，需要微信支付"),this.confirmRecordPart(0),console.log(this),console.log(tonepart),Qt=[],tonepart.length){for(tonepart.forEach(function(t){t._events.forEach(function(t){Qt.push(t.value)})}),Qt.sort(function(t,e){return 0+t.time-e.time}),this.$store.dispatch("BOUNCE_PROJECT",{record:Qt,info:{title:"default",content:"default",cover:"default"}}).then(function(){console.log("successfully bounced"),alert("作品已为您存储")});tonepart.length;)tonepart.pop().dispose();tonepart[0]=new Tone.Part(function(t,e){Kt.triggerAttackRelease(e.note,"8n",t)},Qt).start(0),d(Qt)}else alert("tm什么都没录")},mapNoteTimeToColor:function(t){return l(t)},mapNoteMidiToLength:function(t){return v(t)},adjustTimeline:function(t){this.playing?(console.log("ccccccccc"),this.toggleReplay()):ee=!0},onMiniKeyboardScroll:function(t){console.log(t.touches[0].clientY)},onMiniKeyboardStart:function(t){console.log(t)},keng:function(t){console.log(t);for(var e=0;e<=t.changedTouches.length-1;e++){var i=document.elementFromPoint(t.changedTouches[e].clientX,t.changedTouches[e].clientY);i.classList.contains("white")||i.classList.contains("black")?Zt[t.changedTouches[e].identifier]&&Zt[t.changedTouches[e].identifier]!=i.getAttribute("id")?(console.log(Zt),this.handleNoteStart(i.getAttribute("id")),this.handleNoteEnd(Zt[t.changedTouches[e].identifier]),Zt[t.changedTouches[e].identifier]=i.getAttribute("id")):Zt[t.changedTouches[e].identifier]?console.log(3):(console.log(2),this.handleNoteStart(i.getAttribute("id")),Zt[t.changedTouches[e].identifier]=i.getAttribute("id")):(console.log("外边"),Zt[t.changedTouches[e].identifier]&&this.handleNoteEnd(Zt[t.changedTouches[e].identifier]),Zt[t.changedTouches[e].identifier]=void 0)}},btnStart:function(t){var e=this;console.log(t),Yt=setTimeout(function(){e.showExtendBtns=!0},500)},btnEnd:function(t){clearTimeout(Yt);var e=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY);console.log(e),e&&e.classList.contains("bounceBtn")?this.bounceProject():e&&(e.classList.contains("playBtn")||e.classList.contains("pauseBtn"))&&this.toggleReplay(),this.showExtendBtns=!1}},created:function(){var t=this,e=document.documentElement;window.rem=e.getBoundingClientRect().width/10,e.style.fontSize=window.rem+"px",this.PARTNUM=3,this.pianoRollSwiperOption={initialSlide:this.PARTNUM,slidesPerView:3,on:{transitionEnd:function(e){console.log("3",this.activeIndex),t.activeSwiperIndex=this.activeIndex,t.confirmRecordPart(!ee)}}},/micromessenger/.test(navigator.userAgent.toLowerCase())&&(s("code")||D.get("serviceToken")?o(s("code")).then(function(t){t.data.errcode>=2e4&&(D.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){D.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box#/new-music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/new-music-box-maker&connect_redirect=1#wechat_redirect"))},mounted:function(){},updated:function(){}},ce=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}},[i("div",{staticClass:"keys",on:{touchmove:t.keng,touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.touchNoteStartHandler(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.touchNoteEndHandler(e)}}},[i("div",{class:["white","c",t.activeNote.C4?"active-note":""],attrs:{id:"C4"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db4?"active-note":""],attrs:{id:"Db4"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D4?"active-note":""],attrs:{id:"D4"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb4?"active-note":""],attrs:{id:"Eb4"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E4?"active-note":""],attrs:{id:"E4"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F4?"active-note":""],attrs:{id:"F4"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb4?"active-note":""],attrs:{id:"Gb4"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G4?"active-note":""],attrs:{id:"G4"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab4?"active-note":""],attrs:{id:"Ab4"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A4?"active-note":""],attrs:{id:"A4"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb4?"active-note":""],attrs:{id:"Bb4"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B4?"active-note":""],attrs:{id:"B4"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C5?"active-note":""],attrs:{id:"C5"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db5?"active-note":""],attrs:{id:"Db5"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D5?"active-note":""],attrs:{id:"D5"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb5?"active-note":""],attrs:{id:"Eb5"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E5?"active-note":""],attrs:{id:"E5"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F5?"active-note":""],attrs:{id:"F5"}}),t._v(" "),i("div",{class:["black","f-sharp",t.activeNote.Gb5?"active-note":""],attrs:{id:"Gb5"}}),t._v(" "),i("div",{class:["white","g",t.activeNote.G5?"active-note":""],attrs:{id:"G5"}}),t._v(" "),i("div",{class:["black","a-minor",t.activeNote.Ab5?"active-note":""],attrs:{id:"Ab5"}}),t._v(" "),i("div",{class:["white","a",t.activeNote.A5?"active-note":""],attrs:{id:"A5"}}),t._v(" "),i("div",{class:["black","b-minor",t.activeNote.Bb5?"active-note":""],attrs:{id:"Bb5"}}),t._v(" "),i("div",{class:["white","b",t.activeNote.B5?"active-note":""],attrs:{id:"B5"}}),t._v(" "),i("div",{class:["white","c",t.activeNote.C6?"active-note":""],attrs:{id:"C6"}}),t._v(" "),i("div",{class:["black","d-minor",t.activeNote.Db6?"active-note":""],attrs:{id:"Db6"}}),t._v(" "),i("div",{class:["white","d",t.activeNote.D6?"active-note":""],attrs:{id:"D6"}}),t._v(" "),i("div",{class:["black","e-minor",t.activeNote.Eb6?"active-note":""],attrs:{id:"Eb6"}}),t._v(" "),i("div",{class:["white","e",t.activeNote.E6?"active-note":""],attrs:{id:"E6"}}),t._v(" "),i("div",{class:["white","f",t.activeNote.F6?"active-note":""],attrs:{id:"F6"}})]),t._v(" "),i("div",{staticClass:"semi-piano-roll",on:{touchmove:function(t){t.stopPropagation(),t.preventDefault()}}},[i("swiper",{ref:"pianoRoll",attrs:{options:t.pianoRollSwiperOption}},[t._l(t.PARTNUM,function(e){return i("swiper-slide",[i("div",{staticClass:"current-piano-roll"},[i("svg",{style:{height:"90%",padding:t.timelineConfig.dotSize/2+"px 0"}},[i("defs",[i("filter",{attrs:{id:"glowing"}},[i("feGaussianBlur",{attrs:{stdDeviation:"1",result:"coloredBlur"}}),t._v(" "),i("feMerge",[i("feMergeNode",{attrs:{in:"coloredBlur"}}),t._v(" "),i("feMergeNode",{attrs:{in:"SourceGraphic"}})],1)],1)]),t._v(" "),t._l(t.recordPart,function(o,a){return t.activePartIndex===t.PARTNUM-e?i("rect",{attrs:{x:2,y:100*o.time/20+"%",width:t.mapNoteMidiToLength(o.note),height:"3",rx:"2",ry:"2",fill:t.mapNoteTimeToColor(o.time),filter:"url(#glowing)"}}):t._e()}),t._v(" "),t._l(t.recordParts[t.PARTNUM-e],function(o,a){return i("rect",{attrs:{x:2,y:100*o.time/20+"%",width:t.mapNoteMidiToLength(o.note),height:"3",rx:"2",ry:"2",fill:t.activePartIndex===t.PARTNUM-e?t.mapNoteTimeToColor(o.time):"rgb(120,120,120)",filter:t.activePartIndex===t.PARTNUM-e?"url(#glowing)":""}})})],2),t._v(" "),i("div",{staticClass:"temp",on:{click:function(i){t.clearRecordPart(t.PARTNUM-e)}}})])])}),t._v(" "),i("swiper-slide"),t._v(" "),i("swiper-slide")],2)],1),t._v(" "),i("div",{staticClass:"g-controller"},[i("vue-slider",t._b({on:{callback:t.adjustTimeline,"drag-end":function(t){}},model:{value:t.vuetimeline,callback:function(e){t.vuetimeline=e},expression:"vuetimeline"}},"vue-slider",t.timelineConfig,!1)),t._v(" "),i("div",{staticClass:"btnContainer",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.btnStart(e)},touchend:function(e){if(!("button"in e)&&t._k(e.keyCode,"event",void 0,e.key))return null;e.stopPropagation(),t.btnEnd(e)}}},[i("div",{class:[t.playing?"pauseBtn":"playBtn","rotate"],on:{click:t.toggleReplay}}),t._v(" "),i("div",{class:[t.showExtendBtns?"extendBtnsShow":"extendBtnsHide","extendBtns"]},[i("div",{staticClass:"bounceBtn rotate"})])])],1)])},re=[],se={render:ce,staticRenderFns:re},de=se,le=i("VU/8"),ve=h,ue=le(ne,de,!1,ve,"data-v-1a98cf2c",null),pe=ue.exports;window.Tone=i("ZnLv");var me=void 0,he=new Tone.Sampler({C4:"C4.[mp3|ogg]","D#4":"Ds4.[mp3|ogg]","F#4":"Fs4.[mp3|ogg]",A4:"A4.[mp3|ogg]",C5:"C5.[mp3|ogg]","D#5":"Ds5.[mp3|ogg]","F#5":"Fs5.[mp3|ogg]",A5:"A5.[mp3|ogg]",C6:"C6.[mp3|ogg]"},{release:1,baseUrl:"static/audio/"}).toMaster(),ge={components:{},data:function(){return{playing:!1}},computed:{project:function(){return this.$store.state.recordProject}},methods:{load:function(){},prepareMusic:function(){try{me.dispose()}catch(t){}me=new Tone.Part(function(t,e){he.triggerAttackRelease(e.note,"8n",t)},this.project).start(0)},loadMusicById:function(){var t=this;console.log("hehe",this.$store.state);var e=this.$store.state.route.query.id;if(!e||!this.project)return void console.log("搞飞机，没内容");e?(console.log("mmm",e),this.$store.dispatch("FETCH_MBOX",{id:e}).then(function(){t.prepareMusic()})):this.project&&this.prepareMusic()},togglePlay:function(){this.playing=!this.playing,this.playing?Tone.Transport.start("+0.01",0):Tone.Transport.stop(0)}},created:function(){var t=this,e=/micromessenger/.test(navigator.userAgent.toLowerCase());t.loadMusicById(),e&&(s("code")||D.get("serviceToken")?o(s("code")).then(function(t){t.data.errcode>=2e4&&(D.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")),alert("welcome"+t.data.data.realname),console.log("get user info success",t.data.data)}).catch(function(t){D.remove("serviceToken"),location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect")}):location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2cb950ff65a142c5&redirect_uri=http://m.musixise.com/music-box-maker&response_type=code&scope=snsapi_userinfo&state=type&quan,url=http://m.musixise.com/music-box-maker&connect_redirect=1#wechat_redirect"))},mounted:function(){},updated:function(){}},fe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}},[i("div",{staticClass:"mb"},[i("div",{class:[t.playing?"pauseBtn":"playBtn","rotate"],on:{click:t.togglePlay}})]),t._v(" "),t._m(0,!1,!1)])},_e=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"operate"},[i("div",{staticClass:"share"}),t._v(" "),i("div",{staticClass:"purchase"})])}],be={render:fe,staticRenderFns:_e},we=be,Te=i("VU/8"),Ce=g,ke=Te(ge,we,!1,Ce,"data-v-9843fa82",null),Ne=ke.exports;f.a.use(J.a);var xe=new J.a({mode:"history",routes:[{path:"/",name:"HelloWorld",component:ot},{path:"/music-box-maker",name:"MBMaker",component:xt},{path:"/new-music-box-maker",name:"NMBMaker",component:pe},{path:"/music-box-viewer",name:"MBViewer",component:Ne},{path:"/music-box-item",name:"MBItem",component:Bt},{path:"/music-box-author",name:"MBAuthor",component:Vt}]});f.a.use(w.a,{name:"v-touch"}),f.a.config.productionTip=!1;var ye=function(){return new T.a.Store({state:{activeType:null,itemsPerPage:20,items:{},users:{},lists:{top:[],new:[],show:[],ask:[],job:[]},recordParts:[],recordProject:[]},actions:M,mutations:H,getters:U})}();Object(_.sync)(ye,xe),new f.a({el:"#app",router:xe,store:ye,template:"<App/>",components:{App:W}})},ViPM:function(t,e){},"e1+N":function(t,e){},ibai:function(t,e){},v2ns:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.7139261859a4dbbba8de.js.map